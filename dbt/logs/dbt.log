[0m19:42:49.695630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CC44A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CE720EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CE720C40>]}


============================== 19:42:49.698632 | a602d10f-f034-4c99-8b1c-fd681d11da3f ==============================
[0m19:42:49.698632 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:42:49.699631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': '.\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:42:49.717637 [info ] [MainThread]: dbt version: 1.10.8
[0m19:42:49.717637 [info ] [MainThread]: python version: 3.10.11
[0m19:42:49.718636 [info ] [MainThread]: python path: D:\weekend-de\e-commerce-clickstream-orders\.venv\Scripts\python.exe
[0m19:42:49.719645 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m19:42:49.719645 [info ] [MainThread]: Using profiles dir at .\dbt
[0m19:42:49.720636 [info ] [MainThread]: Using profiles.yml file at .\dbt\profiles.yml
[0m19:42:49.720636 [info ] [MainThread]: Using dbt_project.yml file at D:\weekend-de\e-commerce-clickstream-orders\dbt\dbt_project.yml
[0m19:42:49.809164 [info ] [MainThread]: Configuration:
[0m19:42:49.810161 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:42:49.811176 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:42:49.811176 [info ] [MainThread]: Required dependencies:
[0m19:42:49.811176 [debug] [MainThread]: Executing "git --help"
[0m19:42:49.841989 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:42:49.842975 [debug] [MainThread]: STDERR: "b''"
[0m19:42:49.843966 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:42:49.844965 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:42:49.844965 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:42:49.845965 [info ] [MainThread]: dbt looked for a profiles.yml file in .\dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:42:49.846964 [debug] [MainThread]: Command `dbt debug` failed at 19:42:49.846964 after 0.22 seconds
[0m19:42:49.846964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CC44A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CD7444F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CA7F3A00>]}
[0m19:42:49.847984 [debug] [MainThread]: Flushing usage events
[0m19:42:50.812743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:49.326328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FE336020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FF644B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FF644940>]}


============================== 19:44:49.329625 | 64119cbd-3478-4f24-a0a1-05ee325faef0 ==============================
[0m19:44:49.329625 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:44:49.330628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:44:49.346214 [info ] [MainThread]: dbt version: 1.10.8
[0m19:44:49.347217 [info ] [MainThread]: python version: 3.10.11
[0m19:44:49.348218 [info ] [MainThread]: python path: D:\weekend-de\e-commerce-clickstream-orders\.venv\Scripts\python.exe
[0m19:44:49.348218 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m19:44:49.467917 [info ] [MainThread]: Using profiles dir at D:\weekend-de\e-commerce-clickstream-orders\dbt
[0m19:44:49.468900 [info ] [MainThread]: Using profiles.yml file at D:\weekend-de\e-commerce-clickstream-orders\dbt\profiles.yml
[0m19:44:49.469635 [info ] [MainThread]: Using dbt_project.yml file at D:\weekend-de\e-commerce-clickstream-orders\dbt\dbt_project.yml
[0m19:44:49.491401 [info ] [MainThread]: adapter type: duckdb
[0m19:44:49.491918 [info ] [MainThread]: adapter version: 1.9.4
[0m19:44:49.569475 [info ] [MainThread]: Configuration:
[0m19:44:49.570456 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:44:49.570456 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:44:49.571457 [info ] [MainThread]: Required dependencies:
[0m19:44:49.571457 [debug] [MainThread]: Executing "git --help"
[0m19:44:49.602037 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:44:49.603038 [debug] [MainThread]: STDERR: "b''"
[0m19:44:49.604038 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:44:49.605038 [info ] [MainThread]: Connection:
[0m19:44:49.605038 [info ] [MainThread]:   database: warehouse
[0m19:44:49.606037 [info ] [MainThread]:   schema: main
[0m19:44:49.606037 [info ] [MainThread]:   path: ./warehouse.duckdb
[0m19:44:49.607037 [info ] [MainThread]:   config_options: None
[0m19:44:49.607037 [info ] [MainThread]:   extensions: None
[0m19:44:49.608037 [info ] [MainThread]:   settings: {}
[0m19:44:49.608037 [info ] [MainThread]:   external_root: ../data
[0m19:44:49.609037 [info ] [MainThread]:   use_credential_provider: None
[0m19:44:49.609037 [info ] [MainThread]:   attach: None
[0m19:44:49.610038 [info ] [MainThread]:   filesystems: None
[0m19:44:49.610038 [info ] [MainThread]:   remote: None
[0m19:44:49.611039 [info ] [MainThread]:   plugins: None
[0m19:44:49.611039 [info ] [MainThread]:   disable_transactions: False
[0m19:44:49.612038 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:44:49.840810 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m19:44:52.638223 [debug] [MainThread]: Using duckdb connection "debug"
[0m19:44:52.638223 [debug] [MainThread]: On debug: select 1 as id
[0m19:44:52.639232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:52.656745 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m19:44:52.657745 [debug] [MainThread]: On debug: Close
[0m19:44:52.657745 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:44:52.658745 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:44:52.659745 [debug] [MainThread]: Command `dbt debug` succeeded at 19:44:52.659745 after 3.39 seconds
[0m19:44:52.659745 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:44:52.660744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FE336020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FFC5BB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FE66C190>]}
[0m19:44:52.660744 [debug] [MainThread]: Flushing usage events
[0m19:44:53.575144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:00.770898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118DA56110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118FD28DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118FD28BE0>]}


============================== 19:45:00.774411 | 6a8f03d3-4680-48e5-a66f-ce3e47d49294 ==============================
[0m19:45:00.774411 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:45:00.775409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:45:00.961281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118FF19D80>]}
[0m19:45:01.006032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118FB5F130>]}
[0m19:45:01.009038 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:45:01.255542 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m19:45:01.256558 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:45:01.256558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118FE3CC70>]}
[0m19:45:03.311278 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_user' is a seed node, but it is specified in the models section of
models\gold\schema.yml. To fix this error, place the `dim_user` specification
under the seeds key instead.
[0m19:45:03.313283 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_sku' is a seed node, but it is specified in the models section of
models\gold\schema.yml. To fix this error, place the `dim_sku` specification
under the seeds key instead.
[0m19:45:03.570701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211915E85B0>]}
[0m19:45:03.670595 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:45:03.674598 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:45:03.722382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211914E20E0>]}
[0m19:45:03.723380 [info ] [MainThread]: Found 7 models, 2 seeds, 12 data tests, 4 sources, 429 macros
[0m19:45:03.724380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211915CD8D0>]}
[0m19:45:03.726380 [info ] [MainThread]: 
[0m19:45:03.726380 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:45:03.727381 [info ] [MainThread]: 
[0m19:45:03.728380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:45:03.734382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:45:03.819411 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:45:03.820411 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:45:03.820411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:03.844410 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:45:03.845411 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:45:03.847410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m19:45:03.848411 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m19:45:03.855411 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m19:45:03.855411 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:45:03.856410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:03.857411 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:03.858410 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m19:45:03.859409 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m19:45:03.860410 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:45:03.860410 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m19:45:03.861414 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m19:45:03.861414 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:45:03.862420 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m19:45:03.862420 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m19:45:03.863413 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m19:45:03.863413 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:45:03.864414 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m19:45:03.865450 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m19:45:03.866415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m19:45:03.871441 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:45:03.874414 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:45:03.874414 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m19:45:03.875918 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m19:45:03.875918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:03.876923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:03.878925 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:45:03.878925 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:45:03.878925 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:45:03.879925 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:45:03.880925 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:45:03.880925 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:45:03.891439 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:45:03.892442 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:45:03.894400 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m19:45:03.895408 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m19:45:03.896409 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m19:45:03.896409 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m19:45:03.897410 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m19:45:03.897410 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m19:45:03.899408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211902DF880>]}
[0m19:45:03.901406 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:03.902407 [debug] [MainThread]: On master: BEGIN
[0m19:45:03.902407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:03.904406 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:03.904406 [debug] [MainThread]: On master: COMMIT
[0m19:45:03.905406 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:03.905406 [debug] [MainThread]: On master: COMMIT
[0m19:45:03.906408 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:45:03.907406 [debug] [MainThread]: On master: Close
[0m19:45:03.938922 [debug] [Thread-1 (]: Began running node seed.ecomm.dim_sku
[0m19:45:03.939922 [debug] [Thread-2 (]: Began running node seed.ecomm.dim_user
[0m19:45:03.940608 [info ] [Thread-1 (]: 1 of 2 START seed file main.dim_sku ............................................ [RUN]
[0m19:45:03.941613 [info ] [Thread-2 (]: 2 of 2 START seed file main.dim_user ........................................... [RUN]
[0m19:45:03.942613 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ecomm.dim_sku'
[0m19:45:03.943612 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.ecomm.dim_user'
[0m19:45:03.943612 [debug] [Thread-1 (]: Began compiling node seed.ecomm.dim_sku
[0m19:45:03.944613 [debug] [Thread-2 (]: Began compiling node seed.ecomm.dim_user
[0m19:45:03.945614 [debug] [Thread-1 (]: Began executing node seed.ecomm.dim_sku
[0m19:45:03.945614 [debug] [Thread-2 (]: Began executing node seed.ecomm.dim_user
[0m19:45:03.975711 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m19:45:03.978021 [debug] [Thread-2 (]: Using duckdb connection "seed.ecomm.dim_user"
[0m19:45:03.979283 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: BEGIN
[0m19:45:03.980530 [debug] [Thread-2 (]: On seed.ecomm.dim_user: BEGIN
[0m19:45:03.981682 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:45:03.981682 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:45:03.983688 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:45:03.985689 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:45:03.985689 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m19:45:03.986693 [debug] [Thread-2 (]: Using duckdb connection "seed.ecomm.dim_user"
[0m19:45:03.987687 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "seed.ecomm.dim_sku"} */

    create table "warehouse"."main"."dim_sku" ("sku" text,"category" text)
  
[0m19:45:03.988688 [debug] [Thread-2 (]: On seed.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "seed.ecomm.dim_user"} */

    create table "warehouse"."main"."dim_user" ("user_id" text,"user_tier" text)
  
[0m19:45:03.989688 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:45:03.990688 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:45:04.004967 [debug] [Thread-2 (]: Using duckdb connection "seed.ecomm.dim_user"
[0m19:45:04.007965 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m19:45:04.010338 [debug] [Thread-2 (]: On seed.ecomm.dim_user: 
          COPY "warehouse"."main"."dim_user" FROM 'D:\weekend-de\e-commerce-clickstream-orders\dbt\data\dim_user.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:45:04.011344 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: 
          COPY "warehouse"."main"."dim_sku" FROM 'D:\weekend-de\e-commerce-clickstream-orders\dbt\data\dim_sku.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:45:04.022344 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m19:45:04.022344 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m19:45:04.028346 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecomm.dim_sku"
[0m19:45:04.029344 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ecomm.dim_user"
[0m19:45:04.043343 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: COMMIT
[0m19:45:04.045778 [debug] [Thread-2 (]: On seed.ecomm.dim_user: COMMIT
[0m19:45:04.046782 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m19:45:04.047783 [debug] [Thread-2 (]: Using duckdb connection "seed.ecomm.dim_user"
[0m19:45:04.048784 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: COMMIT
[0m19:45:04.048784 [debug] [Thread-2 (]: On seed.ecomm.dim_user: COMMIT
[0m19:45:04.052812 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:45:04.053811 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:45:04.056812 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: Close
[0m19:45:04.057810 [debug] [Thread-2 (]: On seed.ecomm.dim_user: Close
[0m19:45:04.063812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118FF9B9D0>]}
[0m19:45:04.065013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a8f03d3-4680-48e5-a66f-ce3e47d49294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211916F10F0>]}
[0m19:45:04.066019 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file main.dim_sku ........................................ [[32mINSERT 5[0m in 0.12s]
[0m19:45:04.067019 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file main.dim_user ....................................... [[32mINSERT 5[0m in 0.12s]
[0m19:45:04.068019 [debug] [Thread-1 (]: Finished running node seed.ecomm.dim_sku
[0m19:45:04.069021 [debug] [Thread-2 (]: Finished running node seed.ecomm.dim_user
[0m19:45:04.071019 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:04.072018 [debug] [MainThread]: On master: BEGIN
[0m19:45:04.073018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:04.074020 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:04.075019 [debug] [MainThread]: On master: COMMIT
[0m19:45:04.076535 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:04.077541 [debug] [MainThread]: On master: COMMIT
[0m19:45:04.077541 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:45:04.078540 [debug] [MainThread]: On master: Close
[0m19:45:04.078540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:04.079541 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m19:45:04.080542 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m19:45:04.081541 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m19:45:04.082543 [debug] [MainThread]: Connection 'seed.ecomm.dim_sku' was properly closed.
[0m19:45:04.082543 [debug] [MainThread]: Connection 'seed.ecomm.dim_user' was properly closed.
[0m19:45:04.084058 [info ] [MainThread]: 
[0m19:45:04.085068 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m19:45:04.087067 [debug] [MainThread]: Command end result
[0m19:45:04.117839 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:45:04.120845 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:45:04.128851 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\run_results.json
[0m19:45:04.129851 [info ] [MainThread]: 
[0m19:45:04.130850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:04.131851 [info ] [MainThread]: 
[0m19:45:04.132852 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:45:04.133854 [debug] [MainThread]: Command `dbt seed` succeeded at 19:45:04.133854 after 3.43 seconds
[0m19:45:04.134853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118DA56110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118FACD960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119145C940>]}
[0m19:45:04.134853 [debug] [MainThread]: Flushing usage events
[0m19:45:05.174129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:12.445457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FED965FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEEC70C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEEC70A90>]}


============================== 19:45:12.448477 | c5a76eb1-26d6-406d-91ac-5a6bfb2d12be ==============================
[0m19:45:12.448477 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:45:12.449456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:45:12.607344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEED77A00>]}
[0m19:45:12.663963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEE3D9DE0>]}
[0m19:45:12.665962 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:45:12.900384 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m19:45:13.097749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:45:13.098753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:45:13.149991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF02EBE20>]}
[0m19:45:13.234799 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:45:13.236800 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:45:13.293957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEF0C75E0>]}
[0m19:45:13.294958 [info ] [MainThread]: Found 7 models, 2 seeds, 12 data tests, 4 sources, 429 macros
[0m19:45:13.295956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEF0C75E0>]}
[0m19:45:13.296957 [info ] [MainThread]: 
[0m19:45:13.297981 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:45:13.298993 [info ] [MainThread]: 
[0m19:45:13.298993 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:45:13.303992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:45:13.374743 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:45:13.375743 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:45:13.375743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:13.394794 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m19:45:13.396795 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:45:13.397794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m19:45:13.397794 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m19:45:13.402810 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:45:13.402810 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:45:13.403793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:13.404793 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:13.405829 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:45:13.405829 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m19:45:13.406793 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:45:13.406793 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:45:13.407793 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m19:45:13.407793 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:45:13.408804 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m19:45:13.408804 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:45:13.409793 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m19:45:13.412878 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:45:13.412878 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m19:45:13.414914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m19:45:13.414914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m19:45:13.418883 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:45:13.421882 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:45:13.421882 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m19:45:13.422882 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m19:45:13.422882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:13.422882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:13.423884 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:13.424882 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:13.424882 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:45:13.424882 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:45:13.425882 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:45:13.425882 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:45:13.434920 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:45:13.434920 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:45:13.435882 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m19:45:13.436882 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m19:45:13.437882 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m19:45:13.438882 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m19:45:13.438882 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m19:45:13.438882 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m19:45:13.440882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEAD42E30>]}
[0m19:45:13.440882 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:13.441905 [debug] [MainThread]: On master: BEGIN
[0m19:45:13.441905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:13.442884 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:13.442884 [debug] [MainThread]: On master: COMMIT
[0m19:45:13.442884 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:13.442884 [debug] [MainThread]: On master: COMMIT
[0m19:45:13.444092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:45:13.444092 [debug] [MainThread]: On master: Close
[0m19:45:13.447096 [debug] [Thread-1 (]: Began running node model.ecomm.dim_sku
[0m19:45:13.448096 [debug] [Thread-2 (]: Began running node model.ecomm.dim_user
[0m19:45:13.448096 [debug] [Thread-3 (]: Began running node model.ecomm.fct_order_items
[0m19:45:13.448096 [debug] [Thread-4 (]: Began running node model.ecomm.fct_orders
[0m19:45:13.449097 [info ] [Thread-1 (]: 1 of 7 START sql table model main_main.dim_sku ................................. [RUN]
[0m19:45:13.449097 [info ] [Thread-2 (]: 2 of 7 START sql table model main_main.dim_user ................................ [RUN]
[0m19:45:13.450097 [info ] [Thread-3 (]: 3 of 7 START sql incremental model main_main.fct_order_items ................... [RUN]
[0m19:45:13.450097 [info ] [Thread-4 (]: 4 of 7 START sql incremental model main_main.fct_orders ........................ [RUN]
[0m19:45:13.451582 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.dim_sku'
[0m19:45:13.452588 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.dim_user'
[0m19:45:13.452588 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m19:45:13.452588 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_orders'
[0m19:45:13.454011 [debug] [Thread-1 (]: Began compiling node model.ecomm.dim_sku
[0m19:45:13.454011 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_user
[0m19:45:13.455016 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_order_items
[0m19:45:13.455016 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_orders
[0m19:45:13.461015 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.dim_sku"
[0m19:45:13.463016 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m19:45:13.465034 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m19:45:13.468015 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m19:45:13.470378 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_user
[0m19:45:13.470378 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_order_items
[0m19:45:13.471379 [debug] [Thread-1 (]: Began executing node model.ecomm.dim_sku
[0m19:45:13.471379 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_orders
[0m19:45:13.493913 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m19:45:13.515290 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m19:45:13.518290 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.dim_sku"
[0m19:45:13.521193 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m19:45:13.522749 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:45:13.523269 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m19:45:13.523782 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:45:13.524299 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m19:45:13.524299 [debug] [Thread-2 (]: On model.ecomm.dim_user: BEGIN
[0m19:45:13.525326 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: BEGIN
[0m19:45:13.525326 [debug] [Thread-1 (]: On model.ecomm.dim_sku: BEGIN
[0m19:45:13.525839 [debug] [Thread-4 (]: On model.ecomm.fct_orders: BEGIN
[0m19:45:13.526359 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:45:13.526970 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:45:13.527505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:45:13.528021 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:45:13.528533 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:45:13.529046 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:45:13.529557 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:45:13.530587 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:45:13.530587 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:45:13.531104 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m19:45:13.531626 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:45:13.532146 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m19:45:13.532659 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_user__dbt_tmp"
  
    as (
      
select * from "warehouse"."main"."dim_user"
    );
  
  
[0m19:45:13.533182 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_order_items"
  
    as (
      

with base as (
  select order_id, user_id, ts as order_ts, line_items
  from "warehouse"."main"."order_placed"
  where ts is not null and order_id is not null and line_items is not null
),
items as (
  select
    b.order_id,
    b.user_id,
    b.order_ts,
    li.sku as sku,
    li.qty as qty,
    li.price as price,
    (li.qty * li.price) as line_revenue,
    md5(concat(b.order_id,'|',cast(row_number() over (partition by b.order_id) as varchar))) as order_id_sku_row
  from base b,
  unnest(b.line_items) as t(li)
)
select * from items
    );
  
  
  
[0m19:45:13.533712 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_sku__dbt_tmp"
  
    as (
      
select * from "warehouse"."main"."dim_sku"
    );
  
  
[0m19:45:13.534260 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_orders"
  
    as (
      

with src as (
  select
    order_id,
    user_id,
    ts as order_ts,
    date_trunc('day', ts) as order_date,
    total as order_total
  from "warehouse"."main"."order_placed"
  where ts is not null and order_id is not null
)
select * from src
    );
  
  
  
[0m19:45:13.537390 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_order_items"
  
    as (
      

with base as (
  select order_id, user_id, ts as order_ts, line_items
  from "warehouse"."main"."order_placed"
  where ts is not null and order_id is not null and line_items is not null
),
items as (
  select
    b.order_id,
    b.user_id,
    b.order_ts,
    li.sku as sku,
    li.qty as qty,
    li.price as price,
    (li.qty * li.price) as line_revenue,
    md5(concat(b.order_id,'|',cast(row_number() over (partition by b.order_id) as varchar))) as order_id_sku_row
  from base b,
  unnest(b.line_items) as t(li)
)
select * from items
    );
  
  
  
[0m19:45:13.537903 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:45:13.538420 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:45:13.538938 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_orders"
  
    as (
      

with src as (
  select
    order_id,
    user_id,
    ts as order_ts,
    date_trunc('day', ts) as order_date,
    total as order_total
  from "warehouse"."main"."order_placed"
  where ts is not null and order_id is not null
)
select * from src
    );
  
  
  
[0m19:45:13.539470 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:45:13.544314 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:45:13.547395 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:45:13.547925 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:45:13.549040 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m19:45:13.549572 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */
alter table "warehouse"."main_main"."dim_sku__dbt_tmp" rename to "dim_sku"
[0m19:45:13.550156 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter table "warehouse"."main_main"."dim_user__dbt_tmp" rename to "dim_user"
[0m19:45:13.550156 [debug] [Thread-4 (]: On model.ecomm.fct_orders: ROLLBACK
[0m19:45:13.551355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:45:13.551880 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:45:13.560754 [debug] [Thread-1 (]: On model.ecomm.dim_sku: COMMIT
[0m19:45:13.562786 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m19:45:13.563323 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:45:13.564337 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:45:13.564337 [debug] [Thread-1 (]: On model.ecomm.dim_sku: COMMIT
[0m19:45:13.565337 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m19:45:13.568336 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:45:13.569336 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:45:13.573112 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:45:13.575116 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:45:13.576126 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */

      drop table if exists "warehouse"."main_main"."dim_sku__dbt_backup" cascade
    
[0m19:45:13.576126 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

      drop table if exists "warehouse"."main_main"."dim_user__dbt_backup" cascade
    
[0m19:45:13.577117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:45:13.578117 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:45:13.578117 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_orders'
[0m19:45:13.580146 [debug] [Thread-1 (]: On model.ecomm.dim_sku: Close
[0m19:45:13.581135 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m19:45:13.581722 [debug] [Thread-2 (]: On model.ecomm.dim_user: Close
[0m19:45:13.582762 [debug] [Thread-4 (]: On model.ecomm.fct_orders: Close
[0m19:45:13.583781 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: Close
[0m19:45:13.584777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF01D6E30>]}
[0m19:45:13.584777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FEEBCB9D0>]}
[0m19:45:13.585777 [info ] [Thread-1 (]: 1 of 7 OK created sql table model main_main.dim_sku ............................ [[32mOK[0m in 0.13s]
[0m19:45:13.586778 [info ] [Thread-2 (]: 2 of 7 OK created sql table model main_main.dim_user ........................... [[32mOK[0m in 0.13s]
[0m19:45:13.588024 [debug] [Thread-1 (]: Finished running node model.ecomm.dim_sku
[0m19:45:13.589024 [debug] [Thread-4 (]: Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 20:   from "warehouse"."main"."order_placed"
                  ^
[0m19:45:13.589024 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_user
[0m19:45:13.590024 [debug] [Thread-3 (]: Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 15:   from "warehouse"."main"."order_placed"
                  ^
[0m19:45:13.590024 [debug] [Thread-1 (]: Began running node model.ecomm.fct_revenue_daily
[0m19:45:13.590024 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF0365C90>]}
[0m19:45:13.591024 [debug] [Thread-2 (]: Began running node model.ecomm.fct_sessions
[0m19:45:13.591024 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF06DFF40>]}
[0m19:45:13.592024 [info ] [Thread-1 (]: 5 of 7 START sql incremental model main_main.fct_revenue_daily ................. [RUN]
[0m19:45:13.593024 [error] [Thread-4 (]: 4 of 7 ERROR creating sql incremental model main_main.fct_orders ............... [[31mERROR[0m in 0.14s]
[0m19:45:13.593024 [info ] [Thread-2 (]: 6 of 7 START sql table model main_main.fct_sessions ............................ [RUN]
[0m19:45:13.594024 [error] [Thread-3 (]: 3 of 7 ERROR creating sql incremental model main_main.fct_order_items .......... [[31mERROR[0m in 0.14s]
[0m19:45:13.595024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.dim_sku, now model.ecomm.fct_revenue_daily)
[0m19:45:13.595024 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_orders
[0m19:45:13.596061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.dim_user, now model.ecomm.fct_sessions)
[0m19:45:13.597025 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_order_items
[0m19:45:13.597025 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_revenue_daily
[0m19:45:13.598024 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 20:   from "warehouse"."main"."order_placed"
                  ^.
[0m19:45:13.598024 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_sessions
[0m19:45:13.601024 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_revenue_daily"
[0m19:45:13.602023 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 15:   from "warehouse"."main"."order_placed"
                  ^.
[0m19:45:13.605023 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m19:45:13.606023 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m19:45:13.606023 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_revenue_daily
[0m19:45:13.607024 [info ] [Thread-4 (]: 7 of 7 SKIP relation main_main.fct_revenue_by_category_daily ................... [[33mSKIP[0m]
[0m19:45:13.610441 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_revenue_daily"
[0m19:45:13.610441 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_sessions
[0m19:45:13.610441 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m19:45:13.614442 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m19:45:13.615460 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m19:45:13.616442 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: BEGIN
[0m19:45:13.616442 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m19:45:13.617443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:13.617443 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: BEGIN
[0m19:45:13.618443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:45:13.618443 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:45:13.619443 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m19:45:13.619443 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:45:13.620442 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_revenue_daily"
  
    as (
      

with o as (
  select
    date_trunc('day', ts) as order_date,
    sum(total) as revenue
  from "warehouse"."main"."order_placed"
  where ts is not null
  group by 1
)
select * from o
    );
  
  
  
[0m19:45:13.620442 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m19:45:13.621442 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_sessions__dbt_tmp"
  
    as (
      

select
  session_id,
  user_id,
  session_start,
  session_end,
  page_count,
  cart_events,
  conversion_flag
from "warehouse"."main"."sessions"
    );
  
  
[0m19:45:13.621442 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_revenue_daily"
  
    as (
      

with o as (
  select
    date_trunc('day', ts) as order_date,
    sum(total) as revenue
  from "warehouse"."main"."order_placed"
  where ts is not null
  group by 1
)
select * from o
    );
  
  
  
[0m19:45:13.622443 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:45:13.622443 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_sessions__dbt_tmp"
  
    as (
      

select
  session_id,
  user_id,
  session_start,
  session_end,
  page_count,
  cart_events,
  conversion_flag
from "warehouse"."main"."sessions"
    );
  
  
[0m19:45:13.623443 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: ROLLBACK
[0m19:45:13.623443 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m19:45:13.624443 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: ROLLBACK
[0m19:45:13.626442 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.fct_revenue_daily'
[0m19:45:13.626442 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: Close
[0m19:45:13.627443 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.fct_sessions'
[0m19:45:13.627443 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: Close
[0m19:45:13.628443 [debug] [Thread-1 (]: Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 17:   from "warehouse"."main"."order_placed"
                  ^
[0m19:45:13.629479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF01D6E30>]}
[0m19:45:13.630443 [debug] [Thread-2 (]: Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  Catalog Error: Table with name sessions does not exist!
  Did you mean "pg_catalog.pg_settings"?
  
  LINE 21: from "warehouse"."main"."sessions"
                ^
[0m19:45:13.631442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a76eb1-26d6-406d-91ac-5a6bfb2d12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF093BA30>]}
[0m19:45:13.630443 [error] [Thread-1 (]: 5 of 7 ERROR creating sql incremental model main_main.fct_revenue_daily ........ [[31mERROR[0m in 0.03s]
[0m19:45:13.631442 [error] [Thread-2 (]: 6 of 7 ERROR creating sql table model main_main.fct_sessions ................... [[31mERROR[0m in 0.04s]
[0m19:45:13.632444 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_revenue_daily
[0m19:45:13.633442 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_sessions
[0m19:45:13.634442 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_revenue_daily' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 17:   from "warehouse"."main"."order_placed"
                  ^.
[0m19:45:13.635441 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  Catalog Error: Table with name sessions does not exist!
  Did you mean "pg_catalog.pg_settings"?
  
  LINE 21: from "warehouse"."main"."sessions"
                ^.
[0m19:45:13.636443 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:13.636443 [debug] [MainThread]: On master: BEGIN
[0m19:45:13.637442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:13.638442 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:45:13.638442 [debug] [MainThread]: On master: COMMIT
[0m19:45:13.639441 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:13.639441 [debug] [MainThread]: On master: COMMIT
[0m19:45:13.639441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:45:13.640441 [debug] [MainThread]: On master: Close
[0m19:45:13.640441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:13.641441 [debug] [MainThread]: Connection 'create_warehouse_main_main' was properly closed.
[0m19:45:13.641441 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m19:45:13.642442 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m19:45:13.642442 [debug] [MainThread]: Connection 'model.ecomm.fct_revenue_daily' was properly closed.
[0m19:45:13.642442 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m19:45:13.643562 [debug] [MainThread]: Connection 'model.ecomm.fct_order_items' was properly closed.
[0m19:45:13.643562 [debug] [MainThread]: Connection 'model.ecomm.fct_orders' was properly closed.
[0m19:45:13.643562 [info ] [MainThread]: 
[0m19:45:13.644566 [info ] [MainThread]: Finished running 4 incremental models, 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:45:13.645566 [debug] [MainThread]: Command end result
[0m19:45:13.661565 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:45:13.663567 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:45:13.669567 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\run_results.json
[0m19:45:13.670566 [info ] [MainThread]: 
[0m19:45:13.671566 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m19:45:13.671566 [info ] [MainThread]: 
[0m19:45:13.672570 [error] [MainThread]: [31mFailure in model fct_orders (models\gold\fct_orders.sql)[0m
[0m19:45:13.672570 [error] [MainThread]:   Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 20:   from "warehouse"."main"."order_placed"
                  ^
[0m19:45:13.673743 [info ] [MainThread]: 
[0m19:45:13.673743 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_orders.sql
[0m19:45:13.674832 [info ] [MainThread]: 
[0m19:45:13.674832 [error] [MainThread]: [31mFailure in model fct_order_items (models\gold\fct_order_items.sql)[0m
[0m19:45:13.675840 [error] [MainThread]:   Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 15:   from "warehouse"."main"."order_placed"
                  ^
[0m19:45:13.675840 [info ] [MainThread]: 
[0m19:45:13.676843 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_order_items.sql
[0m19:45:13.677841 [info ] [MainThread]: 
[0m19:45:13.678841 [error] [MainThread]: [31mFailure in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)[0m
[0m19:45:13.678841 [error] [MainThread]:   Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  Catalog Error: Table with name order_placed does not exist!
  Did you mean "dim_user"?
  
  LINE 17:   from "warehouse"."main"."order_placed"
                  ^
[0m19:45:13.679841 [info ] [MainThread]: 
[0m19:45:13.679841 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_revenue_daily.sql
[0m19:45:13.680842 [info ] [MainThread]: 
[0m19:45:13.680842 [error] [MainThread]: [31mFailure in model fct_sessions (models\gold\fct_sessions.sql)[0m
[0m19:45:13.680842 [error] [MainThread]:   Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  Catalog Error: Table with name sessions does not exist!
  Did you mean "pg_catalog.pg_settings"?
  
  LINE 21: from "warehouse"."main"."sessions"
                ^
[0m19:45:13.682286 [info ] [MainThread]: 
[0m19:45:13.682286 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_sessions.sql
[0m19:45:13.683291 [info ] [MainThread]: 
[0m19:45:13.683291 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m19:45:13.685292 [debug] [MainThread]: Command `dbt run` failed at 19:45:13.684290 after 1.30 seconds
[0m19:45:13.685292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FED965FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF01CBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011FF01CB2E0>]}
[0m19:45:13.685292 [debug] [MainThread]: Flushing usage events
[0m19:45:14.897641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:57.767169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1E866080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F20B40CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F20B40AF0>]}


============================== 19:47:57.770672 | 3f5c07b5-6962-479b-9cf1-27a64a3e6239 ==============================
[0m19:47:57.770672 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:47:57.771672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:47:57.955497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F20C60400>]}
[0m19:47:58.015587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F20401630>]}
[0m19:47:58.018821 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:47:58.257078 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m19:47:58.440724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:47:58.441723 [debug] [MainThread]: Partial parsing: updated file: ecomm://models\sources.yml
[0m19:47:58.966522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F224E8D60>]}
[0m19:47:59.051760 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:47:59.054759 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:47:59.079760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F224E8160>]}
[0m19:47:59.079760 [info ] [MainThread]: Found 7 models, 2 seeds, 12 data tests, 4 sources, 429 macros
[0m19:47:59.080782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2213FCA0>]}
[0m19:47:59.082759 [info ] [MainThread]: 
[0m19:47:59.082759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:59.083759 [info ] [MainThread]: 
[0m19:47:59.084762 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:47:59.090762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:47:59.178130 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:47:59.178689 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:47:59.179255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:59.191588 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m19:47:59.192588 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:47:59.193592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m19:47:59.194588 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m19:47:59.199606 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:47:59.200588 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:47:59.200588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:59.201608 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:59.202588 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:47:59.203592 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m19:47:59.204592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:59.204592 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:47:59.205592 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m19:47:59.205592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:59.206592 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m19:47:59.206592 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:47:59.207591 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m19:47:59.207591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:59.208590 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m19:47:59.209591 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m19:47:59.214607 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:47:59.214607 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m19:47:59.215592 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m19:47:59.217592 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:47:59.218099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:59.219105 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m19:47:59.220106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:59.220106 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:47:59.220106 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:59.221104 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:47:59.221104 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:47:59.221104 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:47:59.222178 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:47:59.232263 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:47:59.232263 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:47:59.234267 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m19:47:59.235268 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m19:47:59.236267 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m19:47:59.236267 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m19:47:59.236267 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m19:47:59.237267 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m19:47:59.238268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1CEAA8C0>]}
[0m19:47:59.239268 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:59.239268 [debug] [MainThread]: On master: BEGIN
[0m19:47:59.240268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:59.240268 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:47:59.241268 [debug] [MainThread]: On master: COMMIT
[0m19:47:59.241268 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:59.241268 [debug] [MainThread]: On master: COMMIT
[0m19:47:59.242269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:59.242269 [debug] [MainThread]: On master: Close
[0m19:47:59.246269 [debug] [Thread-1 (]: Began running node model.ecomm.dim_sku
[0m19:47:59.246269 [debug] [Thread-2 (]: Began running node model.ecomm.dim_user
[0m19:47:59.247268 [debug] [Thread-3 (]: Began running node model.ecomm.fct_order_items
[0m19:47:59.247268 [debug] [Thread-4 (]: Began running node model.ecomm.fct_orders
[0m19:47:59.247268 [info ] [Thread-1 (]: 1 of 7 START sql table model main_main.dim_sku ................................. [RUN]
[0m19:47:59.248269 [info ] [Thread-2 (]: 2 of 7 START sql table model main_main.dim_user ................................ [RUN]
[0m19:47:59.249267 [info ] [Thread-3 (]: 3 of 7 START sql incremental model main_main.fct_order_items ................... [RUN]
[0m19:47:59.249267 [info ] [Thread-4 (]: 4 of 7 START sql incremental model main_main.fct_orders ........................ [RUN]
[0m19:47:59.250267 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.dim_sku'
[0m19:47:59.251269 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.dim_user'
[0m19:47:59.251269 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m19:47:59.252267 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_orders'
[0m19:47:59.252267 [debug] [Thread-1 (]: Began compiling node model.ecomm.dim_sku
[0m19:47:59.253269 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_user
[0m19:47:59.253269 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_order_items
[0m19:47:59.254269 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_orders
[0m19:47:59.260283 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.dim_sku"
[0m19:47:59.262269 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m19:47:59.265679 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m19:47:59.267938 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m19:47:59.268957 [debug] [Thread-1 (]: Began executing node model.ecomm.dim_sku
[0m19:47:59.269939 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_user
[0m19:47:59.269939 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_order_items
[0m19:47:59.291955 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.dim_sku"
[0m19:47:59.292937 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_orders
[0m19:47:59.295958 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m19:47:59.318958 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m19:47:59.322967 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m19:47:59.322967 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:47:59.323964 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:47:59.324966 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m19:47:59.324966 [debug] [Thread-1 (]: On model.ecomm.dim_sku: BEGIN
[0m19:47:59.325965 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m19:47:59.325965 [debug] [Thread-2 (]: On model.ecomm.dim_user: BEGIN
[0m19:47:59.326964 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: BEGIN
[0m19:47:59.326964 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:47:59.327966 [debug] [Thread-4 (]: On model.ecomm.fct_orders: BEGIN
[0m19:47:59.327966 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:47:59.328964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:47:59.329965 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:47:59.329965 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:47:59.329965 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:47:59.330965 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:47:59.330965 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:47:59.331969 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:47:59.331969 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:47:59.332969 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m19:47:59.332969 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_sku__dbt_tmp"
  
    as (
      
select * from "warehouse"."main"."dim_sku"
    );
  
  
[0m19:47:59.333970 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m19:47:59.333970 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_user__dbt_tmp"
  
    as (
      
select * from "warehouse"."main"."dim_user"
    );
  
  
[0m19:47:59.334969 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_order_items"
  
    as (
      

with base as (
  select order_id, user_id, ts as order_ts, line_items
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null and line_items is not null
),
items as (
  select
    b.order_id,
    b.user_id,
    b.order_ts,
    li.sku as sku,
    li.qty as qty,
    li.price as price,
    (li.qty * li.price) as line_revenue,
    md5(concat(b.order_id,'|',cast(row_number() over (partition by b.order_id) as varchar))) as order_id_sku_row
  from base b,
  unnest(b.line_items) as t(li)
)
select * from items
    );
  
  
  
[0m19:47:59.334969 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_orders"
  
    as (
      

with src as (
  select
    order_id,
    user_id,
    ts as order_ts,
    date_trunc('day', ts) as order_date,
    total as order_total
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null
)
select * from src
    );
  
  
  
[0m19:47:59.335969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:47:59.335969 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:47:59.336970 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_order_items"
  
    as (
      

with base as (
  select order_id, user_id, ts as order_ts, line_items
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null and line_items is not null
),
items as (
  select
    b.order_id,
    b.user_id,
    b.order_ts,
    li.sku as sku,
    li.qty as qty,
    li.price as price,
    (li.qty * li.price) as line_revenue,
    md5(concat(b.order_id,'|',cast(row_number() over (partition by b.order_id) as varchar))) as order_id_sku_row
  from base b,
  unnest(b.line_items) as t(li)
)
select * from items
    );
  
  
  
[0m19:47:59.340985 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:47:59.341968 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_orders"
  
    as (
      

with src as (
  select
    order_id,
    user_id,
    ts as order_ts,
    date_trunc('day', ts) as order_date,
    total as order_total
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null
)
select * from src
    );
  
  
  
[0m19:47:59.343970 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:47:59.344969 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:47:59.344969 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */
alter table "warehouse"."main_main"."dim_sku" rename to "dim_sku__dbt_backup"
[0m19:47:59.344969 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:47:59.346473 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter table "warehouse"."main_main"."dim_user" rename to "dim_user__dbt_backup"
[0m19:47:59.346473 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m19:47:59.347479 [debug] [Thread-4 (]: On model.ecomm.fct_orders: ROLLBACK
[0m19:47:59.347479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:47:59.348478 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:47:59.351495 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:47:59.353496 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:47:59.354478 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */
alter table "warehouse"."main_main"."dim_sku__dbt_tmp" rename to "dim_sku"
[0m19:47:59.354478 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter table "warehouse"."main_main"."dim_user__dbt_tmp" rename to "dim_user"
[0m19:47:59.355477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:47:59.367222 [debug] [Thread-1 (]: On model.ecomm.dim_sku: COMMIT
[0m19:47:59.368205 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m19:47:59.368205 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:47:59.370236 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m19:47:59.371206 [debug] [Thread-1 (]: On model.ecomm.dim_sku: COMMIT
[0m19:47:59.371206 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:47:59.372511 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m19:47:59.373512 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_orders'
[0m19:47:59.374201 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m19:47:59.375206 [debug] [Thread-4 (]: On model.ecomm.fct_orders: Close
[0m19:47:59.375206 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:47:59.376206 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: Close
[0m19:47:59.376206 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:47:59.380221 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:47:59.383206 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:47:59.384206 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */

      drop table if exists "warehouse"."main_main"."dim_sku__dbt_backup" cascade
    
[0m19:47:59.384206 [debug] [Thread-4 (]: Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:47:59.385207 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

      drop table if exists "warehouse"."main_main"."dim_user__dbt_backup" cascade
    
[0m19:47:59.386206 [debug] [Thread-3 (]: Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:47:59.387207 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:47:59.388206 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F223E6920>]}
[0m19:47:59.388206 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F22A53A30>]}
[0m19:47:59.389206 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:47:59.391223 [debug] [Thread-1 (]: On model.ecomm.dim_sku: Close
[0m19:47:59.392205 [error] [Thread-4 (]: 4 of 7 ERROR creating sql incremental model main_main.fct_orders ............... [[31mERROR[0m in 0.13s]
[0m19:47:59.392205 [error] [Thread-3 (]: 3 of 7 ERROR creating sql incremental model main_main.fct_order_items .......... [[31mERROR[0m in 0.14s]
[0m19:47:59.393206 [debug] [Thread-2 (]: On model.ecomm.dim_user: Close
[0m19:47:59.394208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1CEAA8C0>]}
[0m19:47:59.395205 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_orders
[0m19:47:59.395205 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_order_items
[0m19:47:59.396207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F22ABC580>]}
[0m19:47:59.396207 [info ] [Thread-1 (]: 1 of 7 OK created sql table model main_main.dim_sku ............................ [[32mOK[0m in 0.14s]
[0m19:47:59.397207 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_daily
[0m19:47:59.397207 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet".
[0m19:47:59.398205 [debug] [Thread-3 (]: Began running node model.ecomm.fct_sessions
[0m19:47:59.398205 [info ] [Thread-2 (]: 2 of 7 OK created sql table model main_main.dim_user ........................... [[32mOK[0m in 0.14s]
[0m19:47:59.399207 [debug] [Thread-1 (]: Finished running node model.ecomm.dim_sku
[0m19:47:59.400206 [info ] [Thread-4 (]: 5 of 7 START sql incremental model main_main.fct_revenue_daily ................. [RUN]
[0m19:47:59.401206 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet".
[0m19:47:59.401206 [info ] [Thread-3 (]: 6 of 7 START sql table model main_main.fct_sessions ............................ [RUN]
[0m19:47:59.402206 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_user
[0m19:47:59.403205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.fct_revenue_daily)
[0m19:47:59.404206 [debug] [Thread-1 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m19:47:59.404206 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.fct_sessions)
[0m19:47:59.405207 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_revenue_daily
[0m19:47:59.406213 [info ] [Thread-1 (]: 7 of 7 SKIP relation main_main.fct_revenue_by_category_daily ................... [[33mSKIP[0m]
[0m19:47:59.406213 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_sessions
[0m19:47:59.409213 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_revenue_daily"
[0m19:47:59.409213 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m19:47:59.412233 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m19:47:59.413212 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_revenue_daily
[0m19:47:59.416210 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_revenue_daily"
[0m19:47:59.416210 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_sessions
[0m19:47:59.419214 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m19:47:59.419214 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m19:47:59.420211 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: BEGIN
[0m19:47:59.421212 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m19:47:59.421212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:47:59.421212 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: BEGIN
[0m19:47:59.422529 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:47:59.422529 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:47:59.422529 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m19:47:59.423529 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:47:59.423529 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_revenue_daily"
  
    as (
      

with o as (
  select
    date_trunc('day', ts) as order_date,
    sum(total) as revenue
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null
  group by 1
)
select * from o
    );
  
  
  
[0m19:47:59.424529 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m19:47:59.425528 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_sessions__dbt_tmp"
  
    as (
      

select
  session_id,
  user_id,
  session_start,
  session_end,
  page_count,
  cart_events,
  conversion_flag
from read_parquet('../data/silver/sessions/*.parquet')
    );
  
  
[0m19:47:59.425528 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_revenue_daily"
  
    as (
      

with o as (
  select
    date_trunc('day', ts) as order_date,
    sum(total) as revenue
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null
  group by 1
)
select * from o
    );
  
  
  
[0m19:47:59.426528 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:47:59.426528 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_sessions__dbt_tmp"
  
    as (
      

select
  session_id,
  user_id,
  session_start,
  session_end,
  page_count,
  cart_events,
  conversion_flag
from read_parquet('../data/silver/sessions/*.parquet')
    );
  
  
[0m19:47:59.427528 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: ROLLBACK
[0m19:47:59.427528 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:47:59.428528 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: ROLLBACK
[0m19:47:59.429528 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_revenue_daily'
[0m19:47:59.430527 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: Close
[0m19:47:59.431528 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.fct_sessions'
[0m19:47:59.431528 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: Close
[0m19:47:59.432528 [debug] [Thread-4 (]: Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:47:59.433528 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1E729B70>]}
[0m19:47:59.433528 [error] [Thread-4 (]: 5 of 7 ERROR creating sql incremental model main_main.fct_revenue_daily ........ [[31mERROR[0m in 0.03s]
[0m19:47:59.434529 [debug] [Thread-3 (]: Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  IO Error: No files found that match the pattern "../data/silver/sessions/*.parquet"
[0m19:47:59.435528 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_daily
[0m19:47:59.435528 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5c07b5-6962-479b-9cf1-27a64a3e6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F22A53A30>]}
[0m19:47:59.436528 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_revenue_daily' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet".
[0m19:47:59.437527 [error] [Thread-3 (]: 6 of 7 ERROR creating sql table model main_main.fct_sessions ................... [[31mERROR[0m in 0.03s]
[0m19:47:59.437527 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_sessions
[0m19:47:59.438529 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  IO Error: No files found that match the pattern "../data/silver/sessions/*.parquet".
[0m19:47:59.439528 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:59.440528 [debug] [MainThread]: On master: BEGIN
[0m19:47:59.440528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:59.441528 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:47:59.441528 [debug] [MainThread]: On master: COMMIT
[0m19:47:59.441528 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:59.442527 [debug] [MainThread]: On master: COMMIT
[0m19:47:59.442527 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:59.443527 [debug] [MainThread]: On master: Close
[0m19:47:59.443527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:59.444527 [debug] [MainThread]: Connection 'create_warehouse_main_main' was properly closed.
[0m19:47:59.444527 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m19:47:59.444527 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m19:47:59.445527 [debug] [MainThread]: Connection 'model.ecomm.dim_sku' was properly closed.
[0m19:47:59.445527 [debug] [MainThread]: Connection 'model.ecomm.dim_user' was properly closed.
[0m19:47:59.445527 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m19:47:59.446529 [debug] [MainThread]: Connection 'model.ecomm.fct_revenue_daily' was properly closed.
[0m19:47:59.446529 [info ] [MainThread]: 
[0m19:47:59.447527 [info ] [MainThread]: Finished running 4 incremental models, 3 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m19:47:59.448528 [debug] [MainThread]: Command end result
[0m19:47:59.464533 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:47:59.467550 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:47:59.472545 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\run_results.json
[0m19:47:59.473528 [info ] [MainThread]: 
[0m19:47:59.473528 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m19:47:59.474530 [info ] [MainThread]: 
[0m19:47:59.474530 [error] [MainThread]: [31mFailure in model fct_orders (models\gold\fct_orders.sql)[0m
[0m19:47:59.475528 [error] [MainThread]:   Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:47:59.475528 [info ] [MainThread]: 
[0m19:47:59.476527 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_orders.sql
[0m19:47:59.476527 [info ] [MainThread]: 
[0m19:47:59.477527 [error] [MainThread]: [31mFailure in model fct_order_items (models\gold\fct_order_items.sql)[0m
[0m19:47:59.477527 [error] [MainThread]:   Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:47:59.478539 [info ] [MainThread]: 
[0m19:47:59.478539 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_order_items.sql
[0m19:47:59.479528 [info ] [MainThread]: 
[0m19:47:59.479528 [error] [MainThread]: [31mFailure in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)[0m
[0m19:47:59.480528 [error] [MainThread]:   Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:47:59.480528 [info ] [MainThread]: 
[0m19:47:59.481528 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_revenue_daily.sql
[0m19:47:59.482528 [info ] [MainThread]: 
[0m19:47:59.482528 [error] [MainThread]: [31mFailure in model fct_sessions (models\gold\fct_sessions.sql)[0m
[0m19:47:59.483533 [error] [MainThread]:   Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  IO Error: No files found that match the pattern "../data/silver/sessions/*.parquet"
[0m19:47:59.483533 [info ] [MainThread]: 
[0m19:47:59.484529 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_sessions.sql
[0m19:47:59.484529 [info ] [MainThread]: 
[0m19:47:59.485528 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m19:47:59.486528 [debug] [MainThread]: Command `dbt run` failed at 19:47:59.486528 after 1.79 seconds
[0m19:47:59.487529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1E866080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F20C61840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F22A97640>]}
[0m19:47:59.487529 [debug] [MainThread]: Flushing usage events
[0m19:48:00.677370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:16.713117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153554B6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001535778CC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001535778CA30>]}


============================== 19:51:16.716668 | 3b28fb65-aacd-44e8-bb76-c32b5a7347fa ==============================
[0m19:51:16.716668 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:51:16.717668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:51:16.810923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b28fb65-aacd-44e8-bb76-c32b5a7347fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153577937F0>]}
[0m19:51:16.835032 [debug] [MainThread]: Command `dbt clean` succeeded at 19:51:16.835032 after 0.18 seconds
[0m19:51:16.835032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153554B6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153578E5D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015357790700>]}
[0m19:51:16.836033 [debug] [MainThread]: Flushing usage events
[0m19:51:17.761673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:19.735135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025337B260B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025339DFCC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025339DFCA30>]}


============================== 19:51:19.739644 | 8c907b45-42ba-44b5-b526-c3a657da62a2 ==============================
[0m19:51:19.739644 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:51:19.740643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:51:19.757694 [info ] [MainThread]: dbt version: 1.10.8
[0m19:51:19.758695 [info ] [MainThread]: python version: 3.10.11
[0m19:51:19.758695 [info ] [MainThread]: python path: D:\weekend-de\e-commerce-clickstream-orders\.venv\Scripts\python.exe
[0m19:51:19.759693 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m19:51:19.845353 [info ] [MainThread]: Using profiles dir at D:\weekend-de\e-commerce-clickstream-orders\dbt
[0m19:51:19.846348 [info ] [MainThread]: Using profiles.yml file at D:\weekend-de\e-commerce-clickstream-orders\dbt\profiles.yml
[0m19:51:19.846348 [info ] [MainThread]: Using dbt_project.yml file at D:\weekend-de\e-commerce-clickstream-orders\dbt\dbt_project.yml
[0m19:51:19.848347 [info ] [MainThread]: adapter type: duckdb
[0m19:51:19.849364 [info ] [MainThread]: adapter version: 1.9.4
[0m19:51:19.927457 [info ] [MainThread]: Configuration:
[0m19:51:19.928457 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:51:19.928457 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:51:19.929458 [info ] [MainThread]: Required dependencies:
[0m19:51:19.929458 [debug] [MainThread]: Executing "git --help"
[0m19:51:19.954462 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:51:19.954462 [debug] [MainThread]: STDERR: "b''"
[0m19:51:19.955462 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:51:19.956461 [info ] [MainThread]: Connection:
[0m19:51:19.956461 [info ] [MainThread]:   database: warehouse
[0m19:51:19.957461 [info ] [MainThread]:   schema: main
[0m19:51:19.957461 [info ] [MainThread]:   path: ./warehouse.duckdb
[0m19:51:19.958462 [info ] [MainThread]:   config_options: None
[0m19:51:19.958462 [info ] [MainThread]:   extensions: None
[0m19:51:19.959461 [info ] [MainThread]:   settings: {}
[0m19:51:19.959461 [info ] [MainThread]:   external_root: ../data
[0m19:51:19.960461 [info ] [MainThread]:   use_credential_provider: None
[0m19:51:19.960461 [info ] [MainThread]:   attach: None
[0m19:51:19.961462 [info ] [MainThread]:   filesystems: None
[0m19:51:19.961462 [info ] [MainThread]:   remote: None
[0m19:51:19.962462 [info ] [MainThread]:   plugins: None
[0m19:51:19.962462 [info ] [MainThread]:   disable_transactions: False
[0m19:51:19.963461 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:51:20.177530 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m19:51:20.237891 [debug] [MainThread]: Using duckdb connection "debug"
[0m19:51:20.237891 [debug] [MainThread]: On debug: select 1 as id
[0m19:51:20.237891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:20.261942 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m19:51:20.262941 [debug] [MainThread]: On debug: Close
[0m19:51:20.262941 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:51:20.262941 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:51:20.264248 [debug] [MainThread]: Command `dbt debug` succeeded at 19:51:20.264248 after 0.59 seconds
[0m19:51:20.265252 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:51:20.265252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025337B260B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533A40FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025339EFF9A0>]}
[0m19:51:20.266253 [debug] [MainThread]: Flushing usage events
[0m19:51:21.345338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:23.011423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC2266080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC3570CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC3570AF0>]}


============================== 19:51:23.014868 | 09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7 ==============================
[0m19:51:23.014868 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:51:23.015848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:51:23.170735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC3690400>]}
[0m19:51:23.214473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC2E31630>]}
[0m19:51:23.216592 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:51:23.434024 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m19:51:23.435033 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:51:23.435925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC3812DD0>]}
[0m19:51:24.315103 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_user' is a seed node, but it is specified in the models section of
models\gold\schema.yml. To fix this error, place the `dim_user` specification
under the seeds key instead.
[0m19:51:24.317134 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_sku' is a seed node, but it is specified in the models section of
models\gold\schema.yml. To fix this error, place the `dim_sku` specification
under the seeds key instead.
[0m19:51:24.557557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4DE0AC0>]}
[0m19:51:24.639310 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:51:24.642313 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:51:24.669314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4DFEBF0>]}
[0m19:51:24.670315 [info ] [MainThread]: Found 7 models, 2 seeds, 12 data tests, 4 sources, 429 macros
[0m19:51:24.671316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4DFECB0>]}
[0m19:51:24.672315 [info ] [MainThread]: 
[0m19:51:24.673818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:24.673818 [info ] [MainThread]: 
[0m19:51:24.674822 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:51:24.679822 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:51:24.749586 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:51:24.750585 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:51:24.750585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:24.764590 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m19:51:24.766590 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:51:24.767590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m19:51:24.767590 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m19:51:24.772589 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:51:24.773589 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:51:24.774093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:24.775097 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:51:24.776097 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:51:24.776097 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m19:51:24.777097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:24.777097 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:51:24.777097 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m19:51:24.778097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:24.779097 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m19:51:24.779097 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m19:51:24.779097 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m19:51:24.780098 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:24.781098 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m19:51:24.782098 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m19:51:24.783097 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m19:51:24.787097 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:51:24.789096 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:51:24.790096 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m19:51:24.790096 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m19:51:24.791096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:24.791096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:24.792096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:51:24.792096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:51:24.793098 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:51:24.793098 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:51:24.794097 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:51:24.794097 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:51:24.804097 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:51:24.805098 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m19:51:24.806098 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:51:24.807097 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m19:51:24.808097 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m19:51:24.808097 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m19:51:24.809097 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m19:51:24.810097 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m19:51:24.811097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4E22FE0>]}
[0m19:51:24.812097 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:24.812097 [debug] [MainThread]: On master: BEGIN
[0m19:51:24.813097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:24.814097 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:24.815097 [debug] [MainThread]: On master: COMMIT
[0m19:51:24.816096 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:24.816096 [debug] [MainThread]: On master: COMMIT
[0m19:51:24.817096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:24.818096 [debug] [MainThread]: On master: Close
[0m19:51:24.822096 [debug] [Thread-1 (]: Began running node model.ecomm.dim_sku
[0m19:51:24.823096 [debug] [Thread-2 (]: Began running node model.ecomm.dim_user
[0m19:51:24.823096 [debug] [Thread-3 (]: Began running node model.ecomm.fct_order_items
[0m19:51:24.823096 [debug] [Thread-4 (]: Began running node model.ecomm.fct_orders
[0m19:51:24.824097 [info ] [Thread-1 (]: 1 of 7 START sql table model main_main.dim_sku ................................. [RUN]
[0m19:51:24.825097 [info ] [Thread-2 (]: 2 of 7 START sql table model main_main.dim_user ................................ [RUN]
[0m19:51:24.825097 [info ] [Thread-3 (]: 3 of 7 START sql incremental model main_main.fct_order_items ................... [RUN]
[0m19:51:24.826096 [info ] [Thread-4 (]: 4 of 7 START sql incremental model main_main.fct_orders ........................ [RUN]
[0m19:51:24.827096 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.dim_sku'
[0m19:51:24.827096 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.dim_user'
[0m19:51:24.828097 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m19:51:24.829096 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_orders'
[0m19:51:24.829096 [debug] [Thread-1 (]: Began compiling node model.ecomm.dim_sku
[0m19:51:24.830096 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_user
[0m19:51:24.830096 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_order_items
[0m19:51:24.831096 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_orders
[0m19:51:24.836097 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.dim_sku"
[0m19:51:24.839096 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m19:51:24.842098 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m19:51:24.845100 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m19:51:24.851099 [debug] [Thread-1 (]: Began executing node model.ecomm.dim_sku
[0m19:51:24.852098 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_orders
[0m19:51:24.852098 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_user
[0m19:51:24.853098 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_order_items
[0m19:51:24.878618 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.dim_sku"
[0m19:51:24.900658 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m19:51:24.903838 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m19:51:24.906416 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m19:51:24.908398 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m19:51:24.909399 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:51:24.909399 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:51:24.910398 [debug] [Thread-4 (]: On model.ecomm.fct_orders: BEGIN
[0m19:51:24.910398 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m19:51:24.910398 [debug] [Thread-1 (]: On model.ecomm.dim_sku: BEGIN
[0m19:51:24.911400 [debug] [Thread-2 (]: On model.ecomm.dim_user: BEGIN
[0m19:51:24.911400 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:51:24.912398 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: BEGIN
[0m19:51:24.912398 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:51:24.913403 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:51:24.914398 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:51:24.914398 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:51:24.914398 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:24.914398 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:51:24.915902 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m19:51:24.915902 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:51:24.916908 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:51:24.916908 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:51:24.917909 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_orders"
  
    as (
      

with src as (
  select
    order_id,
    user_id,
    ts as order_ts,
    date_trunc('day', ts) as order_date,
    total as order_total
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null
)
select * from src
    );
  
  
  
[0m19:51:24.918558 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m19:51:24.918558 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_sku__dbt_tmp"
  
    as (
      
select * from "warehouse"."main"."dim_sku"
    );
  
  
[0m19:51:24.918558 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_user__dbt_tmp"
  
    as (
      
select * from "warehouse"."main"."dim_user"
    );
  
  
[0m19:51:24.919563 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_order_items"
  
    as (
      

with base as (
  select order_id, user_id, ts as order_ts, line_items
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null and line_items is not null
),
items as (
  select
    b.order_id,
    b.user_id,
    b.order_ts,
    li.sku as sku,
    li.qty as qty,
    li.price as price,
    (li.qty * li.price) as line_revenue,
    md5(concat(b.order_id,'|',cast(row_number() over (partition by b.order_id) as varchar))) as order_id_sku_row
  from base b,
  unnest(b.line_items) as t(li)
)
select * from items
    );
  
  
  
[0m19:51:24.920565 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_orders"
  
    as (
      

with src as (
  select
    order_id,
    user_id,
    ts as order_ts,
    date_trunc('day', ts) as order_date,
    total as order_total
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null
)
select * from src
    );
  
  
  
[0m19:51:24.921563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:24.922582 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:51:24.922582 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_order_items"
  
    as (
      

with base as (
  select order_id, user_id, ts as order_ts, line_items
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null and order_id is not null and line_items is not null
),
items as (
  select
    b.order_id,
    b.user_id,
    b.order_ts,
    li.sku as sku,
    li.qty as qty,
    li.price as price,
    (li.qty * li.price) as line_revenue,
    md5(concat(b.order_id,'|',cast(row_number() over (partition by b.order_id) as varchar))) as order_id_sku_row
  from base b,
  unnest(b.line_items) as t(li)
)
select * from items
    );
  
  
  
[0m19:51:24.923564 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:24.927580 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:51:24.930564 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:51:24.930564 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:24.931563 [debug] [Thread-4 (]: On model.ecomm.fct_orders: ROLLBACK
[0m19:51:24.932564 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */
alter table "warehouse"."main_main"."dim_sku" rename to "dim_sku__dbt_backup"
[0m19:51:24.932564 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter table "warehouse"."main_main"."dim_user" rename to "dim_user__dbt_backup"
[0m19:51:24.933564 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m19:51:24.934563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:24.934563 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:51:24.938579 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:51:24.940592 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:51:24.941563 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */
alter table "warehouse"."main_main"."dim_sku__dbt_tmp" rename to "dim_sku"
[0m19:51:24.941563 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter table "warehouse"."main_main"."dim_user__dbt_tmp" rename to "dim_user"
[0m19:51:24.942563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:24.943563 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:51:24.953562 [debug] [Thread-1 (]: On model.ecomm.dim_sku: COMMIT
[0m19:51:24.955565 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m19:51:24.956563 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:51:24.956563 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:51:24.957564 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_orders'
[0m19:51:24.957564 [debug] [Thread-1 (]: On model.ecomm.dim_sku: COMMIT
[0m19:51:24.958566 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m19:51:24.958566 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m19:51:24.959574 [debug] [Thread-4 (]: On model.ecomm.fct_orders: Close
[0m19:51:24.960572 [debug] [Thread-3 (]: On model.ecomm.fct_order_items: Close
[0m19:51:24.963571 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:51:24.964571 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:51:24.968570 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.dim_sku"
[0m19:51:24.970571 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m19:51:24.971571 [debug] [Thread-1 (]: On model.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku"} */

      drop table if exists "warehouse"."main_main"."dim_sku__dbt_backup" cascade
    
[0m19:51:24.971571 [debug] [Thread-4 (]: Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:51:24.972571 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

      drop table if exists "warehouse"."main_main"."dim_user__dbt_backup" cascade
    
[0m19:51:24.972571 [debug] [Thread-3 (]: Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:51:24.974076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:24.975079 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC34C9B70>]}
[0m19:51:24.976080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4FFD090>]}
[0m19:51:24.976080 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:51:24.978081 [debug] [Thread-1 (]: On model.ecomm.dim_sku: Close
[0m19:51:24.978081 [error] [Thread-4 (]: 4 of 7 ERROR creating sql incremental model main_main.fct_orders ............... [[31mERROR[0m in 0.14s]
[0m19:51:24.979089 [error] [Thread-3 (]: 3 of 7 ERROR creating sql incremental model main_main.fct_order_items .......... [[31mERROR[0m in 0.15s]
[0m19:51:24.980081 [debug] [Thread-2 (]: On model.ecomm.dim_user: Close
[0m19:51:24.981083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4C9B220>]}
[0m19:51:24.982082 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_orders
[0m19:51:24.982082 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_order_items
[0m19:51:24.983080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4EDA500>]}
[0m19:51:24.984080 [info ] [Thread-1 (]: 1 of 7 OK created sql table model main_main.dim_sku ............................ [[32mOK[0m in 0.15s]
[0m19:51:24.984080 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_daily
[0m19:51:24.984080 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet".
[0m19:51:24.985080 [debug] [Thread-3 (]: Began running node model.ecomm.fct_sessions
[0m19:51:24.986081 [info ] [Thread-2 (]: 2 of 7 OK created sql table model main_main.dim_user ........................... [[32mOK[0m in 0.16s]
[0m19:51:24.986081 [debug] [Thread-1 (]: Finished running node model.ecomm.dim_sku
[0m19:51:24.987112 [info ] [Thread-4 (]: 5 of 7 START sql incremental model main_main.fct_revenue_daily ................. [RUN]
[0m19:51:24.988081 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet".
[0m19:51:24.989080 [info ] [Thread-3 (]: 6 of 7 START sql table model main_main.fct_sessions ............................ [RUN]
[0m19:51:24.989080 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_user
[0m19:51:24.990083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.fct_revenue_daily)
[0m19:51:24.991109 [debug] [Thread-1 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m19:51:24.992081 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.fct_sessions)
[0m19:51:24.992081 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_revenue_daily
[0m19:51:24.993083 [info ] [Thread-1 (]: 7 of 7 SKIP relation main_main.fct_revenue_by_category_daily ................... [[33mSKIP[0m]
[0m19:51:24.993083 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_sessions
[0m19:51:24.997081 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_revenue_daily"
[0m19:51:24.997081 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m19:51:25.000082 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m19:51:25.001079 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_revenue_daily
[0m19:51:25.005080 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_revenue_daily"
[0m19:51:25.006080 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_sessions
[0m19:51:25.010081 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m19:51:25.011082 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m19:51:25.012082 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: BEGIN
[0m19:51:25.012082 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m19:51:25.012082 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:51:25.013080 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: BEGIN
[0m19:51:25.014080 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:51:25.014080 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:51:25.014080 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m19:51:25.015080 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:51:25.016081 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_revenue_daily"
  
    as (
      

with o as (
  select
    date_trunc('day', ts) as order_date,
    sum(total) as revenue
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null
  group by 1
)
select * from o
    );
  
  
  
[0m19:51:25.016081 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m19:51:25.017081 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_sessions__dbt_tmp"
  
    as (
      

select
  session_id,
  user_id,
  session_start,
  session_end,
  page_count,
  cart_events,
  conversion_flag
from read_parquet('../data/silver/sessions/*.parquet')
    );
  
  
[0m19:51:25.017081 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_revenue_daily"
  
    as (
      

with o as (
  select
    date_trunc('day', ts) as order_date,
    sum(total) as revenue
  from read_parquet('../data/silver/order_placed/*.parquet')
  where ts is not null
  group by 1
)
select * from o
    );
  
  
  
[0m19:51:25.018080 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:25.018080 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
    
    

    create  table
      "warehouse"."main_main"."fct_sessions__dbt_tmp"
  
    as (
      

select
  session_id,
  user_id,
  session_start,
  session_end,
  page_count,
  cart_events,
  conversion_flag
from read_parquet('../data/silver/sessions/*.parquet')
    );
  
  
[0m19:51:25.019081 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: ROLLBACK
[0m19:51:25.019081 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:25.020080 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: ROLLBACK
[0m19:51:25.021080 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_revenue_daily'
[0m19:51:25.022079 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.fct_sessions'
[0m19:51:25.022079 [debug] [Thread-4 (]: On model.ecomm.fct_revenue_daily: Close
[0m19:51:25.023081 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: Close
[0m19:51:25.025080 [debug] [Thread-4 (]: Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:51:25.025080 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC1159B70>]}
[0m19:51:25.026080 [debug] [Thread-3 (]: Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  IO Error: No files found that match the pattern "../data/silver/sessions/*.parquet"
[0m19:51:25.027080 [error] [Thread-4 (]: 5 of 7 ERROR creating sql incremental model main_main.fct_revenue_daily ........ [[31mERROR[0m in 0.03s]
[0m19:51:25.027080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09758fe1-f541-4d9d-8f98-6aa1ceb0e2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC546A0E0>]}
[0m19:51:25.028083 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_daily
[0m19:51:25.028083 [error] [Thread-3 (]: 6 of 7 ERROR creating sql table model main_main.fct_sessions ................... [[31mERROR[0m in 0.04s]
[0m19:51:25.029082 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_revenue_daily' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet".
[0m19:51:25.030081 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_sessions
[0m19:51:25.031081 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  IO Error: No files found that match the pattern "../data/silver/sessions/*.parquet".
[0m19:51:25.032081 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:25.032081 [debug] [MainThread]: On master: BEGIN
[0m19:51:25.033081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:25.033081 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:25.034081 [debug] [MainThread]: On master: COMMIT
[0m19:51:25.034081 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:25.035080 [debug] [MainThread]: On master: COMMIT
[0m19:51:25.035080 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:25.036080 [debug] [MainThread]: On master: Close
[0m19:51:25.036080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:25.036080 [debug] [MainThread]: Connection 'create_warehouse_main_main' was properly closed.
[0m19:51:25.037080 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m19:51:25.037080 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m19:51:25.037080 [debug] [MainThread]: Connection 'model.ecomm.dim_sku' was properly closed.
[0m19:51:25.038080 [debug] [MainThread]: Connection 'model.ecomm.dim_user' was properly closed.
[0m19:51:25.038080 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m19:51:25.038080 [debug] [MainThread]: Connection 'model.ecomm.fct_revenue_daily' was properly closed.
[0m19:51:25.039080 [info ] [MainThread]: 
[0m19:51:25.039080 [info ] [MainThread]: Finished running 4 incremental models, 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m19:51:25.040080 [debug] [MainThread]: Command end result
[0m19:51:25.063088 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:51:25.066089 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:51:25.071105 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\run_results.json
[0m19:51:25.072089 [info ] [MainThread]: 
[0m19:51:25.072089 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m19:51:25.073593 [info ] [MainThread]: 
[0m19:51:25.073593 [error] [MainThread]: [31mFailure in model fct_orders (models\gold\fct_orders.sql)[0m
[0m19:51:25.074598 [error] [MainThread]:   Runtime Error in model fct_orders (models\gold\fct_orders.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:51:25.074598 [info ] [MainThread]: 
[0m19:51:25.075597 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_orders.sql
[0m19:51:25.075597 [info ] [MainThread]: 
[0m19:51:25.076597 [error] [MainThread]: [31mFailure in model fct_order_items (models\gold\fct_order_items.sql)[0m
[0m19:51:25.076597 [error] [MainThread]:   Runtime Error in model fct_order_items (models\gold\fct_order_items.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:51:25.077598 [info ] [MainThread]: 
[0m19:51:25.077598 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_order_items.sql
[0m19:51:25.078598 [info ] [MainThread]: 
[0m19:51:25.079598 [error] [MainThread]: [31mFailure in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)[0m
[0m19:51:25.079598 [error] [MainThread]:   Runtime Error in model fct_revenue_daily (models\gold\fct_revenue_daily.sql)
  IO Error: No files found that match the pattern "../data/silver/order_placed/*.parquet"
[0m19:51:25.080597 [info ] [MainThread]: 
[0m19:51:25.080597 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_revenue_daily.sql
[0m19:51:25.081597 [info ] [MainThread]: 
[0m19:51:25.081597 [error] [MainThread]: [31mFailure in model fct_sessions (models\gold\fct_sessions.sql)[0m
[0m19:51:25.081597 [error] [MainThread]:   Runtime Error in model fct_sessions (models\gold\fct_sessions.sql)
  IO Error: No files found that match the pattern "../data/silver/sessions/*.parquet"
[0m19:51:25.082597 [info ] [MainThread]: 
[0m19:51:25.082597 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\fct_sessions.sql
[0m19:51:25.083597 [info ] [MainThread]: 
[0m19:51:25.083597 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 NO-OP=0 TOTAL=7
[0m19:51:25.084599 [debug] [MainThread]: Command `dbt run` failed at 19:51:25.084599 after 2.13 seconds
[0m19:51:25.085599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC2266080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC3691840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC4E1E560>]}
[0m19:51:25.085599 [debug] [MainThread]: Flushing usage events
[0m19:51:26.270758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:27.949503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951E266050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001952053CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001952053CCA0>]}


============================== 19:51:27.952502 | 09078265-75cb-4a25-bc91-2f9fd2367ef3 ==============================
[0m19:51:27.952502 [info ] [MainThread]: Running with dbt=1.10.8
[0m19:51:27.953501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt\\logs', 'profiles_dir': 'D:\\weekend-de\\e-commerce-clickstream-orders\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:28.122967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09078265-75cb-4a25-bc91-2f9fd2367ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951C848700>]}
[0m19:51:28.166712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09078265-75cb-4a25-bc91-2f9fd2367ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001952036F100>]}
[0m19:51:28.169712 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m19:51:28.384359 [debug] [MainThread]: checksum: 265d66e81f90af29a7a28579c9b54d938c94f4a57c57be5f853267ae509b5fcb, vars: {}, profile: , target: , version: 1.10.8
[0m19:51:28.549148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:28.549148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:28.598640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09078265-75cb-4a25-bc91-2f9fd2367ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019521BA8130>]}
[0m19:51:28.675765 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:51:28.678272 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:51:28.758454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09078265-75cb-4a25-bc91-2f9fd2367ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001952060CE80>]}
[0m19:51:28.759501 [info ] [MainThread]: Found 7 models, 2 seeds, 12 data tests, 4 sources, 429 macros
[0m19:51:28.760027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09078265-75cb-4a25-bc91-2f9fd2367ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001952060CB20>]}
[0m19:51:28.762117 [info ] [MainThread]: 
[0m19:51:28.762638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:28.763673 [info ] [MainThread]: 
[0m19:51:28.764196 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:51:28.773803 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m19:51:28.775093 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m19:51:28.862907 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:51:28.863435 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:51:28.863949 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m19:51:28.864478 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m19:51:28.864478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:28.864992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:28.887256 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:51:28.887799 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:51:28.888873 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m19:51:28.889488 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m19:51:28.889488 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:51:28.890064 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'warehouse'
  
[0m19:51:28.899640 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:51:28.899640 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:51:28.900640 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m19:51:28.901641 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m19:51:28.902670 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m19:51:28.903642 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m19:51:28.903642 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m19:51:28.903642 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m19:51:28.905640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09078265-75cb-4a25-bc91-2f9fd2367ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195205EFA00>]}
[0m19:51:28.905640 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:28.906641 [debug] [MainThread]: On master: BEGIN
[0m19:51:28.906641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:28.907641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:28.907641 [debug] [MainThread]: On master: COMMIT
[0m19:51:28.907641 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:28.907641 [debug] [MainThread]: On master: COMMIT
[0m19:51:28.909145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:28.909685 [debug] [MainThread]: On master: Close
[0m19:51:28.912690 [debug] [Thread-1 (]: Began running node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m19:51:28.912690 [debug] [Thread-2 (]: Began running node test.ecomm.not_null_dim_user_user_id.4b202b08a3
[0m19:51:28.912690 [debug] [Thread-3 (]: Began running node test.ecomm.not_null_fct_order_items_order_id.e887a2de02
[0m19:51:28.914194 [debug] [Thread-4 (]: Began running node test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3
[0m19:51:28.914194 [info ] [Thread-1 (]: 1 of 12 START test not_null_dim_sku_sku ........................................ [RUN]
[0m19:51:28.914194 [info ] [Thread-2 (]: 2 of 12 START test not_null_dim_user_user_id ................................... [RUN]
[0m19:51:28.914194 [info ] [Thread-3 (]: 3 of 12 START test not_null_fct_order_items_order_id ........................... [RUN]
[0m19:51:28.915877 [info ] [Thread-4 (]: 4 of 12 START test not_null_fct_order_items_order_id_sku_row ................... [RUN]
[0m19:51:28.915877 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecomm.not_null_dim_sku_sku.0ac6a5e44c'
[0m19:51:28.916881 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.ecomm.not_null_dim_user_user_id.4b202b08a3'
[0m19:51:28.916881 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.ecomm.not_null_fct_order_items_order_id.e887a2de02'
[0m19:51:28.917881 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3'
[0m19:51:28.918482 [debug] [Thread-1 (]: Began compiling node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m19:51:28.918482 [debug] [Thread-2 (]: Began compiling node test.ecomm.not_null_dim_user_user_id.4b202b08a3
[0m19:51:28.919486 [debug] [Thread-3 (]: Began compiling node test.ecomm.not_null_fct_order_items_order_id.e887a2de02
[0m19:51:28.919486 [debug] [Thread-4 (]: Began compiling node test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3
[0m19:51:28.930862 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m19:51:28.933999 [debug] [Thread-2 (]: Writing injected SQL for node "test.ecomm.not_null_dim_user_user_id.4b202b08a3"
[0m19:51:28.937516 [debug] [Thread-3 (]: Writing injected SQL for node "test.ecomm.not_null_fct_order_items_order_id.e887a2de02"
[0m19:51:28.941533 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3"
[0m19:51:28.942516 [debug] [Thread-2 (]: Began executing node test.ecomm.not_null_dim_user_user_id.4b202b08a3
[0m19:51:28.943515 [debug] [Thread-1 (]: Began executing node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m19:51:28.955129 [debug] [Thread-2 (]: Writing runtime sql for node "test.ecomm.not_null_dim_user_user_id.4b202b08a3"
[0m19:51:28.955129 [debug] [Thread-3 (]: Began executing node test.ecomm.not_null_fct_order_items_order_id.e887a2de02
[0m19:51:28.956130 [debug] [Thread-4 (]: Began executing node test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3
[0m19:51:28.958147 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m19:51:28.960151 [debug] [Thread-3 (]: Writing runtime sql for node "test.ecomm.not_null_fct_order_items_order_id.e887a2de02"
[0m19:51:28.962129 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3"
[0m19:51:28.962129 [debug] [Thread-2 (]: Using duckdb connection "test.ecomm.not_null_dim_user_user_id.4b202b08a3"
[0m19:51:28.963128 [debug] [Thread-1 (]: Using duckdb connection "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m19:51:28.963128 [debug] [Thread-3 (]: Using duckdb connection "test.ecomm.not_null_fct_order_items_order_id.e887a2de02"
[0m19:51:28.964129 [debug] [Thread-2 (]: On test.ecomm.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m19:51:28.964129 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3"
[0m19:51:28.965129 [debug] [Thread-1 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: BEGIN
[0m19:51:28.965129 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m19:51:28.966128 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:51:28.966128 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3: BEGIN
[0m19:51:28.967128 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:51:28.967128 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:51:28.967128 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:51:28.968632 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:51:28.968632 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:28.969637 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:51:28.969637 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:51:28.970637 [debug] [Thread-2 (]: Using duckdb connection "test.ecomm.not_null_dim_user_user_id.4b202b08a3"
[0m19:51:28.970637 [debug] [Thread-1 (]: Using duckdb connection "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m19:51:28.970637 [debug] [Thread-3 (]: Using duckdb connection "test.ecomm.not_null_fct_order_items_order_id.e887a2de02"
[0m19:51:28.970637 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3"
[0m19:51:28.972141 [debug] [Thread-2 (]: On test.ecomm.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "warehouse"."main"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:51:28.972141 [debug] [Thread-1 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from "warehouse"."main"."dim_sku"
where sku is null



  
  
      
    ) dbt_internal_test
[0m19:51:28.973147 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_order_items_order_id.e887a2de02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_main"."fct_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m19:51:28.973147 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id_sku_row
from "warehouse"."main_main"."fct_order_items"
where order_id_sku_row is null



  
  
      
    ) dbt_internal_test
[0m19:51:28.974652 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:51:28.974652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:28.975657 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_order_items_order_id.e887a2de02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "warehouse"."main_main"."fct_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m19:51:28.978169 [debug] [Thread-2 (]: On test.ecomm.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m19:51:28.979168 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id_sku_row
from "warehouse"."main_main"."fct_order_items"
where order_id_sku_row is null



  
  
      
    ) dbt_internal_test
[0m19:51:28.979168 [debug] [Thread-1 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: ROLLBACK
[0m19:51:28.980673 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:28.981315 [debug] [Thread-2 (]: Failed to rollback 'test.ecomm.not_null_dim_user_user_id.4b202b08a3'
[0m19:51:28.981826 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:28.982406 [debug] [Thread-1 (]: Failed to rollback 'test.ecomm.not_null_dim_sku_sku.0ac6a5e44c'
[0m19:51:28.983082 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_order_items_order_id.e887a2de02: ROLLBACK
[0m19:51:28.983082 [debug] [Thread-2 (]: On test.ecomm.not_null_dim_user_user_id.4b202b08a3: Close
[0m19:51:28.983082 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3: ROLLBACK
[0m19:51:28.983082 [debug] [Thread-1 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: Close
[0m19:51:28.984765 [info ] [Thread-2 (]: 2 of 12 PASS not_null_dim_user_user_id ......................................... [[32mPASS[0m in 0.07s]
[0m19:51:28.985772 [info ] [Thread-1 (]: 1 of 12 PASS not_null_dim_sku_sku .............................................. [[32mPASS[0m in 0.07s]
[0m19:51:28.987276 [debug] [Thread-2 (]: Finished running node test.ecomm.not_null_dim_user_user_id.4b202b08a3
[0m19:51:28.987276 [debug] [Thread-1 (]: Finished running node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m19:51:28.988280 [debug] [Thread-2 (]: Began running node test.ecomm.not_null_fct_order_items_sku.62b231ed75
[0m19:51:28.988280 [debug] [Thread-1 (]: Began running node test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330
[0m19:51:28.990129 [info ] [Thread-2 (]: 5 of 12 START test not_null_fct_order_items_sku ................................ [RUN]
[0m19:51:28.990788 [info ] [Thread-1 (]: 6 of 12 START test not_null_fct_revenue_by_category_daily_category ............. [RUN]
[0m19:51:28.991292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_dim_user_user_id.4b202b08a3, now test.ecomm.not_null_fct_order_items_sku.62b231ed75)
[0m19:51:28.991292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_dim_sku_sku.0ac6a5e44c, now test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330)
[0m19:51:28.992803 [debug] [Thread-2 (]: Began compiling node test.ecomm.not_null_fct_order_items_sku.62b231ed75
[0m19:51:28.992803 [debug] [Thread-1 (]: Began compiling node test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330
[0m19:51:28.998406 [debug] [Thread-2 (]: Writing injected SQL for node "test.ecomm.not_null_fct_order_items_sku.62b231ed75"
[0m19:51:29.002407 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330"
[0m19:51:29.002407 [debug] [Thread-3 (]: Failed to rollback 'test.ecomm.not_null_fct_order_items_order_id.e887a2de02'
[0m19:51:29.004084 [debug] [Thread-4 (]: Failed to rollback 'test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3'
[0m19:51:29.005101 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_order_items_order_id.e887a2de02: Close
[0m19:51:29.005605 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3: Close
[0m19:51:29.006609 [debug] [Thread-2 (]: Began executing node test.ecomm.not_null_fct_order_items_sku.62b231ed75
[0m19:51:29.006609 [debug] [Thread-1 (]: Began executing node test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330
[0m19:51:29.008610 [debug] [Thread-2 (]: Writing runtime sql for node "test.ecomm.not_null_fct_order_items_sku.62b231ed75"
[0m19:51:29.010645 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330"
[0m19:51:29.012769 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_order_items_order_id (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.013291 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_order_items_order_id_sku_row (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.014294 [error] [Thread-3 (]: 3 of 12 ERROR not_null_fct_order_items_order_id ................................ [[31mERROR[0m in 0.10s]
[0m19:51:29.014294 [debug] [Thread-2 (]: Using duckdb connection "test.ecomm.not_null_fct_order_items_sku.62b231ed75"
[0m19:51:29.014294 [debug] [Thread-1 (]: Using duckdb connection "test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330"
[0m19:51:29.014294 [error] [Thread-4 (]: 4 of 12 ERROR not_null_fct_order_items_order_id_sku_row ........................ [[31mERROR[0m in 0.10s]
[0m19:51:29.015797 [debug] [Thread-3 (]: Finished running node test.ecomm.not_null_fct_order_items_order_id.e887a2de02
[0m19:51:29.016502 [debug] [Thread-2 (]: On test.ecomm.not_null_fct_order_items_sku.62b231ed75: BEGIN
[0m19:51:29.016502 [debug] [Thread-1 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330: BEGIN
[0m19:51:29.017506 [debug] [Thread-4 (]: Finished running node test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3
[0m19:51:29.017506 [debug] [Thread-3 (]: Began running node test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b
[0m19:51:29.018507 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.not_null_fct_order_items_order_id.e887a2de02' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_order_items_order_id (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^.
[0m19:51:29.019506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:51:29.019506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:29.020507 [debug] [Thread-4 (]: Began running node test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb
[0m19:51:29.020507 [info ] [Thread-3 (]: 7 of 12 START test not_null_fct_revenue_by_category_daily_order_date ........... [RUN]
[0m19:51:29.021507 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_order_items_order_id_sku_row (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^.
[0m19:51:29.022509 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:51:29.023553 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:51:29.023553 [info ] [Thread-4 (]: 8 of 12 START test not_null_fct_revenue_by_category_daily_order_date_category .. [RUN]
[0m19:51:29.024552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_fct_order_items_order_id.e887a2de02, now test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b)
[0m19:51:29.024552 [debug] [Thread-2 (]: Using duckdb connection "test.ecomm.not_null_fct_order_items_sku.62b231ed75"
[0m19:51:29.025553 [debug] [Thread-1 (]: Using duckdb connection "test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330"
[0m19:51:29.026553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_fct_order_items_order_id_sku_row.ae431617c3, now test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb)
[0m19:51:29.026553 [debug] [Thread-3 (]: Began compiling node test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b
[0m19:51:29.027876 [debug] [Thread-2 (]: On test.ecomm.not_null_fct_order_items_sku.62b231ed75: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_order_items_sku.62b231ed75"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from "warehouse"."main_main"."fct_order_items"
where sku is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.027876 [debug] [Thread-1 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category
from "warehouse"."main_main"."fct_revenue_by_category_daily"
where category is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.028539 [debug] [Thread-4 (]: Began compiling node test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb
[0m19:51:29.032546 [debug] [Thread-3 (]: Writing injected SQL for node "test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b"
[0m19:51:29.033050 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_order_items_sku.62b231ed75"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from "warehouse"."main_main"."fct_order_items"
where sku is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.036561 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb"
[0m19:51:29.037567 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category
from "warehouse"."main_main"."fct_revenue_by_category_daily"
where category is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.037567 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:29.038566 [debug] [Thread-3 (]: Began executing node test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b
[0m19:51:29.038566 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:29.039567 [debug] [Thread-4 (]: Began executing node test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb
[0m19:51:29.039567 [debug] [Thread-2 (]: On test.ecomm.not_null_fct_order_items_sku.62b231ed75: ROLLBACK
[0m19:51:29.041445 [debug] [Thread-3 (]: Writing runtime sql for node "test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b"
[0m19:51:29.042949 [debug] [Thread-1 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330: ROLLBACK
[0m19:51:29.045601 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb"
[0m19:51:29.045601 [debug] [Thread-3 (]: Using duckdb connection "test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b"
[0m19:51:29.047106 [debug] [Thread-2 (]: Failed to rollback 'test.ecomm.not_null_fct_order_items_sku.62b231ed75'
[0m19:51:29.048111 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b: BEGIN
[0m19:51:29.048111 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb"
[0m19:51:29.049111 [debug] [Thread-2 (]: On test.ecomm.not_null_fct_order_items_sku.62b231ed75: Close
[0m19:51:29.049111 [debug] [Thread-1 (]: Failed to rollback 'test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330'
[0m19:51:29.049111 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:51:29.050111 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb: BEGIN
[0m19:51:29.051111 [debug] [Thread-1 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330: Close
[0m19:51:29.051111 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:51:29.052111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:51:29.053112 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_order_items_sku (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.053112 [debug] [Thread-3 (]: Using duckdb connection "test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b"
[0m19:51:29.054157 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:51:29.054157 [error] [Thread-2 (]: 5 of 12 ERROR not_null_fct_order_items_sku ..................................... [[31mERROR[0m in 0.06s]
[0m19:51:29.055157 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "warehouse"."main_main"."fct_revenue_by_category_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.055157 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_revenue_by_category_daily_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.056157 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb"
[0m19:51:29.056157 [debug] [Thread-2 (]: Finished running node test.ecomm.not_null_fct_order_items_sku.62b231ed75
[0m19:51:29.057159 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "warehouse"."main_main"."fct_revenue_by_category_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.057159 [error] [Thread-1 (]: 6 of 12 ERROR not_null_fct_revenue_by_category_daily_category .................. [[31mERROR[0m in 0.07s]
[0m19:51:29.058248 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date_category
from "warehouse"."main_main"."fct_revenue_by_category_daily"
where order_date_category is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.058974 [debug] [Thread-2 (]: Began running node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m19:51:29.058974 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.not_null_fct_order_items_sku.62b231ed75' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_order_items_sku (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^.
[0m19:51:29.059980 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:29.059980 [debug] [Thread-1 (]: Finished running node test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330
[0m19:51:29.061133 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date_category
from "warehouse"."main_main"."fct_revenue_by_category_daily"
where order_date_category is null



  
  
      
    ) dbt_internal_test
[0m19:51:29.061133 [info ] [Thread-2 (]: 9 of 12 START test unique_dim_sku_sku .......................................... [RUN]
[0m19:51:29.062148 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b: ROLLBACK
[0m19:51:29.063148 [debug] [Thread-1 (]: Began running node test.ecomm.unique_dim_user_user_id.eff0a2a278
[0m19:51:29.063148 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_revenue_by_category_daily_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^.
[0m19:51:29.063148 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:29.064169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_fct_order_items_sku.62b231ed75, now test.ecomm.unique_dim_sku_sku.5799afeb02)
[0m19:51:29.065170 [info ] [Thread-1 (]: 10 of 12 START test unique_dim_user_user_id .................................... [RUN]
[0m19:51:29.066170 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb: ROLLBACK
[0m19:51:29.066170 [debug] [Thread-2 (]: Began compiling node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m19:51:29.066170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_fct_revenue_by_category_daily_category.4bf2cf8330, now test.ecomm.unique_dim_user_user_id.eff0a2a278)
[0m19:51:29.067674 [debug] [Thread-3 (]: Failed to rollback 'test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b'
[0m19:51:29.072680 [debug] [Thread-2 (]: Writing injected SQL for node "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m19:51:29.073681 [debug] [Thread-1 (]: Began compiling node test.ecomm.unique_dim_user_user_id.eff0a2a278
[0m19:51:29.074360 [debug] [Thread-3 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b: Close
[0m19:51:29.075365 [debug] [Thread-4 (]: Failed to rollback 'test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb'
[0m19:51:29.077870 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecomm.unique_dim_user_user_id.eff0a2a278"
[0m19:51:29.078876 [debug] [Thread-2 (]: Began executing node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m19:51:29.078876 [debug] [Thread-4 (]: On test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb: Close
[0m19:51:29.081875 [debug] [Thread-2 (]: Writing runtime sql for node "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m19:51:29.082876 [debug] [Thread-1 (]: Began executing node test.ecomm.unique_dim_user_user_id.eff0a2a278
[0m19:51:29.083875 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_revenue_by_category_daily_order_date (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.085876 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecomm.unique_dim_user_user_id.eff0a2a278"
[0m19:51:29.086876 [debug] [Thread-2 (]: Using duckdb connection "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m19:51:29.086876 [error] [Thread-3 (]: 7 of 12 ERROR not_null_fct_revenue_by_category_daily_order_date ................ [[31mERROR[0m in 0.06s]
[0m19:51:29.088380 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.089058 [debug] [Thread-2 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: BEGIN
[0m19:51:29.089058 [debug] [Thread-1 (]: Using duckdb connection "test.ecomm.unique_dim_user_user_id.eff0a2a278"
[0m19:51:29.090063 [debug] [Thread-3 (]: Finished running node test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b
[0m19:51:29.090063 [error] [Thread-4 (]: 8 of 12 ERROR not_null_fct_revenue_by_category_daily_order_date_category ....... [[31mERROR[0m in 0.06s]
[0m19:51:29.091063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:51:29.091063 [debug] [Thread-1 (]: On test.ecomm.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m19:51:29.092063 [debug] [Thread-3 (]: Began running node test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165
[0m19:51:29.092063 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_revenue_by_category_daily_order_date (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^.
[0m19:51:29.093063 [debug] [Thread-4 (]: Finished running node test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb
[0m19:51:29.093063 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:51:29.094063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:29.094063 [info ] [Thread-3 (]: 11 of 12 START test unique_fct_order_items_order_id_sku_row .................... [RUN]
[0m19:51:29.095063 [debug] [Thread-4 (]: Began running node test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb
[0m19:51:29.095063 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^.
[0m19:51:29.096063 [debug] [Thread-2 (]: Using duckdb connection "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m19:51:29.096063 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:51:29.097063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_fct_revenue_by_category_daily_order_date.f9c28cbb4b, now test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165)
[0m19:51:29.097063 [info ] [Thread-4 (]: 12 of 12 START test unique_fct_revenue_by_category_daily_order_date_category ... [RUN]
[0m19:51:29.098063 [debug] [Thread-2 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.unique_dim_sku_sku.5799afeb02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sku as unique_field,
    count(*) as n_records

from "warehouse"."main"."dim_sku"
where sku is not null
group by sku
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:29.098063 [debug] [Thread-1 (]: Using duckdb connection "test.ecomm.unique_dim_user_user_id.eff0a2a278"
[0m19:51:29.099063 [debug] [Thread-3 (]: Began compiling node test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165
[0m19:51:29.100068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_fct_revenue_by_category_daily_order_date_category.ac274006bb, now test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb)
[0m19:51:29.100068 [debug] [Thread-1 (]: On test.ecomm.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "warehouse"."main"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:29.105068 [debug] [Thread-3 (]: Writing injected SQL for node "test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165"
[0m19:51:29.105068 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m19:51:29.106069 [debug] [Thread-4 (]: Began compiling node test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb
[0m19:51:29.108067 [debug] [Thread-2 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: ROLLBACK
[0m19:51:29.109069 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:51:29.109069 [debug] [Thread-3 (]: Began executing node test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165
[0m19:51:29.112068 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb"
[0m19:51:29.113069 [debug] [Thread-2 (]: Failed to rollback 'test.ecomm.unique_dim_sku_sku.5799afeb02'
[0m19:51:29.114574 [debug] [Thread-1 (]: On test.ecomm.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m19:51:29.117195 [debug] [Thread-3 (]: Writing runtime sql for node "test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165"
[0m19:51:29.118195 [debug] [Thread-2 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: Close
[0m19:51:29.118195 [debug] [Thread-4 (]: Began executing node test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb
[0m19:51:29.118195 [debug] [Thread-1 (]: Failed to rollback 'test.ecomm.unique_dim_user_user_id.eff0a2a278'
[0m19:51:29.119196 [info ] [Thread-2 (]: 9 of 12 PASS unique_dim_sku_sku ................................................ [[32mPASS[0m in 0.06s]
[0m19:51:29.120194 [debug] [Thread-3 (]: Using duckdb connection "test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165"
[0m19:51:29.121815 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb"
[0m19:51:29.121815 [debug] [Thread-1 (]: On test.ecomm.unique_dim_user_user_id.eff0a2a278: Close
[0m19:51:29.122797 [debug] [Thread-2 (]: Finished running node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m19:51:29.123798 [debug] [Thread-3 (]: On test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165: BEGIN
[0m19:51:29.123798 [info ] [Thread-1 (]: 10 of 12 PASS unique_dim_user_user_id .......................................... [[32mPASS[0m in 0.06s]
[0m19:51:29.124874 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb"
[0m19:51:29.124874 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:51:29.125873 [debug] [Thread-1 (]: Finished running node test.ecomm.unique_dim_user_user_id.eff0a2a278
[0m19:51:29.125873 [debug] [Thread-4 (]: On test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb: BEGIN
[0m19:51:29.126873 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:51:29.127873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:51:29.127873 [debug] [Thread-3 (]: Using duckdb connection "test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165"
[0m19:51:29.128873 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:51:29.128873 [debug] [Thread-3 (]: On test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id_sku_row as unique_field,
    count(*) as n_records

from "warehouse"."main_main"."fct_order_items"
where order_id_sku_row is not null
group by order_id_sku_row
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:29.129873 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb"
[0m19:51:29.130873 [debug] [Thread-4 (]: On test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_date_category as unique_field,
    count(*) as n_records

from "warehouse"."main_main"."fct_revenue_by_category_daily"
where order_date_category is not null
group by order_date_category
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:29.130873 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id_sku_row as unique_field,
    count(*) as n_records

from "warehouse"."main_main"."fct_order_items"
where order_id_sku_row is not null
group by order_id_sku_row
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:29.131873 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:29.131873 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.8", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_date_category as unique_field,
    count(*) as n_records

from "warehouse"."main_main"."fct_revenue_by_category_daily"
where order_date_category is not null
group by order_date_category
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:51:29.131873 [debug] [Thread-3 (]: On test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165: ROLLBACK
[0m19:51:29.132874 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m19:51:29.133872 [debug] [Thread-4 (]: On test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb: ROLLBACK
[0m19:51:29.134873 [debug] [Thread-3 (]: Failed to rollback 'test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165'
[0m19:51:29.134873 [debug] [Thread-3 (]: On test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165: Close
[0m19:51:29.136518 [debug] [Thread-4 (]: Failed to rollback 'test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb'
[0m19:51:29.136518 [debug] [Thread-4 (]: On test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb: Close
[0m19:51:29.137524 [debug] [Thread-3 (]: Runtime Error in test unique_fct_order_items_order_id_sku_row (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 18: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.138524 [error] [Thread-3 (]: 11 of 12 ERROR unique_fct_order_items_order_id_sku_row ......................... [[31mERROR[0m in 0.04s]
[0m19:51:29.138524 [debug] [Thread-4 (]: Runtime Error in test unique_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 18: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.139523 [debug] [Thread-3 (]: Finished running node test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165
[0m19:51:29.139523 [error] [Thread-4 (]: 12 of 12 ERROR unique_fct_revenue_by_category_daily_order_date_category ........ [[31mERROR[0m in 0.04s]
[0m19:51:29.140523 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_fct_order_items_order_id_sku_row (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 18: from "warehouse"."main_main"."fct_order_items"
                ^.
[0m19:51:29.141524 [debug] [Thread-4 (]: Finished running node test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb
[0m19:51:29.141524 [debug] [Thread-7 (]: Marking all children of 'test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 18: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^.
[0m19:51:29.143524 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:29.143524 [debug] [MainThread]: On master: BEGIN
[0m19:51:29.143524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:29.144524 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:51:29.144524 [debug] [MainThread]: On master: COMMIT
[0m19:51:29.145523 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:29.145523 [debug] [MainThread]: On master: COMMIT
[0m19:51:29.146522 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:29.146522 [debug] [MainThread]: On master: Close
[0m19:51:29.147524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:29.147524 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m19:51:29.147524 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m19:51:29.148524 [debug] [MainThread]: Connection 'test.ecomm.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m19:51:29.148524 [debug] [MainThread]: Connection 'test.ecomm.unique_dim_sku_sku.5799afeb02' was properly closed.
[0m19:51:29.148524 [debug] [MainThread]: Connection 'test.ecomm.unique_fct_order_items_order_id_sku_row.f05e05f165' was properly closed.
[0m19:51:29.149522 [debug] [MainThread]: Connection 'test.ecomm.unique_fct_revenue_by_category_daily_order_date_category.5a29592deb' was properly closed.
[0m19:51:29.149522 [info ] [MainThread]: 
[0m19:51:29.150523 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m19:51:29.151545 [debug] [MainThread]: Command end result
[0m19:51:29.168558 [debug] [MainThread]: Wrote artifact WritableManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\manifest.json
[0m19:51:29.170773 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\semantic_manifest.json
[0m19:51:29.175745 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\weekend-de\e-commerce-clickstream-orders\dbt\target\run_results.json
[0m19:51:29.177251 [info ] [MainThread]: 
[0m19:51:29.177251 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m19:51:29.178256 [info ] [MainThread]: 
[0m19:51:29.179256 [error] [MainThread]: [31mFailure in test not_null_fct_order_items_order_id (models\gold\schema.yml)[0m
[0m19:51:29.179256 [error] [MainThread]:   Runtime Error in test not_null_fct_order_items_order_id (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.180255 [info ] [MainThread]: 
[0m19:51:29.180255 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\not_null_fct_order_items_order_id.sql
[0m19:51:29.181255 [info ] [MainThread]: 
[0m19:51:29.181255 [error] [MainThread]: [31mFailure in test not_null_fct_order_items_order_id_sku_row (models\gold\schema.yml)[0m
[0m19:51:29.182255 [error] [MainThread]:   Runtime Error in test not_null_fct_order_items_order_id_sku_row (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.182255 [info ] [MainThread]: 
[0m19:51:29.183255 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\not_null_fct_order_items_order_id_sku_row.sql
[0m19:51:29.183255 [info ] [MainThread]: 
[0m19:51:29.184261 [error] [MainThread]: [31mFailure in test not_null_fct_order_items_sku (models\gold\schema.yml)[0m
[0m19:51:29.185257 [error] [MainThread]:   Runtime Error in test not_null_fct_order_items_sku (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 17: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.185257 [info ] [MainThread]: 
[0m19:51:29.186256 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\not_null_fct_order_items_sku.sql
[0m19:51:29.186256 [info ] [MainThread]: 
[0m19:51:29.187255 [error] [MainThread]: [31mFailure in test not_null_fct_revenue_by_category_daily_category (models\gold\schema.yml)[0m
[0m19:51:29.187255 [error] [MainThread]:   Runtime Error in test not_null_fct_revenue_by_category_daily_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.188255 [info ] [MainThread]: 
[0m19:51:29.188255 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\not_null_fct_revenue_by_category_daily_category.sql
[0m19:51:29.189256 [info ] [MainThread]: 
[0m19:51:29.189256 [error] [MainThread]: [31mFailure in test not_null_fct_revenue_by_category_daily_order_date (models\gold\schema.yml)[0m
[0m19:51:29.190255 [error] [MainThread]:   Runtime Error in test not_null_fct_revenue_by_category_daily_order_date (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.190255 [info ] [MainThread]: 
[0m19:51:29.191255 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\not_null_fct_revenue_by_category_daily_order_date.sql
[0m19:51:29.191255 [info ] [MainThread]: 
[0m19:51:29.192256 [error] [MainThread]: [31mFailure in test not_null_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)[0m
[0m19:51:29.193256 [error] [MainThread]:   Runtime Error in test not_null_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 17: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.193256 [info ] [MainThread]: 
[0m19:51:29.194256 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\not_null_fct_revenue_by_category_daily_order_date_category.sql
[0m19:51:29.194256 [info ] [MainThread]: 
[0m19:51:29.195256 [error] [MainThread]: [31mFailure in test unique_fct_order_items_order_id_sku_row (models\gold\schema.yml)[0m
[0m19:51:29.195256 [error] [MainThread]:   Runtime Error in test unique_fct_order_items_order_id_sku_row (models\gold\schema.yml)
  Catalog Error: Table with name fct_order_items does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 18: from "warehouse"."main_main"."fct_order_items"
                ^
[0m19:51:29.196257 [info ] [MainThread]: 
[0m19:51:29.197259 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\unique_fct_order_items_order_id_sku_row.sql
[0m19:51:29.197259 [info ] [MainThread]: 
[0m19:51:29.198255 [error] [MainThread]: [31mFailure in test unique_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)[0m
[0m19:51:29.199255 [error] [MainThread]:   Runtime Error in test unique_fct_revenue_by_category_daily_order_date_category (models\gold\schema.yml)
  Catalog Error: Table with name fct_revenue_by_category_daily does not exist!
  Did you mean "dim_user"?
  
  LINE 18: from "warehouse"."main_main"."fct_revenue_by_category_daily"
                ^
[0m19:51:29.199255 [info ] [MainThread]: 
[0m19:51:29.200255 [info ] [MainThread]:   compiled code at target\compiled\ecomm\models\gold\schema.yml\unique_fct_revenue_by_category_daily_order_date_category.sql
[0m19:51:29.200255 [info ] [MainThread]: 
[0m19:51:29.201290 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=8 SKIP=0 NO-OP=0 TOTAL=12
[0m19:51:29.202256 [debug] [MainThread]: Command `dbt test` failed at 19:51:29.202256 after 1.31 seconds
[0m19:51:29.203256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951E266050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019521AB2860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001951F56E350>]}
[0m19:51:29.203256 [debug] [MainThread]: Flushing usage events
[0m19:51:30.085590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:56.002415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dad793b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dad9d5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dadaafb10>]}


============================== 09:35:56.010596 | 36f901f7-46e1-4529-adb1-7aa780a08677 ==============================
[0m09:35:56.010596 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:35:56.012662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'static_parser': 'True', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt debug', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'log_path': '/usr/app/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None'}
[0m09:35:56.039823 [info ] [MainThread]: dbt version: 1.10.9
[0m09:35:56.041574 [info ] [MainThread]: python version: 3.11.13
[0m09:35:56.043079 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:35:56.044238 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:35:56.062936 [info ] [MainThread]: Using profiles dir at /usr/app
[0m09:35:56.064405 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m09:35:56.065665 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:35:56.144783 [info ] [MainThread]: Configuration:
[0m09:35:56.146667 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m09:35:56.148153 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:35:56.149536 [info ] [MainThread]: Required dependencies:
[0m09:35:56.151241 [debug] [MainThread]: Executing "git --help"
[0m09:35:56.153925 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m09:35:56.155512 [info ] [MainThread]: Connection test skipped since no profile was found
[0m09:35:56.157366 [info ] [MainThread]: [31m2 checks failed:[0m
[0m09:35:56.159021 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'ecomm'


[0m09:35:56.160508 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m09:35:56.162858 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.24557556, "process_in_blocks": "0", "process_kernel_time": 0.216854, "process_mem_max_rss": "107096", "process_out_blocks": "2088", "process_user_time": 1.257754}
[0m09:35:56.164680 [debug] [MainThread]: Command `dbt debug` failed at 09:35:56.164543 after 0.25 seconds
[0m09:35:56.166195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db21a5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dad721f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dad793dd0>]}
[0m09:35:56.167875 [debug] [MainThread]: Flushing usage events
[0m09:35:57.119778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:58.630376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6eb0f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6eb02410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6eb0e850>]}


============================== 09:35:58.633712 | 91caf60b-5f3d-41f9-afc9-fff6c5d17fa8 ==============================
[0m09:35:58.633712 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:35:58.635123 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/app', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'log_path': '/usr/app/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True'}
[0m09:35:58.647064 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecomm'
[0m09:35:58.649216 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.0848314, "process_in_blocks": "0", "process_kernel_time": 0.06254, "process_mem_max_rss": "103572", "process_out_blocks": "0", "process_user_time": 1.011069}
[0m09:35:58.651430 [debug] [MainThread]: Command `dbt build` failed at 09:35:58.651310 after 0.09 seconds
[0m09:35:58.652846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6eb66190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6eb66110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd73398410>]}
[0m09:35:58.654398 [debug] [MainThread]: Flushing usage events
[0m09:35:59.583710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:26.914839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241ca4d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241caaab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241caa9a90>]}


============================== 09:38:26.917796 | 439aed91-d419-4000-a309-58baa722a57f ==============================
[0m09:38:26.917796 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:38:26.919433 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug -t dev', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '/usr/app', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'None'}
[0m09:38:26.927441 [info ] [MainThread]: dbt version: 1.10.9
[0m09:38:26.928540 [info ] [MainThread]: python version: 3.11.13
[0m09:38:26.929708 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:38:26.930704 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:38:27.003702 [info ] [MainThread]: Using profiles dir at /usr/app
[0m09:38:27.005309 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m09:38:27.006514 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:38:27.007888 [info ] [MainThread]: adapter type: duckdb
[0m09:38:27.008942 [info ] [MainThread]: adapter version: 1.8.2
[0m09:38:27.085229 [info ] [MainThread]: Configuration:
[0m09:38:27.087266 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:38:27.088559 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:38:27.089935 [info ] [MainThread]: Required dependencies:
[0m09:38:27.091158 [debug] [MainThread]: Executing "git --help"
[0m09:38:27.092930 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m09:38:27.094150 [info ] [MainThread]: Connection:
[0m09:38:27.095227 [info ] [MainThread]:   database: warehouse
[0m09:38:27.096253 [info ] [MainThread]:   schema: main
[0m09:38:27.097165 [info ] [MainThread]:   path: /usr/app/warehouse.duckdb
[0m09:38:27.098357 [info ] [MainThread]:   config_options: None
[0m09:38:27.099542 [info ] [MainThread]:   extensions: ['httpfs']
[0m09:38:27.100954 [info ] [MainThread]:   settings: {}
[0m09:38:27.102166 [info ] [MainThread]:   external_root: .
[0m09:38:27.103442 [info ] [MainThread]:   use_credential_provider: None
[0m09:38:27.104631 [info ] [MainThread]:   attach: None
[0m09:38:27.105864 [info ] [MainThread]:   filesystems: None
[0m09:38:27.106889 [info ] [MainThread]:   remote: None
[0m09:38:27.108227 [info ] [MainThread]:   plugins: None
[0m09:38:27.109489 [info ] [MainThread]:   disable_transactions: False
[0m09:38:27.110959 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:38:27.151791 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:38:27.194532 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:38:27.196118 [debug] [MainThread]: On debug: select 1 as id
[0m09:38:27.197279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:32.370217 [debug] [MainThread]: SQL status: OK in 5.173 seconds
[0m09:38:32.372731 [debug] [MainThread]: On debug: Close
[0m09:38:32.377046 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:38:32.378564 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:38:32.379935 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m09:38:32.381508 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 5.522082, "process_in_blocks": "0", "process_kernel_time": 0.512206, "process_mem_max_rss": "279384", "process_out_blocks": "88784", "process_user_time": 6.740642}
[0m09:38:32.382716 [debug] [MainThread]: Command `dbt debug` failed at 09:38:32.382631 after 5.52 seconds
[0m09:38:32.383975 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:38:32.385021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241cd10910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241ca56950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241c989950>]}
[0m09:38:32.386171 [debug] [MainThread]: Flushing usage events
[0m09:38:33.393924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:39:22.788584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd1aee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd1afe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd1aea90>]}


============================== 09:39:22.793475 | bc69bd16-ea52-4da5-91ec-c861da75ce65 ==============================
[0m09:39:22.793475 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:39:22.795057 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/usr/app/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/usr/app', 'partial_parse': 'True'}
[0m09:39:22.804911 [info ] [MainThread]: dbt version: 1.10.9
[0m09:39:22.806301 [info ] [MainThread]: python version: 3.11.13
[0m09:39:22.807379 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:39:22.808059 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:39:22.878197 [info ] [MainThread]: Using profiles dir at /usr/app
[0m09:39:22.879771 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m09:39:22.881115 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:39:22.882428 [info ] [MainThread]: adapter type: duckdb
[0m09:39:22.883392 [info ] [MainThread]: adapter version: 1.8.2
[0m09:39:22.957597 [info ] [MainThread]: Configuration:
[0m09:39:22.959190 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:39:22.960334 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:39:22.961319 [info ] [MainThread]: Required dependencies:
[0m09:39:22.962369 [debug] [MainThread]: Executing "git --help"
[0m09:39:22.964008 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m09:39:22.965640 [info ] [MainThread]: Connection:
[0m09:39:22.966532 [info ] [MainThread]:   database: warehouse
[0m09:39:22.967715 [info ] [MainThread]:   schema: main
[0m09:39:22.968533 [info ] [MainThread]:   path: /usr/app/warehouse.duckdb
[0m09:39:22.970023 [info ] [MainThread]:   config_options: None
[0m09:39:22.971459 [info ] [MainThread]:   extensions: ['httpfs']
[0m09:39:22.972502 [info ] [MainThread]:   settings: {}
[0m09:39:22.973855 [info ] [MainThread]:   external_root: .
[0m09:39:22.975362 [info ] [MainThread]:   use_credential_provider: None
[0m09:39:22.976471 [info ] [MainThread]:   attach: None
[0m09:39:22.977705 [info ] [MainThread]:   filesystems: None
[0m09:39:22.978915 [info ] [MainThread]:   remote: None
[0m09:39:22.979857 [info ] [MainThread]:   plugins: None
[0m09:39:22.980985 [info ] [MainThread]:   disable_transactions: False
[0m09:39:22.982463 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:39:23.022424 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:39:23.052274 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:39:23.053529 [debug] [MainThread]: On debug: select 1 as id
[0m09:39:23.054354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:39:24.473337 [debug] [MainThread]: SQL status: OK in 1.419 seconds
[0m09:39:24.475923 [debug] [MainThread]: On debug: Close
[0m09:39:24.479781 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:39:24.481211 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:39:24.482469 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m09:39:24.484157 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.742213, "process_in_blocks": "0", "process_kernel_time": 0.547834, "process_mem_max_rss": "281692", "process_out_blocks": "90872", "process_user_time": 2.729026}
[0m09:39:24.485468 [debug] [MainThread]: Command `dbt debug` failed at 09:39:24.485370 after 1.74 seconds
[0m09:39:24.486757 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:39:24.487917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd1a6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fd2ad190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28f91e6b10>]}
[0m09:39:24.489288 [debug] [MainThread]: Flushing usage events
[0m09:39:25.388427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:39:32.216791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf43c7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4422f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf52f7f90>]}


============================== 09:39:32.220306 | baae91f3-19e0-49c8-b17f-432ea12cdce4 ==============================
[0m09:39:32.220306 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:39:32.221825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/usr/app', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/usr/app/logs', 'empty': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_colors': 'True'}
[0m09:39:32.388863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baae91f3-19e0-49c8-b17f-432ea12cdce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4293710>]}
[0m09:39:32.434674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baae91f3-19e0-49c8-b17f-432ea12cdce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf6ff1050>]}
[0m09:39:32.437075 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:39:32.483316 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:39:32.602471 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m09:39:32.603899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'baae91f3-19e0-49c8-b17f-432ea12cdce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf53b0950>]}
[0m09:39:33.702620 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_user' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_user` specification under
the seeds key instead.
[0m09:39:33.704636 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_sku' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_sku` specification under
the seeds key instead.
[0m09:39:33.847760 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named fct_order_items. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for fct_order_items in one of these files:
   - models/gold/schema.yml
  models/sources.yml
[0m09:39:33.849956 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.6932222, "process_in_blocks": "0", "process_kernel_time": 0.221082, "process_mem_max_rss": "138644", "process_out_blocks": "0", "process_user_time": 2.179238}
[0m09:39:33.851333 [debug] [MainThread]: Command `dbt build` failed at 09:39:33.851204 after 1.69 seconds
[0m09:39:33.852613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4422dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4508590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaeffa2f50>]}
[0m09:39:33.854069 [debug] [MainThread]: Flushing usage events
[0m09:39:34.904159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:00.093848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdc2d62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdc2d6010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdc33e710>]}


============================== 09:44:00.096938 | adaf90b2-808c-4749-a099-dd69a0df40c7 ==============================
[0m09:44:00.096938 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:44:00.098534 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'target_path': 'None', 'profiles_dir': '/usr/app', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt ls --resource-type model --output name', 'printer_width': '80', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None'}
[0m09:44:00.241418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adaf90b2-808c-4749-a099-dd69a0df40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdea41dd0>]}
[0m09:44:00.287020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adaf90b2-808c-4749-a099-dd69a0df40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdeefbc10>]}
[0m09:44:00.289474 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:44:00.336518 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:44:00.440296 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m09:44:00.441532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adaf90b2-808c-4749-a099-dd69a0df40c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdcc34910>]}
[0m09:44:01.389631 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_user' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_user` specification under
the seeds key instead.
[0m09:44:01.391700 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_sku' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_sku` specification under
the seeds key instead.
[0m09:44:01.518170 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named fct_order_items. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for fct_order_items in one of these files:
   - models/gold/schema.yml
  models/sources.yml
[0m09:44:01.520399 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 1.4783018, "process_in_blocks": "0", "process_kernel_time": 0.163891, "process_mem_max_rss": "140500", "process_out_blocks": "0", "process_user_time": 2.130594}
[0m09:44:01.521515 [debug] [MainThread]: Command `dbt ls` failed at 09:44:01.521377 after 1.48 seconds
[0m09:44:01.522369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdc34f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd5dd1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdc34d290>]}
[0m09:44:01.523270 [debug] [MainThread]: Flushing usage events
[0m09:44:03.618533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:13.252831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a0671e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a0665f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a082c910>]}


============================== 09:49:13.259388 | 0d550b99-dc1c-4e7c-904e-b1afeee4e205 ==============================
[0m09:49:13.259388 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:49:13.262308 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'profiles_dir': '/usr/app', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/usr/app/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt build'}
[0m09:49:13.516739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d550b99-dc1c-4e7c-904e-b1afeee4e205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a0548cd0>]}
[0m09:49:13.562301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d550b99-dc1c-4e7c-904e-b1afeee4e205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a3298650>]}
[0m09:49:13.565584 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:49:13.621881 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:49:13.724835 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m09:49:13.726579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d550b99-dc1c-4e7c-904e-b1afeee4e205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a1654890>]}
[0m09:49:16.096821 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_user' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_user` specification under
the seeds key instead.
[0m09:49:16.099685 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_sku' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_sku` specification under
the seeds key instead.
[0m09:49:16.235017 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named fct_order_items. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for fct_order_items in one of these files:
   - models/gold/schema.yml
  models/sources.yml
[0m09:49:16.238187 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8165622, "process_in_blocks": "127448", "process_kernel_time": 0.112777, "process_mem_max_rss": "139644", "process_out_blocks": "0", "process_user_time": 2.409329}
[0m09:49:16.240009 [debug] [MainThread]: Command `dbt build` failed at 09:49:16.239914 after 1.82 seconds
[0m09:49:16.241889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a06db650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a06db8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a4f01150>]}
[0m09:49:16.242883 [debug] [MainThread]: Flushing usage events
[0m09:49:17.165769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:55.195411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8c2115d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8c1aa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8c484790>]}


============================== 09:49:55.198434 | b7c416c9-c5ff-4f12-b7c1-974c4346b55d ==============================
[0m09:49:55.198434 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:49:55.199639 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None'}
[0m09:49:55.339839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7c416c9-c5ff-4f12-b7c1-974c4346b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8c24ae10>]}
[0m09:49:55.384544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7c416c9-c5ff-4f12-b7c1-974c4346b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8edd80d0>]}
[0m09:49:55.386672 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:49:55.427475 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:49:55.519888 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m09:49:55.521346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7c416c9-c5ff-4f12-b7c1-974c4346b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb881da490>]}
[0m09:49:56.595014 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_user' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_user` specification under
the seeds key instead.
[0m09:49:56.597564 [warn ] [MainThread]: [[33mWARNING[0m]: 'dim_sku' is a seed node, but it is specified in the models section of
models/sources.yml. To fix this error, place the `dim_sku` specification under
the seeds key instead.
[0m09:49:56.723118 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named fct_order_items. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for fct_order_items in one of these files:
   - models/gold/schema.yml
  models/sources.yml
[0m09:49:56.729314 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5852399, "process_in_blocks": "0", "process_kernel_time": 0.104149, "process_mem_max_rss": "137868", "process_out_blocks": "0", "process_user_time": 2.135073}
[0m09:49:56.731103 [debug] [MainThread]: Command `dbt build` failed at 09:49:56.730981 after 1.59 seconds
[0m09:49:56.732717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8c2232d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8c220310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb8c221610>]}
[0m09:49:56.734959 [debug] [MainThread]: Flushing usage events
[0m09:49:57.651743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:04.384520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5051e0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50520af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5051a2050>]}


============================== 09:52:04.388623 | 2fd4869c-1e67-4c5e-8d0e-833400329a0d ==============================
[0m09:52:04.388623 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:52:04.390353 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False'}
[0m09:52:04.484378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fd4869c-1e67-4c5e-8d0e-833400329a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe505091c50>]}
[0m09:52:04.569471 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2504553, "process_in_blocks": "97288", "process_kernel_time": 0.152523, "process_mem_max_rss": "105336", "process_out_blocks": "0", "process_user_time": 1.087998}
[0m09:52:04.570708 [debug] [MainThread]: Command `dbt clean` succeeded at 09:52:04.570610 after 0.25 seconds
[0m09:52:04.571708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe505208d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5051a27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50523a710>]}
[0m09:52:04.572685 [debug] [MainThread]: Flushing usage events
[0m09:52:05.443447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:09.486612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9112389d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9114161e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9112667690>]}


============================== 09:52:09.490753 | cb4b4ceb-0e1b-4ac2-9c3a-71b7a6332aeb ==============================
[0m09:52:09.490753 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:52:09.492647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'profiles_dir': '/usr/app', 'write_json': 'True', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'empty': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True'}
[0m09:52:09.684980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb4b4ceb-0e1b-4ac2-9c3a-71b7a6332aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911226c8d0>]}
[0m09:52:09.728429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb4b4ceb-0e1b-4ac2-9c3a-71b7a6332aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9114fb03d0>]}
[0m09:52:09.731682 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:52:09.776738 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:52:09.784488 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:52:09.786134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb4b4ceb-0e1b-4ac2-9c3a-71b7a6332aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9112250050>]}
[0m09:52:11.198878 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_daily_sales' in the 'models' section of file 'models/gold/schema.yml'
[0m09:52:11.201484 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.daily_funnel' (models/gold/daily_funnel.sql) depends on a source named 'silver.order_placed' which was not found
[0m09:52:11.203637 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.7975075, "process_in_blocks": "30848", "process_kernel_time": 0.093434, "process_mem_max_rss": "136040", "process_out_blocks": "0", "process_user_time": 2.128232}
[0m09:52:11.205379 [debug] [MainThread]: Command `dbt seed` failed at 09:52:11.205277 after 1.80 seconds
[0m09:52:11.207309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9116d9d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f910dfea850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90d7c05510>]}
[0m09:52:11.209467 [debug] [MainThread]: Flushing usage events
[0m09:52:12.151229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:42.759116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c39eb6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3a06c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c3a368ad0>]}


============================== 09:53:42.763962 | 5e34fe6f-3332-4a42-8efa-add61225749b ==============================
[0m09:53:42.763962 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:53:42.765779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'invocation_command': 'dbt seed', 'no_print': 'None', 'empty': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m09:53:42.776818 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |       threads: 4
    8  |       extensions: ["httpfs"]               # optional but handy
    9  | docker compose exec dbt bash -lc "mkdir -p /usr/app/seeds && cat > /usr/app/seeds/schema.yml <<'YAML'
    10 | version: 2
    11 | seeds:
    12 |   - name: dim_user
    13 |     description: User dimension (seed).
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 9, column 1
    could not find expected ':'
      in "<unicode string>", line 10, column 1
  
[0m09:53:42.779539 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.056755275, "process_in_blocks": "96840", "process_kernel_time": 0.183533, "process_mem_max_rss": "101884", "process_out_blocks": "0", "process_user_time": 0.917666}
[0m09:53:42.781282 [debug] [MainThread]: Command `dbt seed` failed at 09:53:42.781119 after 0.06 seconds
[0m09:53:42.782726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c39eaa110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c39ea9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c39ea9fd0>]}
[0m09:53:42.784328 [debug] [MainThread]: Flushing usage events
[0m09:53:43.714213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:53.467477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e90d40e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e90f049d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e91014050>]}


============================== 09:53:53.470188 | 2af05bda-9a81-4c20-a128-fe9e98fdbdb9 ==============================
[0m09:53:53.470188 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:53:53.471649 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'empty': 'None', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/usr/app/logs', 'write_json': 'True', 'debug': 'False', 'profiles_dir': '/usr/app', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m09:53:53.569070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2af05bda-9a81-4c20-a128-fe9e98fdbdb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e90d36610>]}
[0m09:53:53.585858 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13184643, "process_in_blocks": "1168", "process_kernel_time": 0.113668, "process_mem_max_rss": "104832", "process_out_blocks": "0", "process_user_time": 0.930013}
[0m09:53:53.587500 [debug] [MainThread]: Command `dbt clean` succeeded at 09:53:53.587411 after 0.13 seconds
[0m09:53:53.588563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e90e6af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e90c7f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e955d13d0>]}
[0m09:53:53.589485 [debug] [MainThread]: Flushing usage events
[0m09:53:54.524820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:59.409122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475e3a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0478bf1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475f786d0>]}


============================== 09:53:59.416155 | a6757209-1b4a-4948-b364-c4f846233685 ==============================
[0m09:53:59.416155 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:53:59.418611 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'None', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/app/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'quiet': 'False', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m09:53:59.427886 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |       threads: 4
    8  |       extensions: ["httpfs"]               # optional but handy
    9  | docker compose exec dbt bash -lc "mkdir -p /usr/app/seeds && cat > /usr/app/seeds/schema.yml <<'YAML'
    10 | version: 2
    11 | seeds:
    12 |   - name: dim_user
    13 |     description: User dimension (seed).
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 9, column 1
    could not find expected ':'
      in "<unicode string>", line 10, column 1
  
[0m09:53:59.429710 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.044457998, "process_in_blocks": "0", "process_kernel_time": 0.102121, "process_mem_max_rss": "102004", "process_out_blocks": "0", "process_user_time": 0.847609}
[0m09:53:59.430694 [debug] [MainThread]: Command `dbt seed` failed at 09:53:59.430602 after 0.05 seconds
[0m09:53:59.431702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475e2ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475e2ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0475e2e4d0>]}
[0m09:53:59.432830 [debug] [MainThread]: Flushing usage events
[0m09:54:00.362853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:52.887474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b62fed790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b632af250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b631a4a50>]}


============================== 09:55:52.891508 | c8168692-4410-429b-98f7-c3bb8cf944e2 ==============================
[0m09:55:52.891508 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:55:52.892974 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt debug', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'empty': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:55:52.905703 [info ] [MainThread]: dbt version: 1.10.9
[0m09:55:52.906808 [info ] [MainThread]: python version: 3.11.13
[0m09:55:52.907997 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:55:52.909123 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:55:52.913074 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 2
  ------------------------------
  1  | docker compose exec dbt bash -lc "cat > /usr/app/profiles.yml <<'YAML'
  2  | ecomm:
  3  |   target: dev
  4  |   outputs:
  5  |     dev:
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 2, column 6
[0m09:55:52.915367 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.074671835, "process_in_blocks": "97584", "process_kernel_time": 0.095451, "process_mem_max_rss": "102280", "process_out_blocks": "0", "process_user_time": 0.912089}
[0m09:55:52.916422 [debug] [MainThread]: Command `dbt debug` failed at 09:55:52.916313 after 0.08 seconds
[0m09:55:52.917341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b62fedbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b62fef3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6786c590>]}
[0m09:55:52.918525 [debug] [MainThread]: Flushing usage events
[0m09:55:53.878600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:00.645943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2223c1d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2223c13710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2223dd4150>]}


============================== 09:57:00.650301 | 4fc076ef-0384-49de-9179-07e34f927ef0 ==============================
[0m09:57:00.650301 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:57:00.651518 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'profiles_dir': '/usr/app', 'invocation_command': 'dbt debug', 'introspect': 'True'}
[0m09:57:00.663766 [info ] [MainThread]: dbt version: 1.10.9
[0m09:57:00.665290 [info ] [MainThread]: python version: 3.11.13
[0m09:57:00.666749 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:57:00.668483 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:57:00.672789 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 2
  ------------------------------
  1  | docker compose exec dbt bash -lc "cat > /usr/app/profiles.yml <<'YAML'
  2  | ecomm:
  3  |   target: dev
  4  |   outputs:
  5  |     dev:
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 2, column 6
[0m09:57:00.675107 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.043273687, "process_in_blocks": "97584", "process_kernel_time": 0.090235, "process_mem_max_rss": "102332", "process_out_blocks": "0", "process_user_time": 0.952484}
[0m09:57:00.676192 [debug] [MainThread]: Command `dbt debug` failed at 09:57:00.676093 after 0.04 seconds
[0m09:57:00.677112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2223c1e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2223c1f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2223c1d390>]}
[0m09:57:00.678076 [debug] [MainThread]: Flushing usage events
[0m09:57:01.551793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:09.256272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a29b9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a2b701d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a38cba90>]}


============================== 09:57:09.259124 | 791665d9-8f0a-4ac5-be26-1bc1cfd4cd1e ==============================
[0m09:57:09.259124 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:57:09.260729 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'quiet': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/app', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True'}
[0m09:57:09.268343 [info ] [MainThread]: dbt version: 1.10.9
[0m09:57:09.270688 [info ] [MainThread]: python version: 3.11.13
[0m09:57:09.272058 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:57:09.273338 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:57:09.280243 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 10
  ------------------------------
  7  |       threads: 4
  8  |       extensions: ["httpfs"]               # optional but handy
  9  | docker compose exec dbt bash -lc "mkdir -p /usr/app/seeds && cat > /usr/app/seeds/schema.yml <<'YAML'
  10 | version: 2
  11 | seeds:
  12 |   - name: dim_user
  13 |     description: User dimension (seed).
  
  Raw Error:
  ------------------------------
  while scanning a simple key
    in "<unicode string>", line 9, column 1
  could not find expected ':'
    in "<unicode string>", line 10, column 1
[0m09:57:09.282448 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.040520106, "process_in_blocks": "0", "process_kernel_time": 0.083455, "process_mem_max_rss": "102552", "process_out_blocks": "0", "process_user_time": 0.844988}
[0m09:57:09.283669 [debug] [MainThread]: Command `dbt debug` failed at 09:57:09.283566 after 0.04 seconds
[0m09:57:09.284793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a29bb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a29bb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a723c610>]}
[0m09:57:09.286296 [debug] [MainThread]: Flushing usage events
[0m09:57:10.193709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:34.557550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25c57cb390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25c5c7cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25c66dbb90>]}


============================== 09:59:34.561223 | 80140df6-b882-4d74-a0df-cc2978b7b358 ==============================
[0m09:59:34.561223 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:59:34.562497 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/usr/app/logs', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/usr/app', 'empty': 'None', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt debug'}
[0m09:59:34.574733 [info ] [MainThread]: dbt version: 1.10.9
[0m09:59:34.576081 [info ] [MainThread]: python version: 3.11.13
[0m09:59:34.577562 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:59:34.578654 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:59:34.583443 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 2
  ------------------------------
  1  | docker compose exec dbt bash -lc "cat > /usr/app/profiles.yml <<'YAML'
  2  | ecomm:
  3  |   target: dev
  4  |   outputs:
  5  |     dev:
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 2, column 6
[0m09:59:34.585459 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.05004581, "process_in_blocks": "97584", "process_kernel_time": 0.149731, "process_mem_max_rss": "102396", "process_out_blocks": "0", "process_user_time": 0.878427}
[0m09:59:34.586619 [debug] [MainThread]: Command `dbt debug` failed at 09:59:34.586526 after 0.05 seconds
[0m09:59:34.587528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25c5984a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25c57c9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25c57cb090>]}
[0m09:59:34.588418 [debug] [MainThread]: Flushing usage events
[0m09:59:35.480222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:48.151064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f1bcdb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f1fade1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f1be40b10>]}


============================== 10:02:48.154891 | 0b47c6bc-5718-4994-8795-63f45a2e4a86 ==============================
[0m10:02:48.154891 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:02:48.156317 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error': 'None', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/app', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'empty': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m10:02:48.170056 [info ] [MainThread]: dbt version: 1.10.9
[0m10:02:48.171423 [info ] [MainThread]: python version: 3.11.13
[0m10:02:48.172523 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m10:02:48.173749 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m10:02:48.274031 [info ] [MainThread]: Using profiles dir at /usr/app
[0m10:02:48.275942 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m10:02:48.276823 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m10:02:48.279394 [info ] [MainThread]: adapter type: duckdb
[0m10:02:48.281364 [info ] [MainThread]: adapter version: 1.8.2
[0m10:02:48.362337 [info ] [MainThread]: Configuration:
[0m10:02:48.364364 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:02:48.365811 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:02:48.367311 [info ] [MainThread]: Required dependencies:
[0m10:02:48.369132 [debug] [MainThread]: Executing "git --help"
[0m10:02:48.371213 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m10:02:48.372832 [info ] [MainThread]: Connection:
[0m10:02:48.374973 [info ] [MainThread]:   database: warehouse
[0m10:02:48.376621 [info ] [MainThread]:   schema: main
[0m10:02:48.378151 [info ] [MainThread]:   path: /usr/app/warehouse.duckdb
[0m10:02:48.379772 [info ] [MainThread]:   config_options: None
[0m10:02:48.381313 [info ] [MainThread]:   extensions: ['httpfs']
[0m10:02:48.382641 [info ] [MainThread]:   settings: {'allow_unsigned_extensions': True, 'home_directory': '/usr/app'}
[0m10:02:48.383891 [info ] [MainThread]:   external_root: .
[0m10:02:48.385292 [info ] [MainThread]:   use_credential_provider: None
[0m10:02:48.386404 [info ] [MainThread]:   attach: None
[0m10:02:48.387609 [info ] [MainThread]:   filesystems: None
[0m10:02:48.388898 [info ] [MainThread]:   remote: None
[0m10:02:48.390315 [info ] [MainThread]:   plugins: None
[0m10:02:48.391395 [info ] [MainThread]:   disable_transactions: False
[0m10:02:48.392682 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:02:48.431658 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:02:48.453622 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:02:48.454783 [debug] [MainThread]: On debug: select 1 as id
[0m10:02:48.455694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:02:48.549729 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m10:02:48.551419 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m10:02:48.553068 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:02:48.554499 [info ] [MainThread]: [31m2 checks failed:[0m
[0m10:02:48.555635 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m10:02:48.556889 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Invalid Input Error: Cannot change allow_unsigned_extensions setting while database is running

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:02:48.558962 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4747589, "process_in_blocks": "258648", "process_kernel_time": 0.27654, "process_mem_max_rss": "166528", "process_out_blocks": "0", "process_user_time": 1.163378}
[0m10:02:48.560330 [debug] [MainThread]: Command `dbt debug` failed at 10:02:48.560244 after 0.48 seconds
[0m10:02:48.561770 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:02:48.562756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f1bcda610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f1bbabe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f1bc81390>]}
[0m10:02:48.563944 [debug] [MainThread]: Flushing usage events
[0m10:02:49.702479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:11.941585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93727f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff937272410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff937434450>]}


============================== 10:05:11.950308 | 79adbae5-fbed-48fb-88ce-c28aeb4464bb ==============================
[0m10:05:11.950308 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:05:11.952860 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'log_cache_events': 'False', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/usr/app'}
[0m10:05:11.974739 [info ] [MainThread]: dbt version: 1.10.9
[0m10:05:11.976889 [info ] [MainThread]: python version: 3.11.13
[0m10:05:11.978548 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m10:05:11.980258 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m10:05:12.115416 [info ] [MainThread]: Using profiles dir at /usr/app
[0m10:05:12.117262 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m10:05:12.118565 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m10:05:12.121500 [info ] [MainThread]: adapter type: duckdb
[0m10:05:12.122786 [info ] [MainThread]: adapter version: 1.8.2
[0m10:05:12.199373 [info ] [MainThread]: Configuration:
[0m10:05:12.201253 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:05:12.202514 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:05:12.204496 [info ] [MainThread]: Required dependencies:
[0m10:05:12.206329 [debug] [MainThread]: Executing "git --help"
[0m10:05:12.207653 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m10:05:12.208983 [info ] [MainThread]: Connection:
[0m10:05:12.210725 [info ] [MainThread]:   database: warehouse
[0m10:05:12.212608 [info ] [MainThread]:   schema: main
[0m10:05:12.214134 [info ] [MainThread]:   path: /usr/app/warehouse.duckdb
[0m10:05:12.215320 [info ] [MainThread]:   config_options: None
[0m10:05:12.216567 [info ] [MainThread]:   extensions: ['httpfs']
[0m10:05:12.218715 [info ] [MainThread]:   settings: {}
[0m10:05:12.220208 [info ] [MainThread]:   external_root: .
[0m10:05:12.221472 [info ] [MainThread]:   use_credential_provider: None
[0m10:05:12.223034 [info ] [MainThread]:   attach: None
[0m10:05:12.224284 [info ] [MainThread]:   filesystems: None
[0m10:05:12.226088 [info ] [MainThread]:   remote: None
[0m10:05:12.227875 [info ] [MainThread]:   plugins: None
[0m10:05:12.230649 [info ] [MainThread]:   disable_transactions: False
[0m10:05:12.232291 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:05:12.269992 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:05:12.291744 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:05:12.294688 [debug] [MainThread]: On debug: select 1 as id
[0m10:05:12.297673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:12.387642 [debug] [MainThread]: SQL status: OK in 0.090 seconds
[0m10:05:12.389979 [debug] [MainThread]: On debug: Close
[0m10:05:12.394683 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:05:12.396045 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:05:12.397207 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m10:05:12.399381 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6296706, "process_in_blocks": "254616", "process_kernel_time": 0.159038, "process_mem_max_rss": "173416", "process_out_blocks": "0", "process_user_time": 1.322003}
[0m10:05:12.400977 [debug] [MainThread]: Command `dbt debug` failed at 10:05:12.400887 after 0.63 seconds
[0m10:05:12.402533 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:05:12.403918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9372e4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9331b2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff932d75fd0>]}
[0m10:05:12.405334 [debug] [MainThread]: Flushing usage events
[0m10:05:13.305613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:51.378853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd3fd0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd6b78990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd6b6d4d0>]}


============================== 10:06:51.382247 | 87ddc211-660b-4ac6-8896-d0b38b5117ae ==============================
[0m10:06:51.382247 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:06:51.383760 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/app', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True'}
[0m10:06:51.396206 [info ] [MainThread]: dbt version: 1.10.9
[0m10:06:51.397393 [info ] [MainThread]: python version: 3.11.13
[0m10:06:51.398712 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m10:06:51.400088 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m10:06:51.494487 [info ] [MainThread]: Using profiles dir at /usr/app
[0m10:06:51.496224 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m10:06:51.497622 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m10:06:51.500050 [info ] [MainThread]: adapter type: duckdb
[0m10:06:51.501270 [info ] [MainThread]: adapter version: 1.8.2
[0m10:06:51.576316 [info ] [MainThread]: Configuration:
[0m10:06:51.578552 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:06:51.580108 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:06:51.581452 [info ] [MainThread]: Required dependencies:
[0m10:06:51.582814 [debug] [MainThread]: Executing "git --help"
[0m10:06:51.586212 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:06:51.588348 [debug] [MainThread]: STDERR: "b''"
[0m10:06:51.589946 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:06:51.591632 [info ] [MainThread]: Connection:
[0m10:06:51.593709 [info ] [MainThread]:   database: warehouse
[0m10:06:51.595375 [info ] [MainThread]:   schema: main
[0m10:06:51.596945 [info ] [MainThread]:   path: /usr/app/warehouse.duckdb
[0m10:06:51.598538 [info ] [MainThread]:   config_options: None
[0m10:06:51.600530 [info ] [MainThread]:   extensions: ['httpfs']
[0m10:06:51.602030 [info ] [MainThread]:   settings: {}
[0m10:06:51.603474 [info ] [MainThread]:   external_root: .
[0m10:06:51.604625 [info ] [MainThread]:   use_credential_provider: None
[0m10:06:51.606009 [info ] [MainThread]:   attach: None
[0m10:06:51.607747 [info ] [MainThread]:   filesystems: None
[0m10:06:51.609117 [info ] [MainThread]:   remote: None
[0m10:06:51.610416 [info ] [MainThread]:   plugins: None
[0m10:06:51.611370 [info ] [MainThread]:   disable_transactions: False
[0m10:06:51.612781 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:06:51.653272 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:06:51.672872 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:06:51.674033 [debug] [MainThread]: On debug: select 1 as id
[0m10:06:51.674858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:51.754751 [debug] [MainThread]: SQL status: OK in 0.080 seconds
[0m10:06:51.757248 [debug] [MainThread]: On debug: Close
[0m10:06:51.761980 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:06:51.763477 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:06:51.765614 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43737686, "process_in_blocks": "235296", "process_kernel_time": 0.243175, "process_mem_max_rss": "175444", "process_out_blocks": "0", "process_user_time": 1.23533}
[0m10:06:51.767024 [debug] [MainThread]: Command `dbt debug` succeeded at 10:06:51.766902 after 0.44 seconds
[0m10:06:51.768391 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:06:51.769748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd3fd0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd3fd3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd3eb4890>]}
[0m10:06:51.771027 [debug] [MainThread]: Flushing usage events
[0m10:06:52.673699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:00.611062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f646490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f90b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f639f50>]}


============================== 10:07:00.613913 | 39baebf0-743e-41da-ad7c-f354c1875b5c ==============================
[0m10:07:00.613913 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:07:00.615896 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'empty': 'None', 'profiles_dir': '/usr/app', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None'}
[0m10:07:00.768301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39baebf0-743e-41da-ad7c-f354c1875b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8bea1190>]}
[0m10:07:00.810154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39baebf0-743e-41da-ad7c-f354c1875b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d92264690>]}
[0m10:07:00.812085 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:07:00.856234 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:07:00.860555 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:07:00.861935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39baebf0-743e-41da-ad7c-f354c1875b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f6463d0>]}
[0m10:07:01.775452 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_daily_sales' in the 'models' section of file 'models/gold/schema.yml'
[0m10:07:01.778132 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.daily_funnel' (models/gold/daily_funnel.sql) depends on a source named 'silver.order_placed' which was not found
[0m10:07:01.779996 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.2252119, "process_in_blocks": "2616", "process_kernel_time": 0.19747, "process_mem_max_rss": "133848", "process_out_blocks": "0", "process_user_time": 1.735661}
[0m10:07:01.781001 [debug] [MainThread]: Command `dbt seed` failed at 10:07:01.780901 after 1.23 seconds
[0m10:07:01.781941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f6b7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8b37af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f50ad50>]}
[0m10:07:01.783313 [debug] [MainThread]: Flushing usage events
[0m10:07:02.787303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:49.819980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702eb9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702eed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702eadf10>]}


============================== 10:11:49.823451 | 04274de5-7d5a-466a-910a-1e4505c81101 ==============================
[0m10:11:49.823451 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:11:49.825010 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/app', 'quiet': 'False', 'empty': 'None', 'invocation_command': 'dbt seed', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True'}
[0m10:11:49.996808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04274de5-7d5a-466a-910a-1e4505c81101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7705a70bd0>]}
[0m10:11:50.040483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04274de5-7d5a-466a-910a-1e4505c81101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7705a964d0>]}
[0m10:11:50.044574 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:11:50.091175 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:11:50.094019 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:11:50.095388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04274de5-7d5a-466a-910a-1e4505c81101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702d76bd0>]}
[0m10:11:50.957003 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_user' (models/gold/dim_user.sql) depends on a source named 'silver.order_placed' which was not found
[0m10:11:50.960703 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.1923252, "process_in_blocks": "128344", "process_kernel_time": 0.237065, "process_mem_max_rss": "131788", "process_out_blocks": "0", "process_user_time": 1.731605}
[0m10:11:50.961688 [debug] [MainThread]: Command `dbt seed` failed at 10:11:50.961576 after 1.19 seconds
[0m10:11:50.962437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702d2b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770317b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702e1a350>]}
[0m10:11:50.963206 [debug] [MainThread]: Flushing usage events
[0m10:11:52.000256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:05.368417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1074d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca106e9a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1074cf50>]}


============================== 10:18:05.372679 | d6535281-971b-4b2b-94d7-906c0777eab0 ==============================
[0m10:18:05.372679 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:18:05.374172 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt ls', 'use_experimental_parser': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'warn_error': 'None'}
[0m10:18:05.583216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6535281-971b-4b2b-94d7-906c0777eab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca106e9990>]}
[0m10:18:05.629632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6535281-971b-4b2b-94d7-906c0777eab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca132ddd90>]}
[0m10:18:05.632699 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:18:05.678115 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:18:05.686462 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:18:05.688125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6535281-971b-4b2b-94d7-906c0777eab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca105b68d0>]}
[0m10:18:06.809892 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_user' (models/gold/dim_user.sql) depends on a source named 'silver.order_placed' which was not found
[0m10:18:06.814266 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 1.5354528, "process_in_blocks": "128344", "process_kernel_time": 0.214159, "process_mem_max_rss": "131740", "process_out_blocks": "0", "process_user_time": 1.866246}
[0m10:18:06.815691 [debug] [MainThread]: Command `dbt ls` failed at 10:18:06.815570 after 1.54 seconds
[0m10:18:06.817208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1075d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1075ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0cf68350>]}
[0m10:18:06.818553 [debug] [MainThread]: Flushing usage events
[0m10:18:07.738034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:18.104185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af82da910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af8332fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af9207f10>]}


============================== 10:23:18.108493 | 2c49fccc-362f-42ad-a986-2d22fc2808a2 ==============================
[0m10:23:18.108493 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:23:18.110350 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/app', 'invocation_command': 'dbt ls', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'empty': 'None', 'partial_parse': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True'}
[0m10:23:18.285338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c49fccc-362f-42ad-a986-2d22fc2808a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af4b6ae50>]}
[0m10:23:18.327270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c49fccc-362f-42ad-a986-2d22fc2808a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6afaeef750>]}
[0m10:23:18.330280 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:23:18.375032 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:23:18.378554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:23:18.379972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c49fccc-362f-42ad-a986-2d22fc2808a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af8178a10>]}
[0m10:23:19.446942 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.fct_revenue_by_category_daily' (models/gold/fct_revenue_by_category_daily.sql) depends on a node named 'dim_sku' which was not found
[0m10:23:19.451059 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 1.3975846, "process_in_blocks": "128344", "process_kernel_time": 0.194042, "process_mem_max_rss": "134496", "process_out_blocks": "0", "process_user_time": 1.87915}
[0m10:23:19.452450 [debug] [MainThread]: Command `dbt ls` failed at 10:23:19.452339 after 1.40 seconds
[0m10:23:19.453524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af8331950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af822d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6af1cfdb10>]}
[0m10:23:19.454763 [debug] [MainThread]: Flushing usage events
[0m10:23:20.388123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:41.664205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f588ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f5882150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f588ea90>]}


============================== 10:23:41.667436 | 90b569ba-b45f-482e-9893-9f4217eee035 ==============================
[0m10:23:41.667436 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:23:41.668896 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'target_path': 'None', 'version_check': 'True', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt ls', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/usr/app', 'cache_selected_only': 'False'}
[0m10:23:41.812123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b569ba-b45f-482e-9893-9f4217eee035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f5746d10>]}
[0m10:23:41.856879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90b569ba-b45f-482e-9893-9f4217eee035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f84b8f10>]}
[0m10:23:41.859509 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:23:41.902066 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:23:41.909788 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:23:41.911325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90b569ba-b45f-482e-9893-9f4217eee035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f68737d0>]}
[0m10:23:42.929727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90b569ba-b45f-482e-9893-9f4217eee035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0179d90>]}
[0m10:23:42.990716 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:23:42.998403 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:23:43.025206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90b569ba-b45f-482e-9893-9f4217eee035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f01e3f90>]}
[0m10:23:43.027682 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:23:43.029254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b569ba-b45f-482e-9893-9f4217eee035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f1595d10>]}
[0m10:23:43.031638 [info ] [MainThread]: ecomm.gold.daily_funnel
[0m10:23:43.033299 [info ] [MainThread]: ecomm.gold.dim_sku_360
[0m10:23:43.035044 [info ] [MainThread]: ecomm.gold.dim_user_360
[0m10:23:43.037046 [info ] [MainThread]: ecomm.gold.fct_cart_events
[0m10:23:43.038444 [info ] [MainThread]: ecomm.gold.fct_daily_sales
[0m10:23:43.040558 [info ] [MainThread]: ecomm.gold.fct_order_items
[0m10:23:43.042427 [info ] [MainThread]: ecomm.gold.fct_orders
[0m10:23:43.043838 [info ] [MainThread]: ecomm.gold.fct_revenue_by_category_daily
[0m10:23:43.045143 [info ] [MainThread]: ecomm.gold.fct_revenue_daily
[0m10:23:43.046380 [info ] [MainThread]: ecomm.gold.fct_sessions
[0m10:23:43.047577 [info ] [MainThread]: ecomm.staging.stg_add_to_cart
[0m10:23:43.048934 [info ] [MainThread]: ecomm.staging.stg_order_placed
[0m10:23:43.050121 [info ] [MainThread]: ecomm.staging.stg_page_view
[0m10:23:43.051316 [info ] [MainThread]: ecomm.staging.stg_sessions
[0m10:23:43.052595 [info ] [MainThread]: source:ecomm.silver.add_to_cart
[0m10:23:43.053790 [info ] [MainThread]: source:ecomm.silver.order_placed
[0m10:23:43.054947 [info ] [MainThread]: source:ecomm.silver.page_view
[0m10:23:43.055903 [info ] [MainThread]: source:ecomm.silver.sessions
[0m10:23:43.057508 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.44299, "process_in_blocks": "1064", "process_kernel_time": 0.166456, "process_mem_max_rss": "139952", "process_out_blocks": "96", "process_user_time": 1.987076}
[0m10:23:43.058550 [debug] [MainThread]: Command `dbt ls` succeeded at 10:23:43.058444 after 1.44 seconds
[0m10:23:43.059883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f58ea1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f15522d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fa120590>]}
[0m10:23:43.061299 [debug] [MainThread]: Flushing usage events
[0m10:23:43.901896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:20.688149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88747ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8874e72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8874e6250>]}


============================== 10:24:20.691973 | 523b49ab-5053-404c-86c3-41c166ddbc36 ==============================
[0m10:24:20.691973 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:24:20.693801 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'log_format': 'default', 'target_path': 'None', 'empty': 'None', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True'}
[0m10:24:20.835598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '523b49ab-5053-404c-86c3-41c166ddbc36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa887349850>]}
[0m10:24:20.877527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '523b49ab-5053-404c-86c3-41c166ddbc36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88a0b0790>]}
[0m10:24:20.879699 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:24:20.920303 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:24:21.222608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:21.223690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:21.249787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '523b49ab-5053-404c-86c3-41c166ddbc36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa883178510>]}
[0m10:24:21.314835 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:24:21.319828 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:24:21.342930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '523b49ab-5053-404c-86c3-41c166ddbc36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88733e410>]}
[0m10:24:21.344354 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:24:21.345678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '523b49ab-5053-404c-86c3-41c166ddbc36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa883d66490>]}
[0m10:24:21.348015 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:24:21.350626 [debug] [MainThread]: Command end result
[0m10:24:21.377667 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:24:21.383264 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:24:21.390914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:24:21.393088 [info ] [MainThread]: 
[0m10:24:21.395012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:21.396458 [info ] [MainThread]: 
[0m10:24:21.397927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m10:24:21.399714 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.763561, "process_in_blocks": "168", "process_kernel_time": 0.111129, "process_mem_max_rss": "131568", "process_out_blocks": "0", "process_user_time": 1.283039}
[0m10:24:21.401504 [debug] [MainThread]: Command `dbt seed` succeeded at 10:24:21.401415 after 0.77 seconds
[0m10:24:21.403658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8874bda10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8874bd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88bd18590>]}
[0m10:24:21.405263 [debug] [MainThread]: Flushing usage events
[0m10:24:22.426185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:29.064085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe58a47150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe58a1dad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe589e2610>]}


============================== 10:24:29.067041 | 663143e3-6029-46a1-b716-084f92cc2afa ==============================
[0m10:24:29.067041 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:24:29.068463 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s models/staging', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': '/usr/app', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m10:24:29.206813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5889c510>]}
[0m10:24:29.250255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5b6084d0>]}
[0m10:24:29.251850 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:24:29.293696 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:24:29.580853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:29.582112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:29.610765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe54787510>]}
[0m10:24:29.673743 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:24:29.692825 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:24:29.707252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5459c050>]}
[0m10:24:29.708773 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:24:29.710494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe547ab990>]}
[0m10:24:29.719609 [info ] [MainThread]: 
[0m10:24:29.721013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:29.722196 [info ] [MainThread]: 
[0m10:24:29.723454 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:24:29.728730 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:24:29.762321 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:24:29.767382 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m10:24:29.768786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:29.866409 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m10:24:29.868953 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:24:29.873776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m10:24:29.875433 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m10:24:29.881610 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:24:29.884986 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m10:24:29.887817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:29.929391 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m10:24:29.932401 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:24:29.934096 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m10:24:29.935906 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:24:29.937441 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:24:29.938610 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m10:24:29.940005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:24:29.941556 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:24:29.942828 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:24:29.943901 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:24:29.945093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:24:29.946256 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m10:24:29.951164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main)
[0m10:24:29.951568 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m10:24:29.956006 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:24:29.958494 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:24:29.959571 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:24:29.960784 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m10:24:29.962081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:29.963255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:29.993931 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m10:24:29.994745 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m10:24:29.995957 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:24:29.997432 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:24:29.998830 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m10:24:30.000536 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m10:24:30.009869 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:24:30.010116 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:24:30.012044 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:24:30.013614 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m10:24:30.015028 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:24:30.015952 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m10:24:30.016845 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:24:30.018085 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m10:24:30.023969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe59910250>]}
[0m10:24:30.025368 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:30.026266 [debug] [MainThread]: On master: BEGIN
[0m10:24:30.027216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:30.059161 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m10:24:30.061281 [debug] [MainThread]: On master: COMMIT
[0m10:24:30.063027 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:30.064674 [debug] [MainThread]: On master: COMMIT
[0m10:24:30.066525 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:24:30.067782 [debug] [MainThread]: On master: Close
[0m10:24:30.077622 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m10:24:30.077913 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m10:24:30.078175 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m10:24:30.078505 [debug] [Thread-4 (]: Began running node model.ecomm.stg_sessions
[0m10:24:30.079526 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_add_to_cart ............................... [RUN]
[0m10:24:30.081556 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_placed .............................. [RUN]
[0m10:24:30.083142 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_page_view ................................. [RUN]
[0m10:24:30.084624 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_sessions .................................. [RUN]
[0m10:24:30.086004 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m10:24:30.087505 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m10:24:30.089058 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m10:24:30.090450 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.stg_sessions'
[0m10:24:30.091784 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m10:24:30.093164 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m10:24:30.094513 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m10:24:30.095416 [debug] [Thread-4 (]: Began compiling node model.ecomm.stg_sessions
[0m10:24:30.102176 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m10:24:30.104903 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m10:24:30.107809 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m10:24:30.110578 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m10:24:30.138796 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m10:24:30.198676 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m10:24:30.199030 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m10:24:30.199306 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m10:24:30.201628 [debug] [Thread-4 (]: Began executing node model.ecomm.stg_sessions
[0m10:24:30.205327 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m10:24:30.211388 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m10:24:30.215786 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m10:24:30.231801 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:24:30.233731 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m10:24:30.235316 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:24:30.235567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:24:30.237114 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:24:30.237791 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m10:24:30.240024 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:24:30.240754 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m10:24:30.242817 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:24:30.245162 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: BEGIN
[0m10:24:30.246914 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:24:30.249284 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:24:30.275627 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m10:24:30.276039 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m10:24:30.276346 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m10:24:30.276600 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m10:24:30.277771 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:24:30.279219 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:24:30.280715 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:24:30.282053 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:24:30.283657 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/add_to_cart/*/*.parquet');
  );

[0m10:24:30.284978 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/page_view/*/*.parquet');
  );

[0m10:24:30.286305 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/order_placed/*/*.parquet');
  );

[0m10:24:30.287496 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/sessions/*/*.parquet');
  );

[0m10:24:30.294161 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/add_to_cart/*/*.parquet');
  );

[0m10:24:30.295250 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/page_view/*/*.parquet');
  );

[0m10:24:30.296849 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/order_placed/*/*.parquet');
  );

[0m10:24:30.298439 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/sessions/*/*.parquet');
  );

[0m10:24:30.299513 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:24:30.300891 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:24:30.302274 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m10:24:30.303345 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:24:30.304665 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: ROLLBACK
[0m10:24:30.305967 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: ROLLBACK
[0m10:24:30.307229 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: ROLLBACK
[0m10:24:30.308589 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: ROLLBACK
[0m10:24:30.320647 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.stg_add_to_cart'
[0m10:24:30.321536 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.stg_page_view'
[0m10:24:30.322412 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.stg_sessions'
[0m10:24:30.323229 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.stg_order_placed'
[0m10:24:30.323700 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m10:24:30.324536 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m10:24:30.325472 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: Close
[0m10:24:30.326310 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m10:24:30.328502 [debug] [Thread-1 (]: Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.330225 [debug] [Thread-3 (]: Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.332083 [debug] [Thread-4 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.336084 [debug] [Thread-2 (]: Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.336345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe53ae3d50>]}
[0m10:24:30.336660 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe589f0190>]}
[0m10:24:30.337479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe58930750>]}
[0m10:24:30.338314 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '663143e3-6029-46a1-b716-084f92cc2afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe54945150>]}
[0m10:24:30.339472 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.stg_add_to_cart ...................... [[31mERROR[0m in 0.25s]
[0m10:24:30.340823 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model main.stg_page_view ........................ [[31mERROR[0m in 0.25s]
[0m10:24:30.342112 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.25s]
[0m10:24:30.343616 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model main.stg_order_placed ..................... [[31mERROR[0m in 0.25s]
[0m10:24:30.344809 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m10:24:30.345710 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m10:24:30.346783 [debug] [Thread-4 (]: Finished running node model.ecomm.stg_sessions
[0m10:24:30.348010 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m10:24:30.349434 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_add_to_cart' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";".
[0m10:24:30.354142 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_page_view' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";".
[0m10:24:30.355127 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";".
[0m10:24:30.356115 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_order_placed' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";".
[0m10:24:30.357750 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:30.358508 [debug] [MainThread]: On master: BEGIN
[0m10:24:30.359535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:30.394048 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m10:24:30.396045 [debug] [MainThread]: On master: COMMIT
[0m10:24:30.397611 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:30.398860 [debug] [MainThread]: On master: COMMIT
[0m10:24:30.400295 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:24:30.401558 [debug] [MainThread]: On master: Close
[0m10:24:30.404704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:30.407430 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:24:30.408563 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m10:24:30.409378 [debug] [MainThread]: Connection 'model.ecomm.stg_add_to_cart' was properly closed.
[0m10:24:30.410716 [debug] [MainThread]: Connection 'model.ecomm.stg_order_placed' was properly closed.
[0m10:24:30.411946 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m10:24:30.413163 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m10:24:30.414508 [info ] [MainThread]: 
[0m10:24:30.415840 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m10:24:30.417375 [debug] [MainThread]: Command end result
[0m10:24:30.446426 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:24:30.453661 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:24:30.467970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:24:30.468960 [info ] [MainThread]: 
[0m10:24:30.470470 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m10:24:30.471761 [info ] [MainThread]: 
[0m10:24:30.472794 [error] [MainThread]: [31mFailure in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)[0m
[0m10:24:30.473905 [error] [MainThread]:   Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.474665 [info ] [MainThread]: 
[0m10:24:30.475813 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_add_to_cart.sql
[0m10:24:30.476785 [info ] [MainThread]: 
[0m10:24:30.477820 [error] [MainThread]: [31mFailure in model stg_page_view (models/staging/stg_page_view.sql)[0m
[0m10:24:30.479234 [error] [MainThread]:   Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.481679 [info ] [MainThread]: 
[0m10:24:30.483937 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_page_view.sql
[0m10:24:30.485341 [info ] [MainThread]: 
[0m10:24:30.486823 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m10:24:30.488163 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.489334 [info ] [MainThread]: 
[0m10:24:30.490599 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_sessions.sql
[0m10:24:30.491958 [info ] [MainThread]: 
[0m10:24:30.493472 [error] [MainThread]: [31mFailure in model stg_order_placed (models/staging/stg_order_placed.sql)[0m
[0m10:24:30.494754 [error] [MainThread]:   Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";"
[0m10:24:30.495916 [info ] [MainThread]: 
[0m10:24:30.497160 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_order_placed.sql
[0m10:24:30.498585 [info ] [MainThread]: 
[0m10:24:30.500063 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=4
[0m10:24:30.501878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4858665, "process_in_blocks": "133048", "process_kernel_time": 0.236009, "process_mem_max_rss": "207668", "process_out_blocks": "24", "process_user_time": 2.284233}
[0m10:24:30.503254 [debug] [MainThread]: Command `dbt run` failed at 10:24:30.503142 after 1.49 seconds
[0m10:24:30.504609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe588c5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5d271050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5398fa50>]}
[0m10:24:30.505881 [debug] [MainThread]: Flushing usage events
[0m10:24:31.414481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:31.411293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd454889b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4548b8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45487de90>]}


============================== 10:25:31.415011 | 812b538a-ab91-47e3-a73a-1a6055a263f1 ==============================
[0m10:25:31.415011 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:25:31.416495 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/usr/app/logs', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/usr/app', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt run -s models/staging', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m10:25:31.618230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd454905410>]}
[0m10:25:31.664496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd457491010>]}
[0m10:25:31.667205 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:25:31.712871 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:25:32.101436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:25:32.103594 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_add_to_cart.sql
[0m10:25:32.105217 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_sessions.sql
[0m10:25:32.106845 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_order_placed.sql
[0m10:25:32.108027 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_page_view.sql
[0m10:25:32.303100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd450327550>]}
[0m10:25:32.379018 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:25:32.389350 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:25:32.416818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd450371090>]}
[0m10:25:32.418320 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:25:32.419789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45037db50>]}
[0m10:25:32.424543 [info ] [MainThread]: 
[0m10:25:32.425926 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:25:32.427156 [info ] [MainThread]: 
[0m10:25:32.428394 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:25:32.433177 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:25:32.505642 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:25:32.507820 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m10:25:32.509375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:32.611685 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m10:25:32.614960 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:25:32.620884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m10:25:32.622832 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m10:25:32.631554 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:25:32.633640 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m10:25:32.635654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:32.681695 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m10:25:32.684609 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:25:32.686366 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m10:25:32.688408 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:25:32.690038 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:25:32.691725 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m10:25:32.694020 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:25:32.696129 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:25:32.697637 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:25:32.699159 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:25:32.700759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:25:32.701838 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m10:25:32.706466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main_main)
[0m10:25:32.706928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m10:25:32.711610 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:25:32.714530 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:25:32.715789 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m10:25:32.717091 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:25:32.718463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:32.719846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:32.754550 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m10:25:32.755146 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m10:25:32.757398 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:25:32.759820 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:25:32.761973 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m10:25:32.763845 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m10:25:32.774913 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m10:25:32.775351 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m10:25:32.777839 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m10:25:32.780824 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:25:32.782951 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m10:25:32.783737 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:25:32.785273 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m10:25:32.787092 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:25:32.794136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4504db310>]}
[0m10:25:32.795477 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:32.796991 [debug] [MainThread]: On master: BEGIN
[0m10:25:32.798548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:32.832793 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m10:25:32.835672 [debug] [MainThread]: On master: COMMIT
[0m10:25:32.838296 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:32.840436 [debug] [MainThread]: On master: COMMIT
[0m10:25:32.842827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:25:32.844979 [debug] [MainThread]: On master: Close
[0m10:25:32.854834 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m10:25:32.855185 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m10:25:32.855477 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m10:25:32.855830 [debug] [Thread-4 (]: Began running node model.ecomm.stg_sessions
[0m10:25:32.857191 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_add_to_cart ............................... [RUN]
[0m10:25:32.859118 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_placed .............................. [RUN]
[0m10:25:32.860872 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_page_view ................................. [RUN]
[0m10:25:32.862532 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_sessions .................................. [RUN]
[0m10:25:32.864102 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m10:25:32.865330 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m10:25:32.866811 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m10:25:32.867722 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.stg_sessions'
[0m10:25:32.868623 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m10:25:32.870059 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m10:25:32.871134 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m10:25:32.872113 [debug] [Thread-4 (]: Began compiling node model.ecomm.stg_sessions
[0m10:25:32.878560 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m10:25:32.881059 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m10:25:32.883919 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m10:25:32.887319 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m10:25:32.894002 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m10:25:32.895027 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m10:25:32.905188 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m10:25:32.912216 [debug] [Thread-4 (]: Began executing node model.ecomm.stg_sessions
[0m10:25:32.925732 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m10:25:32.923554 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m10:25:32.930433 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m10:25:32.934455 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m10:25:32.948518 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:25:32.949953 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: BEGIN
[0m10:25:32.950259 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:25:32.951252 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:25:32.951493 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:25:32.953352 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m10:25:32.954344 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:25:32.955119 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m10:25:32.958654 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:25:32.960264 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m10:25:32.962061 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:25:32.965192 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:32.995496 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m10:25:32.995963 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m10:25:32.996374 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m10:25:32.996637 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m10:25:32.997876 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:25:32.999632 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:25:33.000979 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:25:33.002484 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:25:33.003872 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    
select
  session_id, user_id, session_start, session_end,
  page_count, cart_events, conversion_flag,
  session_date, ingest_ts
from read_parquet('/opt/data/silver/sessions/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.005646 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    
select
  event_id, user_id, ts, event_date,
  url, referrer, ua, session_hint,
  ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.007284 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    
select
  event_id, order_id, user_id, ts, event_date,
  total, line_items, ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.009004 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    
select
  event_id, user_id, ts, event_date,
  sku, qty, price, ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.014757 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    
select
  session_id, user_id, session_start, session_end,
  page_count, cart_events, conversion_flag,
  session_date, ingest_ts
from read_parquet('/opt/data/silver/sessions/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.015948 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    
select
  event_id, user_id, ts, event_date,
  url, referrer, ua, session_hint,
  ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.017730 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    
select
  event_id, order_id, user_id, ts, event_date,
  total, line_items, ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.019601 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    
select
  event_id, user_id, ts, event_date,
  sku, qty, price, ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet', hive_partitioning=true);
  );

[0m10:25:33.021370 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:25:33.023207 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:25:33.024824 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m10:25:33.026479 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:25:33.028089 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: ROLLBACK
[0m10:25:33.029821 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: ROLLBACK
[0m10:25:33.031390 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: ROLLBACK
[0m10:25:33.033168 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: ROLLBACK
[0m10:25:33.044818 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.stg_page_view'
[0m10:25:33.045718 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.stg_add_to_cart'
[0m10:25:33.046560 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.stg_sessions'
[0m10:25:33.047377 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.stg_order_placed'
[0m10:25:33.048195 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m10:25:33.049319 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m10:25:33.050368 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: Close
[0m10:25:33.051700 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m10:25:33.054570 [debug] [Thread-3 (]: Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.056540 [debug] [Thread-1 (]: Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.058413 [debug] [Thread-4 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.062993 [debug] [Thread-2 (]: Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.063309 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d9db890>]}
[0m10:25:33.064154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4506ea350>]}
[0m10:25:33.065120 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d7b3d90>]}
[0m10:25:33.066166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812b538a-ab91-47e3-a73a-1a6055a263f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d73a110>]}
[0m10:25:33.067145 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model main.stg_page_view ........................ [[31mERROR[0m in 0.19s]
[0m10:25:33.068660 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.stg_add_to_cart ...................... [[31mERROR[0m in 0.20s]
[0m10:25:33.069855 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.20s]
[0m10:25:33.071166 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model main.stg_order_placed ..................... [[31mERROR[0m in 0.20s]
[0m10:25:33.072492 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m10:25:33.073787 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m10:25:33.075331 [debug] [Thread-4 (]: Finished running node model.ecomm.stg_sessions
[0m10:25:33.076353 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m10:25:33.077573 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_page_view' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";".
[0m10:25:33.082419 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_add_to_cart' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";".
[0m10:25:33.083609 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";".
[0m10:25:33.084694 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_order_placed' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";".
[0m10:25:33.086470 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:33.087455 [debug] [MainThread]: On master: BEGIN
[0m10:25:33.088677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:33.119863 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m10:25:33.122313 [debug] [MainThread]: On master: COMMIT
[0m10:25:33.124614 [debug] [MainThread]: Using duckdb connection "master"
[0m10:25:33.126790 [debug] [MainThread]: On master: COMMIT
[0m10:25:33.129142 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:25:33.130745 [debug] [MainThread]: On master: Close
[0m10:25:33.135401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:33.137307 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m10:25:33.138965 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:25:33.140449 [debug] [MainThread]: Connection 'model.ecomm.stg_add_to_cart' was properly closed.
[0m10:25:33.142095 [debug] [MainThread]: Connection 'model.ecomm.stg_order_placed' was properly closed.
[0m10:25:33.143526 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m10:25:33.145050 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m10:25:33.146649 [info ] [MainThread]: 
[0m10:25:33.148235 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:25:33.150167 [debug] [MainThread]: Command end result
[0m10:25:33.190550 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:25:33.200461 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:25:33.215793 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:25:33.217746 [info ] [MainThread]: 
[0m10:25:33.219160 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m10:25:33.220142 [info ] [MainThread]: 
[0m10:25:33.221975 [error] [MainThread]: [31mFailure in model stg_page_view (models/staging/stg_page_view.sql)[0m
[0m10:25:33.223397 [error] [MainThread]:   Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.224594 [info ] [MainThread]: 
[0m10:25:33.225686 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_page_view.sql
[0m10:25:33.227232 [info ] [MainThread]: 
[0m10:25:33.228923 [error] [MainThread]: [31mFailure in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)[0m
[0m10:25:33.230362 [error] [MainThread]:   Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.231673 [info ] [MainThread]: 
[0m10:25:33.232749 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_add_to_cart.sql
[0m10:25:33.233991 [info ] [MainThread]: 
[0m10:25:33.234861 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m10:25:33.235985 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.237545 [info ] [MainThread]: 
[0m10:25:33.238623 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_sessions.sql
[0m10:25:33.239946 [info ] [MainThread]: 
[0m10:25:33.241499 [error] [MainThread]: [31mFailure in model stg_order_placed (models/staging/stg_order_placed.sql)[0m
[0m10:25:33.242863 [error] [MainThread]:   Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";"
[0m10:25:33.244037 [info ] [MainThread]: 
[0m10:25:33.245552 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_order_placed.sql
[0m10:25:33.246686 [info ] [MainThread]: 
[0m10:25:33.247996 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=4
[0m10:25:33.250256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9025841, "process_in_blocks": "262784", "process_kernel_time": 0.349097, "process_mem_max_rss": "215092", "process_out_blocks": "0", "process_user_time": 2.484276}
[0m10:25:33.251866 [debug] [MainThread]: Command `dbt run` failed at 10:25:33.251724 after 1.90 seconds
[0m10:25:33.253329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4548f2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45487de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd459109450>]}
[0m10:25:33.255080 [debug] [MainThread]: Flushing usage events
[0m10:25:34.171418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:09.282737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13aff9a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13aff35e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13aff41b90>]}


============================== 10:27:09.287276 | 9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf ==============================
[0m10:27:09.287276 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:27:09.288620 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run -s models/staging', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': '/usr/app'}
[0m10:27:09.483433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13afdf0710>]}
[0m10:27:09.536648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b2b48790>]}
[0m10:27:09.546578 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:27:09.603983 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:27:10.316875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m10:27:10.318267 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/schema.yml
[0m10:27:10.319475 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_add_to_cart.sql
[0m10:27:10.320518 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_sessions.sql
[0m10:27:10.321401 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_page_view.sql
[0m10:27:10.322350 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_order_placed.sql
[0m10:27:10.618532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13aba36a50>]}
[0m10:27:10.730690 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:27:10.742746 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:27:10.775916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abd3eb90>]}
[0m10:27:10.779891 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:27:10.782260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a994c110>]}
[0m10:27:10.791277 [info ] [MainThread]: 
[0m10:27:10.793056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:27:10.794301 [info ] [MainThread]: 
[0m10:27:10.795772 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:27:10.801507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:27:10.838481 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:27:10.840245 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m10:27:10.841646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:10.953585 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m10:27:10.955890 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:27:10.961422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m10:27:10.963111 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m10:27:10.969128 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:27:10.970356 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m10:27:10.972205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:11.011839 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m10:27:11.014866 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:27:11.016619 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m10:27:11.019270 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:27:11.021043 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:27:11.022647 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m10:27:11.024212 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:27:11.026247 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:27:11.027806 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:27:11.029309 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:27:11.031761 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:27:11.033461 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m10:27:11.039714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main)
[0m10:27:11.040193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m10:27:11.045226 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:27:11.048029 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:27:11.049677 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:27:11.051003 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m10:27:11.052238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:11.053554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:11.089398 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m10:27:11.090499 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m10:27:11.092062 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:27:11.093940 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:27:11.095575 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m10:27:11.097010 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m10:27:11.106639 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:27:11.106982 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:27:11.109528 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:27:11.111533 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m10:27:11.113339 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:27:11.114490 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m10:27:11.116161 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:27:11.117594 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m10:27:11.124843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abd95b90>]}
[0m10:27:11.126460 [debug] [MainThread]: Using duckdb connection "master"
[0m10:27:11.128104 [debug] [MainThread]: On master: BEGIN
[0m10:27:11.129323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:11.169238 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m10:27:11.170897 [debug] [MainThread]: On master: COMMIT
[0m10:27:11.173136 [debug] [MainThread]: Using duckdb connection "master"
[0m10:27:11.174769 [debug] [MainThread]: On master: COMMIT
[0m10:27:11.176764 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:27:11.178327 [debug] [MainThread]: On master: Close
[0m10:27:11.187557 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m10:27:11.187894 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m10:27:11.188172 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m10:27:11.188420 [debug] [Thread-4 (]: Began running node model.ecomm.stg_sessions
[0m10:27:11.189658 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_add_to_cart ............................... [RUN]
[0m10:27:11.191269 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_placed .............................. [RUN]
[0m10:27:11.192729 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_page_view ................................. [RUN]
[0m10:27:11.194279 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_sessions .................................. [RUN]
[0m10:27:11.195870 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m10:27:11.197487 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m10:27:11.199407 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m10:27:11.201327 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.stg_sessions'
[0m10:27:11.203408 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m10:27:11.205248 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m10:27:11.207218 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m10:27:11.208919 [debug] [Thread-4 (]: Began compiling node model.ecomm.stg_sessions
[0m10:27:11.218362 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m10:27:11.222325 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m10:27:11.226838 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m10:27:11.230292 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m10:27:11.238636 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m10:27:11.240353 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m10:27:11.240677 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m10:27:11.266038 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m10:27:11.268683 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m10:27:11.269161 [debug] [Thread-4 (]: Began executing node model.ecomm.stg_sessions
[0m10:27:11.273403 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m10:27:11.279547 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m10:27:11.284053 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:27:11.285253 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:27:11.285878 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m10:27:11.286224 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:27:11.287199 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m10:27:11.287916 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:27:11.288911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:11.289997 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m10:27:11.291289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:27:11.292665 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: BEGIN
[0m10:27:11.295219 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:27:11.296964 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:27:11.331780 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m10:27:11.332344 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m10:27:11.332737 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m10:27:11.333039 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m10:27:11.334342 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:27:11.335746 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:27:11.336980 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:27:11.338381 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:27:11.339658 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/add_to_cart/*/*.parquet');
  );

[0m10:27:11.341049 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/page_view/*/*.parquet');
  );

[0m10:27:11.342559 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/sessions/*/*.parquet');
  );

[0m10:27:11.343806 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/order_placed/*/*.parquet');
  );

[0m10:27:11.350421 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/add_to_cart/*/*.parquet');
  );

[0m10:27:11.351716 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/page_view/*/*.parquet');
  );

[0m10:27:11.353043 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/sessions/*/*.parquet');
  );

[0m10:27:11.354103 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    
select * from read_parquet('/opt/data/silver/order_placed/*/*.parquet');
  );

[0m10:27:11.355046 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:27:11.356083 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:27:11.357177 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:27:11.358555 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m10:27:11.361135 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: ROLLBACK
[0m10:27:11.363479 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: ROLLBACK
[0m10:27:11.365394 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: ROLLBACK
[0m10:27:11.367390 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: ROLLBACK
[0m10:27:11.385064 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.stg_page_view'
[0m10:27:11.386782 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.stg_sessions'
[0m10:27:11.388202 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.stg_order_placed'
[0m10:27:11.389965 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.stg_add_to_cart'
[0m10:27:11.391151 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m10:27:11.392837 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: Close
[0m10:27:11.394422 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m10:27:11.396080 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m10:27:11.399902 [debug] [Thread-3 (]: Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.407631 [debug] [Thread-4 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.411989 [debug] [Thread-2 (]: Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.420613 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a8eb4350>]}
[0m10:27:11.422283 [debug] [Thread-1 (]: Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.423082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a8d7a610>]}
[0m10:27:11.425431 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a8d91690>]}
[0m10:27:11.427900 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model main.stg_page_view ........................ [[31mERROR[0m in 0.22s]
[0m10:27:11.429849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aacc4f9-c15d-4a14-b55c-e9b40b0dcfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abb8dcd0>]}
[0m10:27:11.431549 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.22s]
[0m10:27:11.433254 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model main.stg_order_placed ..................... [[31mERROR[0m in 0.23s]
[0m10:27:11.434820 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m10:27:11.436334 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.stg_add_to_cart ...................... [[31mERROR[0m in 0.23s]
[0m10:27:11.437681 [debug] [Thread-4 (]: Finished running node model.ecomm.stg_sessions
[0m10:27:11.439432 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m10:27:11.441155 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_page_view' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";".
[0m10:27:11.442679 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m10:27:11.447310 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";".
[0m10:27:11.450106 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_order_placed' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";".
[0m10:27:11.451775 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_add_to_cart' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";".
[0m10:27:11.454355 [debug] [MainThread]: Using duckdb connection "master"
[0m10:27:11.455645 [debug] [MainThread]: On master: BEGIN
[0m10:27:11.456593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:11.494581 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m10:27:11.496152 [debug] [MainThread]: On master: COMMIT
[0m10:27:11.497961 [debug] [MainThread]: Using duckdb connection "master"
[0m10:27:11.499217 [debug] [MainThread]: On master: COMMIT
[0m10:27:11.500839 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:27:11.502019 [debug] [MainThread]: On master: Close
[0m10:27:11.505368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:11.506855 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:27:11.508192 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m10:27:11.509221 [debug] [MainThread]: Connection 'model.ecomm.stg_add_to_cart' was properly closed.
[0m10:27:11.510304 [debug] [MainThread]: Connection 'model.ecomm.stg_order_placed' was properly closed.
[0m10:27:11.511379 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m10:27:11.512672 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m10:27:11.514057 [info ] [MainThread]: 
[0m10:27:11.515095 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:27:11.516685 [debug] [MainThread]: Command end result
[0m10:27:11.555002 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:27:11.563424 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:27:11.574395 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:27:11.575741 [info ] [MainThread]: 
[0m10:27:11.577002 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m10:27:11.578347 [info ] [MainThread]: 
[0m10:27:11.579763 [error] [MainThread]: [31mFailure in model stg_page_view (models/staging/stg_page_view.sql)[0m
[0m10:27:11.581210 [error] [MainThread]:   Runtime Error in model stg_page_view (models/staging/stg_page_view.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.582529 [info ] [MainThread]: 
[0m10:27:11.584562 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_page_view.sql
[0m10:27:11.586664 [info ] [MainThread]: 
[0m10:27:11.590274 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m10:27:11.592126 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.593458 [info ] [MainThread]: 
[0m10:27:11.594751 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_sessions.sql
[0m10:27:11.596077 [info ] [MainThread]: 
[0m10:27:11.598044 [error] [MainThread]: [31mFailure in model stg_order_placed (models/staging/stg_order_placed.sql)[0m
[0m10:27:11.600139 [error] [MainThread]:   Runtime Error in model stg_order_placed (models/staging/stg_order_placed.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.601804 [info ] [MainThread]: 
[0m10:27:11.603878 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_order_placed.sql
[0m10:27:11.606720 [info ] [MainThread]: 
[0m10:27:11.610000 [error] [MainThread]: [31mFailure in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)[0m
[0m10:27:11.612109 [error] [MainThread]:   Runtime Error in model stg_add_to_cart (models/staging/stg_add_to_cart.sql)
  Parser Error: syntax error at or near ";"
[0m10:27:11.616210 [info ] [MainThread]: 
[0m10:27:11.618425 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_add_to_cart.sql
[0m10:27:11.620082 [info ] [MainThread]: 
[0m10:27:11.621334 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=4
[0m10:27:11.626177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4259624, "process_in_blocks": "263064", "process_kernel_time": 0.418332, "process_mem_max_rss": "213984", "process_out_blocks": "0", "process_user_time": 2.962476}
[0m10:27:11.628594 [debug] [MainThread]: Command `dbt run` failed at 10:27:11.628178 after 2.43 seconds
[0m10:27:11.630791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13aff99ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13affab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13affab4d0>]}
[0m10:27:11.632976 [debug] [MainThread]: Flushing usage events
[0m10:27:12.707783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:50.016251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c57687dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c578fb2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c57621f90>]}


============================== 10:29:50.019597 | 5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2 ==============================
[0m10:29:50.019597 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:29:50.021339 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run -s models/staging', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/app', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True'}
[0m10:29:50.192524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c574d9410>]}
[0m10:29:50.235328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5a2545d0>]}
[0m10:29:50.240071 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:29:50.285777 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:29:50.614294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m10:29:50.616670 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/schema.yml
[0m10:29:50.617994 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_add_to_cart.sql
[0m10:29:50.619149 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_order_placed.sql
[0m10:29:50.620256 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_page_view.sql
[0m10:29:50.621359 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_sessions.sql
[0m10:29:50.887895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c531ca350>]}
[0m10:29:50.984609 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:29:50.991815 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:29:51.013258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c57cb4250>]}
[0m10:29:51.021125 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:29:51.022813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5326d250>]}
[0m10:29:51.030848 [info ] [MainThread]: 
[0m10:29:51.032560 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:51.033995 [info ] [MainThread]: 
[0m10:29:51.035424 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:29:51.039657 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:29:51.068149 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:29:51.070138 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m10:29:51.074887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:51.160989 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m10:29:51.163596 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:29:51.168445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m10:29:51.170080 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m10:29:51.175403 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:29:51.176810 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m10:29:51.178215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:51.213921 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m10:29:51.216741 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:29:51.218073 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m10:29:51.219972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:29:51.221248 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:29:51.222770 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m10:29:51.224159 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:29:51.225900 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:29:51.227153 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:29:51.228328 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:29:51.229711 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:29:51.230971 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m10:29:51.235433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main)
[0m10:29:51.235840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m10:29:51.239925 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:29:51.242348 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:29:51.243706 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:29:51.244824 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m10:29:51.246114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:51.247617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:51.278779 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m10:29:51.279202 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m10:29:51.281199 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:29:51.283099 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:29:51.284788 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m10:29:51.286247 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m10:29:51.295687 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:29:51.295929 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:29:51.298186 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:29:51.299946 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m10:29:51.301548 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:29:51.302061 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m10:29:51.303310 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:29:51.304587 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m10:29:51.310353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5103c590>]}
[0m10:29:51.311537 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:51.312826 [debug] [MainThread]: On master: BEGIN
[0m10:29:51.313707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:51.350266 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m10:29:51.352335 [debug] [MainThread]: On master: COMMIT
[0m10:29:51.354021 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:51.355790 [debug] [MainThread]: On master: COMMIT
[0m10:29:51.357475 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:29:51.358983 [debug] [MainThread]: On master: Close
[0m10:29:51.366111 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m10:29:51.366428 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m10:29:51.366681 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m10:29:51.366942 [debug] [Thread-4 (]: Began running node model.ecomm.stg_sessions
[0m10:29:51.368033 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_add_to_cart ............................... [RUN]
[0m10:29:51.369436 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_placed .............................. [RUN]
[0m10:29:51.370778 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_page_view ................................. [RUN]
[0m10:29:51.371893 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_sessions .................................. [RUN]
[0m10:29:51.372958 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m10:29:51.374305 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m10:29:51.375668 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m10:29:51.377076 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.stg_sessions'
[0m10:29:51.378270 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m10:29:51.379481 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m10:29:51.380571 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m10:29:51.381803 [debug] [Thread-4 (]: Began compiling node model.ecomm.stg_sessions
[0m10:29:51.388944 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m10:29:51.391742 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m10:29:51.394957 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m10:29:51.397630 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m10:29:51.406428 [debug] [Thread-4 (]: Began executing node model.ecomm.stg_sessions
[0m10:29:51.407150 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m10:29:51.415886 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m10:29:51.427315 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m10:29:51.436866 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m10:29:51.438264 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m10:29:51.441885 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m10:29:51.445073 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m10:29:51.454534 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:29:51.455810 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:29:51.456455 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m10:29:51.456824 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:29:51.457999 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:29:51.458579 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m10:29:51.460215 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:29:51.463876 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: BEGIN
[0m10:29:51.465595 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m10:29:51.467472 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:51.470292 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:29:51.471417 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:29:51.503109 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m10:29:51.503519 [debug] [Thread-2 (]: SQL status: OK in 0.043 seconds
[0m10:29:51.503878 [debug] [Thread-4 (]: SQL status: OK in 0.034 seconds
[0m10:29:51.504134 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m10:29:51.505426 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:29:51.507441 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:29:51.509384 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:29:51.511277 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:29:51.513088 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  sku,
  cast(qty   as integer)       as qty,
  cast(price as double)        as price,
  cast(qty * price as double)  as line_total,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet')
  );

[0m10:29:51.514584 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(order_id as varchar)    as order_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  cast(total    as double)     as total,
  line_items,                      -- DuckDB can read LIST<STRUCT{sku,qty,price}>
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet')
  );

[0m10:29:51.516054 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

select
  cast(session_id   as varchar)   as session_id,
  cast(user_id      as varchar)   as user_id,
  cast(session_start as timestamp) as session_start,
  cast(session_end   as timestamp) as session_end,
  cast(page_count    as integer)   as page_count,
  cast(cart_events   as integer)   as cart_events,
  cast(conversion_flag as integer) as conversion_flag,
  cast(session_date  as date)      as session_date,
  cast(ingest_ts     as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/sessions/**/*.parquet')
  );

[0m10:29:51.517431 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  url,
  referrer,
  ua,
  session_hint,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet')
  );

[0m10:29:52.165389 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

select
  cast(session_id   as varchar)   as session_id,
  cast(user_id      as varchar)   as user_id,
  cast(session_start as timestamp) as session_start,
  cast(session_end   as timestamp) as session_end,
  cast(page_count    as integer)   as page_count,
  cast(cart_events   as integer)   as cart_events,
  cast(conversion_flag as integer) as conversion_flag,
  cast(session_date  as date)      as session_date,
  cast(ingest_ts     as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/sessions/**/*.parquet')
  );

[0m10:29:52.167466 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:29:52.169320 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: ROLLBACK
[0m10:29:52.175464 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.stg_sessions'
[0m10:29:52.177151 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: Close
[0m10:29:52.180439 [debug] [Thread-4 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/**/*.parquet"
[0m10:29:52.183233 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5059c410>]}
[0m10:29:52.185030 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.81s]
[0m10:29:52.186732 [debug] [Thread-4 (]: Finished running node model.ecomm.stg_sessions
[0m10:29:52.188582 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/**/*.parquet".
[0m10:29:54.480280 [debug] [Thread-2 (]: SQL status: OK in 1.588 seconds
[0m10:29:54.486337 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:29:54.488347 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed__dbt_tmp" rename to "stg_order_placed"
[0m10:29:54.489710 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:29:54.501670 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m10:29:54.502417 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:29:54.503321 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m10:29:54.512428 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m10:29:54.517211 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:29:54.518048 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
drop view if exists "warehouse"."main"."stg_order_placed__dbt_backup" cascade
[0m10:29:54.519072 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:29:54.521174 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m10:29:54.523378 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5051a910>]}
[0m10:29:54.524839 [info ] [Thread-2 (]: 2 of 4 OK created sql view model main.stg_order_placed ......................... [[32mOK[0m in 3.15s]
[0m10:29:54.526887 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m10:29:55.623340 [debug] [Thread-1 (]: SQL status: OK in 2.732 seconds
[0m10:29:55.626301 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:29:55.628409 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart__dbt_tmp" rename to "stg_add_to_cart"
[0m10:29:55.630286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:55.631768 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m10:29:55.632610 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:29:55.633413 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m10:29:55.636360 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:29:55.639801 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:29:55.641875 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
drop view if exists "warehouse"."main"."stg_add_to_cart__dbt_backup" cascade
[0m10:29:55.643348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:55.644895 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m10:29:55.646070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c505b9610>]}
[0m10:29:55.647002 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.stg_add_to_cart .......................... [[32mOK[0m in 4.27s]
[0m10:29:55.648629 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m10:29:56.423687 [debug] [Thread-3 (]: SQL status: OK in 3.528 seconds
[0m10:29:56.427927 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:29:56.429988 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view__dbt_tmp" rename to "stg_page_view"
[0m10:29:56.431736 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:29:56.433739 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m10:29:56.435040 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:29:56.436091 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m10:29:56.441253 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:29:56.444596 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:29:56.446444 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
drop view if exists "warehouse"."main"."stg_page_view__dbt_backup" cascade
[0m10:29:56.448257 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:29:56.451764 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m10:29:56.470814 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d87ce80-2cbe-40ff-8d95-b1a0d9e236e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c50526290>]}
[0m10:29:56.472930 [info ] [Thread-3 (]: 3 of 4 OK created sql view model main.stg_page_view ............................ [[32mOK[0m in 5.10s]
[0m10:29:56.474602 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m10:29:56.477246 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:56.478993 [debug] [MainThread]: On master: BEGIN
[0m10:29:56.480345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:56.516364 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m10:29:56.517761 [debug] [MainThread]: On master: COMMIT
[0m10:29:56.519111 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:56.520255 [debug] [MainThread]: On master: COMMIT
[0m10:29:56.521856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:29:56.522847 [debug] [MainThread]: On master: Close
[0m10:29:56.526554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:56.528059 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:29:56.529236 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m10:29:56.530503 [debug] [MainThread]: Connection 'model.ecomm.stg_add_to_cart' was properly closed.
[0m10:29:56.531871 [debug] [MainThread]: Connection 'model.ecomm.stg_order_placed' was properly closed.
[0m10:29:56.533127 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m10:29:56.534195 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m10:29:56.535413 [info ] [MainThread]: 
[0m10:29:56.536797 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m10:29:56.538335 [debug] [MainThread]: Command end result
[0m10:29:56.572967 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:29:56.581407 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:29:56.592439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:29:56.593733 [info ] [MainThread]: 
[0m10:29:56.594989 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:29:56.596191 [info ] [MainThread]: 
[0m10:29:56.597705 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m10:29:56.599153 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/**/*.parquet"
[0m10:29:56.600278 [info ] [MainThread]: 
[0m10:29:56.601527 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_sessions.sql
[0m10:29:56.602824 [info ] [MainThread]: 
[0m10:29:56.604100 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m10:29:56.608193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.2686033, "process_in_blocks": "265456", "process_kernel_time": 0.640206, "process_mem_max_rss": "216588", "process_out_blocks": "0", "process_user_time": 2.560825}
[0m10:29:56.609870 [debug] [MainThread]: Command `dbt run` failed at 10:29:56.609614 after 5.27 seconds
[0m10:29:56.611068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c57694090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c578fb2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c5a229b90>]}
[0m10:29:56.612467 [debug] [MainThread]: Flushing usage events
[0m10:29:57.691948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:31:30.978835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2262d99390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2262d8dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2262df7250>]}


============================== 10:31:30.983711 | 65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6 ==============================
[0m10:31:30.983711 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:31:30.985633 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s models/staging', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/usr/app', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'debug': 'False'}
[0m10:31:31.175733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225edc1390>]}
[0m10:31:31.225187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22659a82d0>]}
[0m10:31:31.228955 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:31:31.281305 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:31:31.672141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:31:31.673549 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_sessions.sql
[0m10:31:31.872765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225e998b10>]}
[0m10:31:31.946408 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:31:31.957377 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:31:32.037014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225e895090>]}
[0m10:31:32.038442 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:31:32.040244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225c753ed0>]}
[0m10:31:32.056580 [info ] [MainThread]: 
[0m10:31:32.058250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:31:32.060154 [info ] [MainThread]: 
[0m10:31:32.061574 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:31:32.067013 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:31:32.096931 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:31:32.098698 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m10:31:32.099761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:32.193380 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m10:31:32.196285 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:31:32.202551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m10:31:32.204342 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m10:31:32.210167 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:31:32.211420 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m10:31:32.212780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:32.251488 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m10:31:32.254437 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:31:32.256085 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m10:31:32.258320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:31:32.260085 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:31:32.261671 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m10:31:32.264189 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:31:32.265731 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:31:32.266928 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:31:32.268245 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:31:32.269637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:31:32.271074 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m10:31:32.275901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main_main)
[0m10:31:32.276320 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m10:31:32.280961 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:31:32.283701 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:31:32.285209 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m10:31:32.286987 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:31:32.288408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:32.289961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:32.324361 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m10:31:32.324659 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m10:31:32.326659 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:31:32.328301 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:31:32.329980 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m10:31:32.331437 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m10:31:32.342256 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:31:32.342547 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m10:31:32.344814 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:31:32.346558 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m10:31:32.348044 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:31:32.348994 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m10:31:32.349903 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:31:32.351041 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m10:31:32.356247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2264e37790>]}
[0m10:31:32.357710 [debug] [MainThread]: Using duckdb connection "master"
[0m10:31:32.358927 [debug] [MainThread]: On master: BEGIN
[0m10:31:32.360085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:32.393919 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m10:31:32.396232 [debug] [MainThread]: On master: COMMIT
[0m10:31:32.398241 [debug] [MainThread]: Using duckdb connection "master"
[0m10:31:32.399793 [debug] [MainThread]: On master: COMMIT
[0m10:31:32.401300 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:31:32.402531 [debug] [MainThread]: On master: Close
[0m10:31:32.410352 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m10:31:32.410709 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m10:31:32.410985 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m10:31:32.411213 [debug] [Thread-4 (]: Began running node model.ecomm.stg_sessions
[0m10:31:32.412349 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_add_to_cart ............................... [RUN]
[0m10:31:32.413797 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_placed .............................. [RUN]
[0m10:31:32.415261 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_page_view ................................. [RUN]
[0m10:31:32.416797 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_sessions .................................. [RUN]
[0m10:31:32.418412 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m10:31:32.419829 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m10:31:32.421181 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m10:31:32.422659 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.stg_sessions'
[0m10:31:32.423683 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m10:31:32.425017 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m10:31:32.426386 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m10:31:32.427667 [debug] [Thread-4 (]: Began compiling node model.ecomm.stg_sessions
[0m10:31:32.434817 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m10:31:32.438401 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m10:31:32.441440 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m10:31:32.444439 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m10:31:32.452899 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m10:31:32.453310 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m10:31:32.459538 [debug] [Thread-4 (]: Began executing node model.ecomm.stg_sessions
[0m10:31:32.465146 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m10:31:32.480880 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m10:31:32.482050 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m10:31:32.485944 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m10:31:32.489588 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m10:31:32.499922 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:31:32.501260 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:31:32.501543 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m10:31:32.501856 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:31:32.503005 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m10:31:32.503287 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:31:32.504176 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:31:32.505778 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m10:31:32.507110 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:31:32.508442 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: BEGIN
[0m10:31:32.510995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:31:32.513360 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:31:32.544941 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m10:31:32.545454 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m10:31:32.545819 [debug] [Thread-4 (]: SQL status: OK in 0.032 seconds
[0m10:31:32.546110 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:31:32.546672 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:31:32.548223 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:31:32.549554 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:31:32.550860 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:31:32.552340 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(order_id as varchar)    as order_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  cast(total    as double)     as total,
  line_items,                      -- DuckDB can read LIST<STRUCT{sku,qty,price}>
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet')
  );

[0m10:31:32.553825 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  url,
  referrer,
  ua,
  session_hint,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet')
  );

[0m10:31:32.555181 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

select
  cast(session_id    as varchar)    as session_id,
  cast(user_id       as varchar)    as user_id,
  cast(session_start as timestamp)  as session_start,
  cast(session_end   as timestamp)  as session_end,
  cast(page_count    as integer)    as page_count,
  cast(cart_events   as integer)    as cart_events,
  cast(conversion_flag as integer)  as conversion_flag,
  cast(session_date  as date)       as session_date,
  cast(ingest_ts     as timestamp)  as ingest_ts
from read_parquet('/opt/data/silver/sessions/*/*.parquet')
  );

[0m10:31:32.556551 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  sku,
  cast(qty   as integer)       as qty,
  cast(price as double)        as price,
  cast(qty * price as double)  as line_total,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet')
  );

[0m10:31:32.771984 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

select
  cast(session_id    as varchar)    as session_id,
  cast(user_id       as varchar)    as user_id,
  cast(session_start as timestamp)  as session_start,
  cast(session_end   as timestamp)  as session_end,
  cast(page_count    as integer)    as page_count,
  cast(cart_events   as integer)    as cart_events,
  cast(conversion_flag as integer)  as conversion_flag,
  cast(session_date  as date)       as session_date,
  cast(ingest_ts     as timestamp)  as ingest_ts
from read_parquet('/opt/data/silver/sessions/*/*.parquet')
  );

[0m10:31:32.774088 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:31:32.775961 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: ROLLBACK
[0m10:31:32.782022 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.stg_sessions'
[0m10:31:32.783939 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: Close
[0m10:31:32.786227 [debug] [Thread-4 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/*/*.parquet"
[0m10:31:32.788131 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225c320a10>]}
[0m10:31:32.789485 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.36s]
[0m10:31:32.791185 [debug] [Thread-4 (]: Finished running node model.ecomm.stg_sessions
[0m10:31:32.792871 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/*/*.parquet".
[0m10:31:34.417147 [debug] [Thread-2 (]: SQL status: OK in 1.859 seconds
[0m10:31:34.424381 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:31:34.426217 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed" rename to "stg_order_placed__dbt_backup"
[0m10:31:34.428580 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:31:34.431898 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:31:34.433257 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed__dbt_tmp" rename to "stg_order_placed"
[0m10:31:34.435046 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:31:34.447564 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m10:31:34.448967 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:31:34.450283 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m10:31:34.461085 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m10:31:34.467364 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:31:34.468425 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
drop view if exists "warehouse"."main"."stg_order_placed__dbt_backup" cascade
[0m10:31:34.472072 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:31:34.475008 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m10:31:34.477186 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225c3b7bd0>]}
[0m10:31:34.478651 [info ] [Thread-2 (]: 2 of 4 OK created sql view model main.stg_order_placed ......................... [[32mOK[0m in 2.06s]
[0m10:31:34.480359 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m10:31:36.060319 [debug] [Thread-1 (]: SQL status: OK in 3.499 seconds
[0m10:31:36.064409 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:31:36.066032 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart" rename to "stg_add_to_cart__dbt_backup"
[0m10:31:36.068044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:31:36.071503 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:31:36.073145 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart__dbt_tmp" rename to "stg_add_to_cart"
[0m10:31:36.075128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:31:36.078169 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m10:31:36.079574 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:31:36.083093 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m10:31:36.091058 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:31:36.094187 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:31:36.095752 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
drop view if exists "warehouse"."main"."stg_add_to_cart__dbt_backup" cascade
[0m10:31:36.100797 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:31:36.103347 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m10:31:36.105618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225c42e710>]}
[0m10:31:36.107477 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.stg_add_to_cart .......................... [[32mOK[0m in 3.69s]
[0m10:31:36.109304 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m10:31:37.230743 [debug] [Thread-3 (]: SQL status: OK in 4.672 seconds
[0m10:31:37.233893 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:31:37.234745 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view" rename to "stg_page_view__dbt_backup"
[0m10:31:37.235906 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m10:31:37.238371 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:31:37.242161 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view__dbt_tmp" rename to "stg_page_view"
[0m10:31:37.243529 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m10:31:37.245191 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m10:31:37.245849 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:31:37.246509 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m10:31:37.251615 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m10:31:37.254975 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:31:37.256160 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
drop view if exists "warehouse"."main"."stg_page_view__dbt_backup" cascade
[0m10:31:37.259527 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:31:37.261117 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m10:31:37.278151 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b14ef9-a8ad-4fd7-bdef-ccadeadea4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225c5d1d50>]}
[0m10:31:37.279873 [info ] [Thread-3 (]: 3 of 4 OK created sql view model main.stg_page_view ............................ [[32mOK[0m in 4.86s]
[0m10:31:37.281645 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m10:31:37.284745 [debug] [MainThread]: Using duckdb connection "master"
[0m10:31:37.286158 [debug] [MainThread]: On master: BEGIN
[0m10:31:37.287363 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:37.327400 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m10:31:37.329287 [debug] [MainThread]: On master: COMMIT
[0m10:31:37.330468 [debug] [MainThread]: Using duckdb connection "master"
[0m10:31:37.331775 [debug] [MainThread]: On master: COMMIT
[0m10:31:37.333449 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:31:37.334779 [debug] [MainThread]: On master: Close
[0m10:31:37.338045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:37.339479 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m10:31:37.340547 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:31:37.341712 [debug] [MainThread]: Connection 'model.ecomm.stg_add_to_cart' was properly closed.
[0m10:31:37.342930 [debug] [MainThread]: Connection 'model.ecomm.stg_order_placed' was properly closed.
[0m10:31:37.344307 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m10:31:37.345477 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m10:31:37.346655 [info ] [MainThread]: 
[0m10:31:37.347919 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m10:31:37.349517 [debug] [MainThread]: Command end result
[0m10:31:37.379580 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:31:37.384892 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:31:37.395605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:31:37.400183 [info ] [MainThread]: 
[0m10:31:37.401713 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:31:37.403279 [info ] [MainThread]: 
[0m10:31:37.404802 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m10:31:37.406190 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/*/*.parquet"
[0m10:31:37.407701 [info ] [MainThread]: 
[0m10:31:37.409231 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_sessions.sql
[0m10:31:37.410877 [info ] [MainThread]: 
[0m10:31:37.412655 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m10:31:37.416808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5029116, "process_in_blocks": "265424", "process_kernel_time": 0.54587, "process_mem_max_rss": "219552", "process_out_blocks": "0", "process_user_time": 2.720953}
[0m10:31:37.418731 [debug] [MainThread]: Command `dbt run` failed at 10:31:37.418590 after 6.50 seconds
[0m10:31:37.420238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2262e07450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2262d8e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f226761cf10>]}
[0m10:31:37.421602 [debug] [MainThread]: Flushing usage events
[0m10:31:38.374741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:39.210918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85a88a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85a8bd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85a87e590>]}


============================== 10:58:39.216957 | c8087611-276e-4f63-ad01-740f70b5692a ==============================
[0m10:58:39.216957 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:58:39.218659 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s fct_order_items', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'profiles_dir': '/usr/app', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m10:58:39.396618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8087611-276e-4f63-ad01-740f70b5692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85a8e29d0>]}
[0m10:58:39.440177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8087611-276e-4f63-ad01-740f70b5692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85d49fb50>]}
[0m10:58:39.443698 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:58:39.489373 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:58:40.025749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:40.028518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:40.058889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8087611-276e-4f63-ad01-740f70b5692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd856461e10>]}
[0m10:58:40.154144 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:58:40.166165 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:58:40.203827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8087611-276e-4f63-ad01-740f70b5692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd856317ed0>]}
[0m10:58:40.207312 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:58:40.211147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8087611-276e-4f63-ad01-740f70b5692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85649add0>]}
[0m10:58:40.213970 [info ] [MainThread]: 
[0m10:58:40.216746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:58:40.220724 [info ] [MainThread]: 
[0m10:58:40.224159 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:58:40.228182 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:58:40.261966 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:58:40.263985 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m10:58:40.265882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:40.400609 [debug] [ThreadPool]: SQL status: OK in 0.135 seconds
[0m10:58:40.405877 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:58:40.423335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m10:58:40.425584 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m10:58:40.435482 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m10:58:40.437434 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m10:58:40.439247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:40.488004 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m10:58:40.490505 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m10:58:40.492245 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m10:58:40.494196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:40.496288 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m10:58:40.498476 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m10:58:40.500413 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:40.502675 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m10:58:40.504547 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m10:58:40.506355 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m10:58:40.508255 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:40.510174 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m10:58:40.519410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m10:58:40.519869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m10:58:40.525076 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:58:40.528297 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:58:40.530217 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m10:58:40.532175 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:58:40.534252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:40.536388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:40.589744 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m10:58:40.590071 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m10:58:40.593457 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:58:40.596899 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:58:40.600318 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m10:58:40.602535 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m10:58:40.611835 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:58:40.612189 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:58:40.615010 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:58:40.617710 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m10:58:40.620200 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:58:40.622169 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m10:58:40.623968 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:58:40.627108 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m10:58:40.636262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8087611-276e-4f63-ad01-740f70b5692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85645dc90>]}
[0m10:58:40.638635 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:40.640518 [debug] [MainThread]: On master: BEGIN
[0m10:58:40.642177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:40.688670 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m10:58:40.690123 [debug] [MainThread]: On master: COMMIT
[0m10:58:40.691793 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:40.693620 [debug] [MainThread]: On master: COMMIT
[0m10:58:40.695786 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:58:40.698066 [debug] [MainThread]: On master: Close
[0m10:58:40.705449 [debug] [Thread-1 (]: Began running node model.ecomm.fct_order_items
[0m10:58:40.708357 [info ] [Thread-1 (]: 1 of 1 START sql view model main_main.fct_order_items .......................... [RUN]
[0m10:58:40.710358 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m10:58:40.712396 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_order_items
[0m10:58:40.719929 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m10:58:40.749107 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_order_items
[0m10:58:40.812717 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m10:58:40.850535 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m10:58:40.852675 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: BEGIN
[0m10:58:40.854888 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:58:40.905297 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m10:58:40.907218 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m10:58:40.909722 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items;
  );

[0m10:58:40.916462 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items;
  );

[0m10:58:40.918488 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:58:40.920746 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m10:58:40.927672 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m10:58:40.930077 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: Close
[0m10:58:40.935619 [debug] [Thread-1 (]: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m10:58:40.939091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8087611-276e-4f63-ad01-740f70b5692a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85a9ce550>]}
[0m10:58:40.941329 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main_main.fct_order_items ................. [[31mERROR[0m in 0.23s]
[0m10:58:40.943768 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_order_items
[0m10:58:40.945927 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";".
[0m10:58:40.949356 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:40.951205 [debug] [MainThread]: On master: BEGIN
[0m10:58:40.953228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:40.994572 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m10:58:40.996452 [debug] [MainThread]: On master: COMMIT
[0m10:58:40.998350 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:41.000264 [debug] [MainThread]: On master: COMMIT
[0m10:58:41.002332 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:58:41.004369 [debug] [MainThread]: On master: Close
[0m10:58:41.009019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:41.010858 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m10:58:41.012501 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:58:41.014711 [debug] [MainThread]: Connection 'model.ecomm.fct_order_items' was properly closed.
[0m10:58:41.016964 [info ] [MainThread]: 
[0m10:58:41.018803 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m10:58:41.020779 [debug] [MainThread]: Command end result
[0m10:58:41.078059 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:58:41.090355 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:58:41.104234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:58:41.105880 [info ] [MainThread]: 
[0m10:58:41.107232 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:58:41.109025 [info ] [MainThread]: 
[0m10:58:41.111237 [error] [MainThread]: [31mFailure in model fct_order_items (models/gold/fct_order_items.sql)[0m
[0m10:58:41.113505 [error] [MainThread]:   Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m10:58:41.116556 [info ] [MainThread]: 
[0m10:58:41.118994 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_order_items.sql
[0m10:58:41.120365 [info ] [MainThread]: 
[0m10:58:41.122342 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:58:41.125352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9653602, "process_in_blocks": "262432", "process_kernel_time": 0.402592, "process_mem_max_rss": "201976", "process_out_blocks": "0", "process_user_time": 2.278503}
[0m10:58:41.126954 [debug] [MainThread]: Command `dbt run` failed at 10:58:41.126853 after 1.97 seconds
[0m10:58:41.128687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85d3753d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85637b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8571765d0>]}
[0m10:58:41.130046 [debug] [MainThread]: Flushing usage events
[0m10:58:42.051841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:59:10.007409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe311fc3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe311fc12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3122233d0>]}


============================== 10:59:10.011301 | b58bb0fa-10b3-4c27-bf00-b8008db7154c ==============================
[0m10:59:10.011301 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:59:10.012848 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -s models/staging', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m10:59:10.179498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30dfb5410>]}
[0m10:59:10.226298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe314b4ba10>]}
[0m10:59:10.228655 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:59:10.274092 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:59:11.011810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:11.013629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:11.046269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30dd43350>]}
[0m10:59:11.124483 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:59:11.133460 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:59:11.154579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30da33ed0>]}
[0m10:59:11.156693 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m10:59:11.158644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30dd81b90>]}
[0m10:59:11.167211 [info ] [MainThread]: 
[0m10:59:11.168681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:59:11.169780 [info ] [MainThread]: 
[0m10:59:11.171195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:59:11.182004 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:59:11.224482 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:59:11.226287 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m10:59:11.228692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:11.282112 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m10:59:11.285283 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:59:11.291933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m10:59:11.296812 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m10:59:11.304031 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:59:11.307285 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m10:59:11.311121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:11.359495 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m10:59:11.361657 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:59:11.363051 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m10:59:11.365116 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:59:11.366691 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:59:11.368625 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m10:59:11.370918 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:59:11.372675 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:59:11.374284 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:59:11.375917 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:59:11.378132 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:59:11.379742 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m10:59:11.385372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main_main)
[0m10:59:11.385828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m10:59:11.390996 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:59:11.393946 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:59:11.397207 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m10:59:11.400178 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:59:11.402383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:11.404210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:11.455794 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m10:59:11.456137 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m10:59:11.457611 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m10:59:11.459341 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:59:11.460874 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m10:59:11.462752 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m10:59:11.473086 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:59:11.473413 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m10:59:11.475973 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:59:11.478080 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m10:59:11.479819 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:59:11.481844 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m10:59:11.484143 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:59:11.486287 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m10:59:11.494170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe311fc1150>]}
[0m10:59:11.495638 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:11.497145 [debug] [MainThread]: On master: BEGIN
[0m10:59:11.501054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:11.558935 [debug] [MainThread]: SQL status: OK in 0.058 seconds
[0m10:59:11.560583 [debug] [MainThread]: On master: COMMIT
[0m10:59:11.561822 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:11.563105 [debug] [MainThread]: On master: COMMIT
[0m10:59:11.564736 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:59:11.566211 [debug] [MainThread]: On master: Close
[0m10:59:11.572093 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m10:59:11.572460 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m10:59:11.572787 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m10:59:11.573029 [debug] [Thread-4 (]: Began running node model.ecomm.stg_sessions
[0m10:59:11.573946 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_add_to_cart ............................... [RUN]
[0m10:59:11.575518 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_placed .............................. [RUN]
[0m10:59:11.576841 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_page_view ................................. [RUN]
[0m10:59:11.578141 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_sessions .................................. [RUN]
[0m10:59:11.579532 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m10:59:11.581372 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m10:59:11.583117 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m10:59:11.585131 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.stg_sessions'
[0m10:59:11.586410 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m10:59:11.587538 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m10:59:11.589400 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m10:59:11.591350 [debug] [Thread-4 (]: Began compiling node model.ecomm.stg_sessions
[0m10:59:11.598549 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m10:59:11.603137 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m10:59:11.652565 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m10:59:11.655698 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m10:59:11.676738 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m10:59:11.678278 [debug] [Thread-4 (]: Began executing node model.ecomm.stg_sessions
[0m10:59:11.679153 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m10:59:11.690988 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m10:59:11.702085 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m10:59:11.704508 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m10:59:11.709474 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m10:59:11.714330 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m10:59:11.732812 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:59:11.734808 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:59:11.735269 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:59:11.735782 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m10:59:11.738594 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: BEGIN
[0m10:59:11.740578 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:59:11.741743 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m10:59:11.744062 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:59:11.746967 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:59:11.749982 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m10:59:11.752182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:11.758825 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:59:11.802909 [debug] [Thread-3 (]: SQL status: OK in 0.059 seconds
[0m10:59:11.803365 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m10:59:11.803670 [debug] [Thread-4 (]: SQL status: OK in 0.057 seconds
[0m10:59:11.803987 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m10:59:11.804955 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:59:11.806423 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:59:11.808031 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m10:59:11.809882 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:59:11.811977 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  url,
  referrer,
  ua,
  session_hint,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet')
  );

[0m10:59:11.813787 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  sku,
  cast(qty   as integer)       as qty,
  cast(price as double)        as price,
  cast(qty * price as double)  as line_total,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet')
  );

[0m10:59:11.816067 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

select
  cast(session_id    as varchar)    as session_id,
  cast(user_id       as varchar)    as user_id,
  cast(session_start as timestamp)  as session_start,
  cast(session_end   as timestamp)  as session_end,
  cast(page_count    as integer)    as page_count,
  cast(cart_events   as integer)    as cart_events,
  cast(conversion_flag as integer)  as conversion_flag,
  cast(session_date  as date)       as session_date,
  cast(ingest_ts     as timestamp)  as ingest_ts
from read_parquet('/opt/data/silver/sessions/*/*.parquet')
  );

[0m10:59:11.818187 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(order_id as varchar)    as order_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  cast(total    as double)     as total,
  line_items,                      -- DuckDB can read LIST<STRUCT{sku,qty,price}>
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet')
  );

[0m10:59:12.260944 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

select
  cast(session_id    as varchar)    as session_id,
  cast(user_id       as varchar)    as user_id,
  cast(session_start as timestamp)  as session_start,
  cast(session_end   as timestamp)  as session_end,
  cast(page_count    as integer)    as page_count,
  cast(cart_events   as integer)    as cart_events,
  cast(conversion_flag as integer)  as conversion_flag,
  cast(session_date  as date)       as session_date,
  cast(ingest_ts     as timestamp)  as ingest_ts
from read_parquet('/opt/data/silver/sessions/*/*.parquet')
  );

[0m10:59:12.264715 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m10:59:12.268944 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: ROLLBACK
[0m10:59:12.275796 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.stg_sessions'
[0m10:59:12.279792 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: Close
[0m10:59:12.284018 [debug] [Thread-4 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/*/*.parquet"
[0m10:59:12.289151 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30daa1490>]}
[0m10:59:12.293080 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.70s]
[0m10:59:12.296345 [debug] [Thread-4 (]: Finished running node model.ecomm.stg_sessions
[0m10:59:12.300271 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/*/*.parquet".
[0m10:59:15.702467 [debug] [Thread-2 (]: SQL status: OK in 3.875 seconds
[0m10:59:15.709572 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:59:15.711939 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed" rename to "stg_order_placed__dbt_backup"
[0m10:59:15.714305 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:59:15.717945 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:59:15.720408 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed__dbt_tmp" rename to "stg_order_placed"
[0m10:59:15.722800 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:59:15.736751 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m10:59:15.739440 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:59:15.741452 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m10:59:15.758866 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m10:59:15.766495 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m10:59:15.769315 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
drop view if exists "warehouse"."main"."stg_order_placed__dbt_backup" cascade
[0m10:59:15.775157 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m10:59:15.779828 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m10:59:15.782162 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30df86c50>]}
[0m10:59:15.785047 [info ] [Thread-2 (]: 2 of 4 OK created sql view model main.stg_order_placed ......................... [[32mOK[0m in 4.20s]
[0m10:59:15.787044 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m10:59:17.659375 [debug] [Thread-1 (]: SQL status: OK in 5.837 seconds
[0m10:59:17.663045 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:59:17.664521 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart" rename to "stg_add_to_cart__dbt_backup"
[0m10:59:17.666136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:59:17.669293 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:59:17.670323 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart__dbt_tmp" rename to "stg_add_to_cart"
[0m10:59:17.671902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:59:17.674056 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m10:59:17.675441 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:59:17.676841 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m10:59:17.681592 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:59:17.684988 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m10:59:17.686784 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
drop view if exists "warehouse"."main"."stg_add_to_cart__dbt_backup" cascade
[0m10:59:17.691054 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:59:17.693113 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m10:59:17.694857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30cfcfd50>]}
[0m10:59:17.696516 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.stg_add_to_cart .......................... [[32mOK[0m in 6.12s]
[0m10:59:17.698164 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m10:59:18.409909 [debug] [Thread-3 (]: SQL status: OK in 6.590 seconds
[0m10:59:18.412847 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:59:18.413727 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view" rename to "stg_page_view__dbt_backup"
[0m10:59:18.414810 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m10:59:18.417503 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:59:18.418832 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view__dbt_tmp" rename to "stg_page_view"
[0m10:59:18.420851 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m10:59:18.422818 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m10:59:18.424013 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:59:18.424754 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m10:59:18.427230 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:59:18.429439 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m10:59:18.430270 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
drop view if exists "warehouse"."main"."stg_page_view__dbt_backup" cascade
[0m10:59:18.432702 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:59:18.434830 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m10:59:18.453669 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58bb0fa-10b3-4c27-bf00-b8008db7154c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30da981d0>]}
[0m10:59:18.455753 [info ] [Thread-3 (]: 3 of 4 OK created sql view model main.stg_page_view ............................ [[32mOK[0m in 6.87s]
[0m10:59:18.457600 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m10:59:18.460575 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:18.461992 [debug] [MainThread]: On master: BEGIN
[0m10:59:18.463334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:18.501642 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m10:59:18.503406 [debug] [MainThread]: On master: COMMIT
[0m10:59:18.505122 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:18.506668 [debug] [MainThread]: On master: COMMIT
[0m10:59:18.508728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:59:18.510213 [debug] [MainThread]: On master: Close
[0m10:59:18.513634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:18.515003 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m10:59:18.516301 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:59:18.517471 [debug] [MainThread]: Connection 'model.ecomm.stg_add_to_cart' was properly closed.
[0m10:59:18.518854 [debug] [MainThread]: Connection 'model.ecomm.stg_order_placed' was properly closed.
[0m10:59:18.519960 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m10:59:18.521306 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m10:59:18.522691 [info ] [MainThread]: 
[0m10:59:18.523878 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 7.35 seconds (7.35s).
[0m10:59:18.525519 [debug] [MainThread]: Command end result
[0m10:59:18.555395 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:59:18.560986 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:59:18.571838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:59:18.572837 [info ] [MainThread]: 
[0m10:59:18.574200 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:59:18.575812 [info ] [MainThread]: 
[0m10:59:18.577844 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m10:59:18.579323 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  IO Error: No files found that match the pattern "/opt/data/silver/sessions/*/*.parquet"
[0m10:59:18.580920 [info ] [MainThread]: 
[0m10:59:18.582356 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_sessions.sql
[0m10:59:18.583893 [info ] [MainThread]: 
[0m10:59:18.585357 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m10:59:18.587273 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.6447735, "process_in_blocks": "3608", "process_kernel_time": 0.393101, "process_mem_max_rss": "219008", "process_out_blocks": "0", "process_user_time": 2.517522}
[0m10:59:18.588330 [debug] [MainThread]: Command `dbt run` failed at 10:59:18.588239 after 8.65 seconds
[0m10:59:18.589363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3169356d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3167c0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3143845d0>]}
[0m10:59:18.590407 [debug] [MainThread]: Flushing usage events
[0m10:59:19.543971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:17.581090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76defb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76defa5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76dfee0190>]}


============================== 11:06:17.586421 | 5b1000d6-3c3c-4ac3-baa9-e4f2159a17bb ==============================
[0m11:06:17.586421 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:06:17.588165 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/logs', 'invocation_command': 'dbt run -s models/marts', 'write_json': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/usr/app', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m11:06:17.741034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b1000d6-3c3c-4ac3-baa9-e4f2159a17bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76df168750>]}
[0m11:06:17.787842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b1000d6-3c3c-4ac3-baa9-e4f2159a17bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e1bbc0d0>]}
[0m11:06:17.790432 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:06:17.834442 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:06:18.360472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:06:18.362442 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_sessions.sql
[0m11:06:18.560141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b1000d6-3c3c-4ac3-baa9-e4f2159a17bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76dab83110>]}
[0m11:06:18.641623 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:06:18.651446 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:06:18.710597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b1000d6-3c3c-4ac3-baa9-e4f2159a17bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76daaae390>]}
[0m11:06:18.711712 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:06:18.713316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b1000d6-3c3c-4ac3-baa9-e4f2159a17bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d897ae90>]}
[0m11:06:18.720754 [warn ] [MainThread]: The selection criterion 'models/marts' does not match any enabled nodes
[0m11:06:18.722850 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:06:18.724676 [debug] [MainThread]: Command end result
[0m11:06:18.760407 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:06:18.782166 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:06:18.803984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:06:18.806238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2924943, "process_in_blocks": "600", "process_kernel_time": 0.103711, "process_mem_max_rss": "137272", "process_out_blocks": "0", "process_user_time": 1.607529}
[0m11:06:18.810195 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:18.810093 after 1.30 seconds
[0m11:06:18.814772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76df15a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76dae191d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e3835450>]}
[0m11:06:18.816479 [debug] [MainThread]: Flushing usage events
[0m11:06:19.786301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:30.181736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ccf26cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ccf16050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ccf26850>]}


============================== 11:06:30.185784 | a87769d2-b732-4db9-9bb9-7d8bb40b1867 ==============================
[0m11:06:30.185784 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:06:30.188015 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/app', 'empty': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m11:06:30.382106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ccdfdc50>]}
[0m11:06:30.430497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cfb31f50>]}
[0m11:06:30.432619 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:06:30.480409 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:06:31.151600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:31.153184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:31.184677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ccf8f310>]}
[0m11:06:31.274416 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:06:31.284627 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:06:31.327482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c8927e10>]}
[0m11:06:31.333102 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:06:31.336683 [info ] [MainThread]: 
[0m11:06:31.338830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:06:31.340435 [info ] [MainThread]: 
[0m11:06:31.342174 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:06:31.347674 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:06:31.349167 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:06:31.414045 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:06:31.414337 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:06:31.415519 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:06:31.417686 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:06:31.419842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:31.422309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:31.488216 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m11:06:31.488504 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m11:06:31.490916 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:06:31.492594 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:06:31.497826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:06:31.498133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m11:06:31.499790 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:06:31.501284 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m11:06:31.508073 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:06:31.510908 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:06:31.512379 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:06:31.514855 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:06:31.516040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:31.517730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:31.567510 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m11:06:31.568298 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m11:06:31.571089 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:06:31.573669 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:06:31.575171 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m11:06:31.577970 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:06:31.581981 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:06:31.582556 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:06:31.584074 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:06:31.586368 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:06:31.588198 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m11:06:31.590135 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:06:31.592412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:06:31.594176 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:06:31.595954 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m11:06:31.598398 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:06:31.599888 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:06:31.601802 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:06:31.603509 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m11:06:31.604766 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:06:31.607118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:06:31.609052 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:06:31.609286 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m11:06:31.611103 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:06:31.618491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m11:06:31.618936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main)
[0m11:06:31.624510 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:06:31.627347 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:06:31.629018 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:06:31.630962 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:06:31.632489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:31.634329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:31.681435 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m11:06:31.681746 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m11:06:31.684382 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:06:31.686541 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:06:31.689682 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:06:31.691846 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:06:31.700530 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:06:31.700812 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:06:31.702943 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:06:31.704344 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:06:31.705915 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:06:31.707501 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:06:31.708709 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:06:31.710246 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:06:31.717100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84cfc320d0>]}
[0m11:06:31.719062 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:31.720683 [debug] [MainThread]: On master: BEGIN
[0m11:06:31.721623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:31.765058 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m11:06:31.766310 [debug] [MainThread]: On master: COMMIT
[0m11:06:31.767808 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:31.769585 [debug] [MainThread]: On master: COMMIT
[0m11:06:31.771668 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:06:31.773262 [debug] [MainThread]: On master: Close
[0m11:06:31.779233 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m11:06:31.779567 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m11:06:31.779851 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m11:06:31.781289 [info ] [Thread-1 (]: 1 of 14 START sql view model main.stg_add_to_cart .............................. [RUN]
[0m11:06:31.783240 [info ] [Thread-2 (]: 2 of 14 START sql view model main.stg_order_placed ............................. [RUN]
[0m11:06:31.784504 [info ] [Thread-3 (]: 3 of 14 START sql view model main.stg_page_view ................................ [RUN]
[0m11:06:31.785956 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m11:06:31.787931 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m11:06:31.789432 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m11:06:31.790975 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m11:06:31.792541 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m11:06:31.794009 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m11:06:31.800761 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m11:06:31.804000 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m11:06:31.806845 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m11:06:31.822434 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m11:06:31.822831 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m11:06:31.829949 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m11:06:31.847340 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m11:06:31.851081 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m11:06:31.855084 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m11:06:31.873371 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:06:31.875435 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:06:31.876459 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m11:06:31.878431 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:06:31.879148 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m11:06:31.881652 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:06:31.884245 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m11:06:31.885966 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:06:31.890121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:06:31.933138 [debug] [Thread-3 (]: SQL status: OK in 0.051 seconds
[0m11:06:31.933636 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m11:06:31.933942 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m11:06:31.935199 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:06:31.937189 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:06:31.938905 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:06:31.941023 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  url,
  referrer,
  ua,
  session_hint,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet')
  );

[0m11:06:31.942656 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(order_id as varchar)    as order_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  cast(total    as double)     as total,
  line_items,                      -- DuckDB can read LIST<STRUCT{sku,qty,price}>
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet')
  );

[0m11:06:31.944467 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  sku,
  cast(qty   as integer)       as qty,
  cast(price as double)        as price,
  cast(qty * price as double)  as line_total,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet')
  );

[0m11:06:35.238208 [debug] [Thread-2 (]: SQL status: OK in 3.290 seconds
[0m11:06:35.249238 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:06:35.252085 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed" rename to "stg_order_placed__dbt_backup"
[0m11:06:35.254763 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:06:35.260235 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:06:35.262720 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed__dbt_tmp" rename to "stg_order_placed"
[0m11:06:35.269716 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:06:35.287065 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m11:06:35.292328 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:06:35.297033 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m11:06:35.309013 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m11:06:35.314434 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:06:35.315694 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
drop view if exists "warehouse"."main"."stg_order_placed__dbt_backup" cascade
[0m11:06:35.319626 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:06:35.322707 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m11:06:35.324961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c8f418d0>]}
[0m11:06:35.326755 [info ] [Thread-2 (]: 2 of 14 OK created sql view model main.stg_order_placed ........................ [[32mOK[0m in 3.54s]
[0m11:06:35.328166 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m11:06:35.329780 [debug] [Thread-4 (]: Began running node model.ecomm.fct_daily_sales
[0m11:06:35.330082 [debug] [Thread-2 (]: Began running node model.ecomm.fct_order_items
[0m11:06:35.331359 [info ] [Thread-4 (]: 4 of 14 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m11:06:35.333585 [info ] [Thread-2 (]: 5 of 14 START sql view model main_main.fct_order_items ......................... [RUN]
[0m11:06:35.335518 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_daily_sales'
[0m11:06:35.337858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_order_placed, now model.ecomm.fct_order_items)
[0m11:06:35.339815 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_daily_sales
[0m11:06:35.341285 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_order_items
[0m11:06:35.344843 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m11:06:35.349238 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:06:35.358925 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_order_items
[0m11:06:35.360012 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_daily_sales
[0m11:06:35.363629 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:06:35.367406 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m11:06:35.377037 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:06:35.378332 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:06:35.378747 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:06:35.379482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:35.381362 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m11:06:35.383634 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m11:06:35.385051 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:06:35.387375 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:06:35.390560 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:06:35.392125 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items;
  );

[0m11:06:35.394521 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:06:35.397706 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items;
  );

[0m11:06:35.399030 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:06:35.400751 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m11:06:35.403513 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:06:35.404901 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m11:06:35.407538 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:06:35.411317 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: ROLLBACK
[0m11:06:35.413739 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m11:06:35.417249 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_daily_sales'
[0m11:06:35.418661 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: Close
[0m11:06:35.420591 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: Close
[0m11:06:35.424983 [debug] [Thread-2 (]: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:35.427321 [debug] [Thread-4 (]: Runtime Error in model fct_daily_sales (models/gold/fct_daily_sales.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:35.428511 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c3456810>]}
[0m11:06:35.430586 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c3594110>]}
[0m11:06:35.432281 [error] [Thread-2 (]: 5 of 14 ERROR creating sql view model main_main.fct_order_items ................ [[31mERROR[0m in 0.09s]
[0m11:06:35.434735 [error] [Thread-4 (]: 4 of 14 ERROR creating sql view model main_main.fct_daily_sales ................ [[31mERROR[0m in 0.09s]
[0m11:06:35.437693 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_order_items
[0m11:06:35.439730 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_daily_sales
[0m11:06:35.441955 [debug] [Thread-2 (]: Began running node model.ecomm.fct_orders
[0m11:06:35.442702 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";".
[0m11:06:35.445298 [info ] [Thread-2 (]: 6 of 14 START sql view model main_main.fct_orders .............................. [RUN]
[0m11:06:35.447743 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_daily_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_daily_sales (models/gold/fct_daily_sales.sql)
  Parser Error: syntax error at or near ";".
[0m11:06:35.448517 [debug] [Thread-4 (]: Began running node model.ecomm.dim_sku_360
[0m11:06:35.450318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.fct_orders)
[0m11:06:35.453284 [info ] [Thread-4 (]: 7 of 14 SKIP relation main_main.dim_sku_360 .................................... [[33mSKIP[0m]
[0m11:06:35.455815 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_orders
[0m11:06:35.458031 [debug] [Thread-4 (]: Finished running node model.ecomm.dim_sku_360
[0m11:06:35.464640 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m11:06:35.466070 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_daily
[0m11:06:35.466482 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.dim_sku_360' to be skipped because of status 'skipped'. 
[0m11:06:35.469901 [info ] [Thread-4 (]: 8 of 14 SKIP relation main_main.fct_revenue_daily .............................. [[33mSKIP[0m]
[0m11:06:35.473022 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_daily
[0m11:06:35.474866 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m11:06:35.475349 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_revenue_daily' to be skipped because of status 'skipped'. 
[0m11:06:35.476619 [info ] [Thread-4 (]: 9 of 14 SKIP relation main_main.fct_revenue_by_category_daily .................. [[33mSKIP[0m]
[0m11:06:35.481185 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m11:06:35.483226 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_revenue_by_category_daily' to be skipped because of status 'skipped'. 
[0m11:06:35.484354 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_orders
[0m11:06:35.489312 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m11:06:35.504179 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:06:35.505963 [debug] [Thread-2 (]: On model.ecomm.fct_orders: BEGIN
[0m11:06:35.507246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:35.509437 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m11:06:35.511541 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:06:35.513393 [debug] [Thread-2 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:06:35.515293 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:06:35.516865 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m11:06:35.518459 [debug] [Thread-2 (]: On model.ecomm.fct_orders: ROLLBACK
[0m11:06:35.521150 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.fct_orders'
[0m11:06:35.522599 [debug] [Thread-2 (]: On model.ecomm.fct_orders: Close
[0m11:06:35.525536 [debug] [Thread-2 (]: Runtime Error in model fct_orders (models/gold/fct_orders.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:35.527390 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c8957690>]}
[0m11:06:35.528677 [error] [Thread-2 (]: 6 of 14 ERROR creating sql view model main_main.fct_orders ..................... [[31mERROR[0m in 0.08s]
[0m11:06:35.530510 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_orders
[0m11:06:35.532612 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_orders (models/gold/fct_orders.sql)
  Parser Error: syntax error at or near ";".
[0m11:06:36.931390 [debug] [Thread-1 (]: SQL status: OK in 4.981 seconds
[0m11:06:36.934390 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:06:36.935171 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart" rename to "stg_add_to_cart__dbt_backup"
[0m11:06:36.936530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:06:36.940148 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:06:36.941174 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart__dbt_tmp" rename to "stg_add_to_cart"
[0m11:06:36.943443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:06:36.946606 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m11:06:36.948357 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:06:36.949125 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m11:06:36.952470 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:06:36.954916 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:06:36.956056 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
drop view if exists "warehouse"."main"."stg_add_to_cart__dbt_backup" cascade
[0m11:06:36.959349 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:06:36.960913 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m11:06:36.962012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c3494150>]}
[0m11:06:36.963057 [info ] [Thread-1 (]: 1 of 14 OK created sql view model main.stg_add_to_cart ......................... [[32mOK[0m in 5.18s]
[0m11:06:36.964765 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m11:06:36.965974 [debug] [Thread-4 (]: Began running node model.ecomm.fct_cart_events
[0m11:06:36.966723 [info ] [Thread-4 (]: 10 of 14 START sql view model main_main.fct_cart_events ........................ [RUN]
[0m11:06:36.967904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_daily_sales, now model.ecomm.fct_cart_events)
[0m11:06:36.968693 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_cart_events
[0m11:06:36.971883 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m11:06:36.981636 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_cart_events
[0m11:06:36.985190 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m11:06:36.997709 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:06:36.999124 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: BEGIN
[0m11:06:36.999930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:37.001631 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:06:37.003672 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:06:37.009441 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date;
  );

[0m11:06:37.011098 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date;
  );

[0m11:06:37.013032 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:06:37.014019 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: ROLLBACK
[0m11:06:37.016399 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_cart_events'
[0m11:06:37.017929 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: Close
[0m11:06:37.020577 [debug] [Thread-4 (]: Runtime Error in model fct_cart_events (models/gold/fct_cart_events.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:37.021451 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c35e7350>]}
[0m11:06:37.022368 [error] [Thread-4 (]: 10 of 14 ERROR creating sql view model main_main.fct_cart_events ............... [[31mERROR[0m in 0.05s]
[0m11:06:37.024334 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_cart_events
[0m11:06:37.025280 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_cart_events' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_cart_events (models/gold/fct_cart_events.sql)
  Parser Error: syntax error at or near ";".
[0m11:06:37.657363 [debug] [Thread-3 (]: SQL status: OK in 5.711 seconds
[0m11:06:37.660440 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:06:37.661883 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view" rename to "stg_page_view__dbt_backup"
[0m11:06:37.663707 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:06:37.667685 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:06:37.669050 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view__dbt_tmp" rename to "stg_page_view"
[0m11:06:37.673464 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:06:37.675669 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m11:06:37.677110 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:06:37.678826 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m11:06:37.685984 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:06:37.688918 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:06:37.690373 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
drop view if exists "warehouse"."main"."stg_page_view__dbt_backup" cascade
[0m11:06:37.694164 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:06:37.696463 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m11:06:37.710586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c344b3d0>]}
[0m11:06:37.712155 [info ] [Thread-3 (]: 3 of 14 OK created sql view model main.stg_page_view ........................... [[32mOK[0m in 5.92s]
[0m11:06:37.713426 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m11:06:37.715287 [debug] [Thread-1 (]: Began running node model.ecomm.daily_funnel
[0m11:06:37.715940 [debug] [Thread-2 (]: Began running node model.ecomm.stg_sessions
[0m11:06:37.717809 [info ] [Thread-1 (]: 11 of 14 START sql view model main_main.daily_funnel ........................... [RUN]
[0m11:06:37.719546 [info ] [Thread-2 (]: 12 of 14 START sql view model main.stg_sessions ................................ [RUN]
[0m11:06:37.721197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_add_to_cart, now model.ecomm.daily_funnel)
[0m11:06:37.722487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.stg_sessions)
[0m11:06:37.723711 [debug] [Thread-1 (]: Began compiling node model.ecomm.daily_funnel
[0m11:06:37.724932 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_sessions
[0m11:06:37.728933 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m11:06:37.733999 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m11:06:37.743965 [debug] [Thread-1 (]: Began executing node model.ecomm.daily_funnel
[0m11:06:37.744781 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_sessions
[0m11:06:37.751456 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m11:06:37.755661 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m11:06:37.767951 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:06:37.768524 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:06:37.769747 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: BEGIN
[0m11:06:37.771337 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: BEGIN
[0m11:06:37.773433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:37.775640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:37.818224 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m11:06:37.818567 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m11:06:37.819623 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:06:37.820855 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:06:37.822379 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

with events as (
  select user_id, ts, 'page_view'   as event_type from "warehouse"."main"."stg_page_view"
  union all
  select user_id, ts, 'add_to_cart' as event_type from "warehouse"."main"."stg_add_to_cart"
  union all
  select user_id, ts, 'order_placed' as event_type from "warehouse"."main"."stg_order_placed"
),
ordered as (
  select
    user_id,
    ts,
    event_type,
    lag(ts) over (partition by user_id order by ts) as prev_ts
  from events
),
marks as (
  select
    *,
    case when prev_ts is null or ts - prev_ts > interval '30 minutes' then 1 else 0 end as is_new_session
  from ordered
),
grp as (
  select
    *,
    sum(is_new_session) over (partition by user_id order by ts rows unbounded preceding) as session_num
  from marks
)
select
  user_id || '|' || strftime('%Y-%m-%dT%H:%M:%S', min(ts)) || '|' || strftime('%Y-%m-%dT%H:%M:%S', max(ts)) as session_id,
  user_id,
  min(ts) as session_start,
  max(ts) as session_end,
  sum(case when event_type='page_view' then 1 else 0 end) as page_count,
  sum(case when event_type='add_to_cart' then 1 else 0 end) as cart_events,
  max(case when event_type='order_placed' then 1 else 0 end) as conversion_flag,
  cast(min(ts) as date) as session_date,
  now() as ingest_ts
from grp
group by user_id, session_num;
  );

[0m11:06:37.824063 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date;
  );

[0m11:06:37.826781 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

with events as (
  select user_id, ts, 'page_view'   as event_type from "warehouse"."main"."stg_page_view"
  union all
  select user_id, ts, 'add_to_cart' as event_type from "warehouse"."main"."stg_add_to_cart"
  union all
  select user_id, ts, 'order_placed' as event_type from "warehouse"."main"."stg_order_placed"
),
ordered as (
  select
    user_id,
    ts,
    event_type,
    lag(ts) over (partition by user_id order by ts) as prev_ts
  from events
),
marks as (
  select
    *,
    case when prev_ts is null or ts - prev_ts > interval '30 minutes' then 1 else 0 end as is_new_session
  from ordered
),
grp as (
  select
    *,
    sum(is_new_session) over (partition by user_id order by ts rows unbounded preceding) as session_num
  from marks
)
select
  user_id || '|' || strftime('%Y-%m-%dT%H:%M:%S', min(ts)) || '|' || strftime('%Y-%m-%dT%H:%M:%S', max(ts)) as session_id,
  user_id,
  min(ts) as session_start,
  max(ts) as session_end,
  sum(case when event_type='page_view' then 1 else 0 end) as page_count,
  sum(case when event_type='add_to_cart' then 1 else 0 end) as cart_events,
  max(case when event_type='order_placed' then 1 else 0 end) as conversion_flag,
  cast(min(ts) as date) as session_date,
  now() as ingest_ts
from grp
group by user_id, session_num;
  );

[0m11:06:37.827721 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date;
  );

[0m11:06:37.828603 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m11:06:37.829956 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:06:37.831400 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: ROLLBACK
[0m11:06:37.832761 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: ROLLBACK
[0m11:06:37.835259 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.stg_sessions'
[0m11:06:37.836954 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.daily_funnel'
[0m11:06:37.837916 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: Close
[0m11:06:37.839304 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: Close
[0m11:06:37.842452 [debug] [Thread-2 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:37.844014 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c0109710>]}
[0m11:06:37.845981 [debug] [Thread-1 (]: Runtime Error in model daily_funnel (models/gold/daily_funnel.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:37.847094 [error] [Thread-2 (]: 12 of 14 ERROR creating sql view model main.stg_sessions ....................... [[31mERROR[0m in 0.12s]
[0m11:06:37.848422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a87769d2-b732-4db9-9bb9-7d8bb40b1867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c0113290>]}
[0m11:06:37.849942 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_sessions
[0m11:06:37.851441 [error] [Thread-1 (]: 11 of 14 ERROR creating sql view model main_main.daily_funnel .................. [[31mERROR[0m in 0.13s]
[0m11:06:37.852899 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";".
[0m11:06:37.853910 [debug] [Thread-1 (]: Finished running node model.ecomm.daily_funnel
[0m11:06:37.855432 [debug] [Thread-3 (]: Began running node model.ecomm.fct_sessions
[0m11:06:37.856407 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.daily_funnel' to be skipped because of status 'error'.  Reason: Runtime Error in model daily_funnel (models/gold/daily_funnel.sql)
  Parser Error: syntax error at or near ";".
[0m11:06:37.857699 [info ] [Thread-3 (]: 13 of 14 SKIP relation main_main.fct_sessions .................................. [[33mSKIP[0m]
[0m11:06:37.860274 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_sessions
[0m11:06:37.861340 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_sessions' to be skipped because of status 'skipped'. 
[0m11:06:37.863859 [debug] [Thread-2 (]: Began running node model.ecomm.dim_user_360
[0m11:06:37.865191 [info ] [Thread-2 (]: 14 of 14 SKIP relation main_main.dim_user_360 .................................. [[33mSKIP[0m]
[0m11:06:37.866548 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_user_360
[0m11:06:37.867792 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.dim_user_360' to be skipped because of status 'skipped'. 
[0m11:06:37.870130 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:37.871431 [debug] [MainThread]: On master: BEGIN
[0m11:06:37.872648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:37.907891 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m11:06:37.909560 [debug] [MainThread]: On master: COMMIT
[0m11:06:37.910915 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:37.912104 [debug] [MainThread]: On master: COMMIT
[0m11:06:37.913662 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:06:37.914924 [debug] [MainThread]: On master: Close
[0m11:06:37.918029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:37.919259 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:06:37.920346 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:06:37.921543 [debug] [MainThread]: Connection 'model.ecomm.daily_funnel' was properly closed.
[0m11:06:37.922635 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m11:06:37.923947 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m11:06:37.925175 [debug] [MainThread]: Connection 'model.ecomm.fct_cart_events' was properly closed.
[0m11:06:37.926489 [info ] [MainThread]: 
[0m11:06:37.927689 [info ] [MainThread]: Finished running 1 table model, 13 view models in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m11:06:37.929559 [debug] [MainThread]: Command end result
[0m11:06:37.957128 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:06:37.962685 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:06:37.973659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:06:37.975768 [info ] [MainThread]: 
[0m11:06:37.977926 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m11:06:37.979508 [info ] [MainThread]: 
[0m11:06:37.981031 [error] [MainThread]: [31mFailure in model fct_order_items (models/gold/fct_order_items.sql)[0m
[0m11:06:37.982793 [error] [MainThread]:   Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:37.984132 [info ] [MainThread]: 
[0m11:06:37.985234 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_order_items.sql
[0m11:06:37.986503 [info ] [MainThread]: 
[0m11:06:37.987805 [error] [MainThread]: [31mFailure in model fct_daily_sales (models/gold/fct_daily_sales.sql)[0m
[0m11:06:37.988915 [error] [MainThread]:   Runtime Error in model fct_daily_sales (models/gold/fct_daily_sales.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:37.990170 [info ] [MainThread]: 
[0m11:06:37.991325 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_daily_sales.sql
[0m11:06:37.992175 [info ] [MainThread]: 
[0m11:06:37.993361 [error] [MainThread]: [31mFailure in model fct_orders (models/gold/fct_orders.sql)[0m
[0m11:06:37.994545 [error] [MainThread]:   Runtime Error in model fct_orders (models/gold/fct_orders.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:37.995761 [info ] [MainThread]: 
[0m11:06:37.997109 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_orders.sql
[0m11:06:37.998400 [info ] [MainThread]: 
[0m11:06:37.999579 [error] [MainThread]: [31mFailure in model fct_cart_events (models/gold/fct_cart_events.sql)[0m
[0m11:06:38.000893 [error] [MainThread]:   Runtime Error in model fct_cart_events (models/gold/fct_cart_events.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:38.002369 [info ] [MainThread]: 
[0m11:06:38.003607 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_cart_events.sql
[0m11:06:38.004700 [info ] [MainThread]: 
[0m11:06:38.005923 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m11:06:38.007035 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:38.008178 [info ] [MainThread]: 
[0m11:06:38.009517 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/staging/stg_sessions.sql
[0m11:06:38.010733 [info ] [MainThread]: 
[0m11:06:38.012017 [error] [MainThread]: [31mFailure in model daily_funnel (models/gold/daily_funnel.sql)[0m
[0m11:06:38.013246 [error] [MainThread]:   Runtime Error in model daily_funnel (models/gold/daily_funnel.sql)
  Parser Error: syntax error at or near ";"
[0m11:06:38.014329 [info ] [MainThread]: 
[0m11:06:38.015602 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/daily_funnel.sql
[0m11:06:38.016899 [info ] [MainThread]: 
[0m11:06:38.018122 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=6 SKIP=5 NO-OP=0 TOTAL=14
[0m11:06:38.019796 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 7.916885, "process_in_blocks": "1328", "process_kernel_time": 0.476333, "process_mem_max_rss": "213236", "process_out_blocks": "0", "process_user_time": 2.769788}
[0m11:06:38.021279 [debug] [MainThread]: Command `dbt build` failed at 11:06:38.021190 after 7.92 seconds
[0m11:06:38.022609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d17b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c35c3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ccf27fd0>]}
[0m11:06:38.023938 [debug] [MainThread]: Flushing usage events
[0m11:06:39.177775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:11.930981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832e0bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832fc4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832dfe190>]}


============================== 11:09:11.934936 | 93e01ba1-9af0-4e7a-84fe-8501c41c3850 ==============================
[0m11:09:11.934936 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:09:11.937126 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'profiles_dir': '/usr/app', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run -s models/gold', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'partial_parse': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'log_path': '/usr/app/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m11:09:12.100938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832e4e010>]}
[0m11:09:12.146915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835a28790>]}
[0m11:09:12.149966 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:09:12.194182 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:09:13.082993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:13.085242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:13.115529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82eb41c50>]}
[0m11:09:13.239028 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:09:13.252810 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:09:13.281056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82e813f10>]}
[0m11:09:13.284236 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:09:13.287588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832e66590>]}
[0m11:09:13.299512 [info ] [MainThread]: 
[0m11:09:13.301748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:13.303124 [info ] [MainThread]: 
[0m11:09:13.304712 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:09:13.311046 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:09:13.340135 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:09:13.342065 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:09:13.344414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:13.402407 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m11:09:13.405264 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:09:13.411241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:09:13.412995 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:09:13.419618 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:09:13.421702 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:09:13.423759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:13.469860 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m11:09:13.472454 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:09:13.474104 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:09:13.476475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:09:13.478262 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:09:13.481183 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:09:13.483647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:09:13.485944 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:09:13.487732 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:09:13.489656 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:09:13.491746 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:09:13.493971 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:09:13.499729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m11:09:13.500154 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m11:09:13.505629 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:09:13.508790 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:09:13.511050 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:09:13.512597 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:09:13.513750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:13.515877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:13.557904 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m11:09:13.558261 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m11:09:13.560063 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:09:13.562350 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:09:13.564514 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:09:13.566544 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:09:13.575755 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:09:13.576734 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:09:13.578509 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:09:13.580600 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:09:13.582428 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:09:13.584281 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:09:13.586093 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:09:13.588189 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:09:13.595374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832d13950>]}
[0m11:09:13.597465 [debug] [MainThread]: Using duckdb connection "master"
[0m11:09:13.599394 [debug] [MainThread]: On master: BEGIN
[0m11:09:13.601718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:13.651018 [debug] [MainThread]: SQL status: OK in 0.049 seconds
[0m11:09:13.652793 [debug] [MainThread]: On master: COMMIT
[0m11:09:13.654812 [debug] [MainThread]: Using duckdb connection "master"
[0m11:09:13.656934 [debug] [MainThread]: On master: COMMIT
[0m11:09:13.659512 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:09:13.662038 [debug] [MainThread]: On master: Close
[0m11:09:13.669525 [debug] [Thread-1 (]: Began running node model.ecomm.daily_funnel
[0m11:09:13.669842 [debug] [Thread-2 (]: Began running node model.ecomm.fct_cart_events
[0m11:09:13.670119 [debug] [Thread-3 (]: Began running node model.ecomm.fct_daily_sales
[0m11:09:13.670361 [debug] [Thread-4 (]: Began running node model.ecomm.fct_order_items
[0m11:09:13.672169 [info ] [Thread-1 (]: 1 of 10 START sql view model main_main.daily_funnel ............................ [RUN]
[0m11:09:13.674518 [info ] [Thread-2 (]: 2 of 10 START sql view model main_main.fct_cart_events ......................... [RUN]
[0m11:09:13.676531 [info ] [Thread-3 (]: 3 of 10 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m11:09:13.678564 [info ] [Thread-4 (]: 4 of 10 START sql view model main_main.fct_order_items ......................... [RUN]
[0m11:09:13.681155 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.daily_funnel'
[0m11:09:13.683275 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.fct_cart_events'
[0m11:09:13.684967 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_daily_sales'
[0m11:09:13.688055 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m11:09:13.690875 [debug] [Thread-1 (]: Began compiling node model.ecomm.daily_funnel
[0m11:09:13.692811 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_cart_events
[0m11:09:13.694848 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_daily_sales
[0m11:09:13.696883 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_order_items
[0m11:09:13.706612 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m11:09:13.746139 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m11:09:13.749675 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m11:09:13.753415 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:09:13.771098 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_cart_events
[0m11:09:13.771990 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_daily_sales
[0m11:09:13.773800 [debug] [Thread-1 (]: Began executing node model.ecomm.daily_funnel
[0m11:09:13.785676 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_order_items
[0m11:09:13.797104 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m11:09:13.799451 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m11:09:13.803365 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m11:09:13.806949 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:09:13.823344 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:09:13.824741 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:09:13.825781 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:09:13.826062 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: BEGIN
[0m11:09:13.828462 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m11:09:13.828920 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:09:13.830724 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: BEGIN
[0m11:09:13.832881 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:09:13.834470 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:09:13.836404 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:09:13.838486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:13.844125 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:09:13.886467 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m11:09:13.886861 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m11:09:13.887125 [debug] [Thread-3 (]: SQL status: OK in 0.053 seconds
[0m11:09:13.887382 [debug] [Thread-4 (]: SQL status: OK in 0.043 seconds
[0m11:09:13.889140 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:09:13.891076 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:09:13.892830 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:09:13.895217 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:09:13.897025 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date;
  );

[0m11:09:13.898783 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date;
  );

[0m11:09:13.900952 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:09:13.902846 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items;
  );

[0m11:09:13.905527 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date;
  );

[0m11:09:13.907746 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date;
  );

[0m11:09:13.909753 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:09:13.912199 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items;
  );

[0m11:09:13.913776 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:09:13.915775 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m11:09:13.917678 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m11:09:13.919457 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:09:13.921181 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: ROLLBACK
[0m11:09:13.923817 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: ROLLBACK
[0m11:09:13.926108 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: ROLLBACK
[0m11:09:13.928143 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m11:09:13.932954 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.daily_funnel'
[0m11:09:13.934475 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.fct_cart_events'
[0m11:09:13.937512 [debug] [Thread-3 (]: Failed to rollback 'model.ecomm.fct_daily_sales'
[0m11:09:13.940189 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m11:09:13.941679 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: Close
[0m11:09:13.943625 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: Close
[0m11:09:13.945305 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: Close
[0m11:09:13.947172 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: Close
[0m11:09:13.950580 [debug] [Thread-1 (]: Runtime Error in model daily_funnel (models/gold/daily_funnel.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:13.952681 [debug] [Thread-2 (]: Runtime Error in model fct_cart_events (models/gold/fct_cart_events.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:13.954861 [debug] [Thread-3 (]: Runtime Error in model fct_daily_sales (models/gold/fct_daily_sales.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:13.960888 [debug] [Thread-4 (]: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:13.961208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82ddb6890>]}
[0m11:09:13.961872 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8330cf490>]}
[0m11:09:13.964233 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832e55d10>]}
[0m11:09:13.966540 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82ddbb790>]}
[0m11:09:13.969335 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model main_main.daily_funnel ................... [[31mERROR[0m in 0.28s]
[0m11:09:13.971480 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model main_main.fct_cart_events ................ [[31mERROR[0m in 0.28s]
[0m11:09:13.973714 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model main_main.fct_daily_sales ................ [[31mERROR[0m in 0.28s]
[0m11:09:13.975283 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model main_main.fct_order_items ................ [[31mERROR[0m in 0.28s]
[0m11:09:13.976842 [debug] [Thread-1 (]: Finished running node model.ecomm.daily_funnel
[0m11:09:13.979245 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_cart_events
[0m11:09:13.981827 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_daily_sales
[0m11:09:13.984051 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_order_items
[0m11:09:13.986049 [debug] [Thread-1 (]: Began running node model.ecomm.fct_orders
[0m11:09:13.986421 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.daily_funnel' to be skipped because of status 'error'.  Reason: Runtime Error in model daily_funnel (models/gold/daily_funnel.sql)
  Parser Error: syntax error at or near ";".
[0m11:09:13.988312 [debug] [Thread-2 (]: Began running node model.ecomm.fct_sessions
[0m11:09:13.994960 [info ] [Thread-1 (]: 5 of 10 START sql view model main_main.fct_orders .............................. [RUN]
[0m11:09:13.997343 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_cart_events' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_cart_events (models/gold/fct_cart_events.sql)
  Parser Error: syntax error at or near ";".
[0m11:09:13.999634 [info ] [Thread-2 (]: 6 of 10 START sql view model main_main.fct_sessions ............................ [RUN]
[0m11:09:14.002626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.daily_funnel, now model.ecomm.fct_orders)
[0m11:09:14.005753 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_daily_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_daily_sales (models/gold/fct_daily_sales.sql)
  Parser Error: syntax error at or near ";".
[0m11:09:14.008037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_cart_events, now model.ecomm.fct_sessions)
[0m11:09:14.010134 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_orders
[0m11:09:14.012458 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";".
[0m11:09:14.015248 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_sessions
[0m11:09:14.019326 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m11:09:14.022546 [debug] [Thread-3 (]: Began running node model.ecomm.dim_sku_360
[0m11:09:14.023216 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_daily
[0m11:09:14.026701 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m11:09:14.033098 [info ] [Thread-3 (]: 7 of 10 SKIP relation main_main.dim_sku_360 .................................... [[33mSKIP[0m]
[0m11:09:14.035603 [info ] [Thread-4 (]: 8 of 10 SKIP relation main_main.fct_revenue_daily .............................. [[33mSKIP[0m]
[0m11:09:14.040484 [debug] [Thread-3 (]: Finished running node model.ecomm.dim_sku_360
[0m11:09:14.043753 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_daily
[0m11:09:14.046472 [debug] [Thread-3 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m11:09:14.051290 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_orders
[0m11:09:14.050951 [info ] [Thread-3 (]: 9 of 10 SKIP relation main_main.fct_revenue_by_category_daily .................. [[33mSKIP[0m]
[0m11:09:14.056644 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m11:09:14.056977 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_sessions
[0m11:09:14.059139 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m11:09:14.066257 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m11:09:14.081967 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:09:14.083794 [debug] [Thread-1 (]: On model.ecomm.fct_orders: BEGIN
[0m11:09:14.084185 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:09:14.085142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:14.087467 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: BEGIN
[0m11:09:14.092887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:09:14.137813 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m11:09:14.138159 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m11:09:14.139798 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:09:14.141787 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:09:14.144149 [debug] [Thread-1 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:09:14.147200 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main"."stg_sessions"
group by session_date
order by session_date;
  );

[0m11:09:14.149707 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date;
  );

[0m11:09:14.151517 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main"."stg_sessions"
group by session_date
order by session_date;
  );

[0m11:09:14.153393 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:09:14.154784 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m11:09:14.156587 [debug] [Thread-1 (]: On model.ecomm.fct_orders: ROLLBACK
[0m11:09:14.158372 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: ROLLBACK
[0m11:09:14.162096 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.fct_orders'
[0m11:09:14.164151 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.fct_sessions'
[0m11:09:14.165415 [debug] [Thread-1 (]: On model.ecomm.fct_orders: Close
[0m11:09:14.167795 [debug] [Thread-2 (]: On model.ecomm.fct_sessions: Close
[0m11:09:14.171630 [debug] [Thread-1 (]: Runtime Error in model fct_orders (models/gold/fct_orders.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.174355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82e871390>]}
[0m11:09:14.176178 [debug] [Thread-2 (]: Runtime Error in model fct_sessions (models/gold/fct_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.177189 [error] [Thread-1 (]: 5 of 10 ERROR creating sql view model main_main.fct_orders ..................... [[31mERROR[0m in 0.17s]
[0m11:09:14.180150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e01ba1-9af0-4e7a-84fe-8501c41c3850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff832e0b190>]}
[0m11:09:14.184088 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_orders
[0m11:09:14.186195 [error] [Thread-2 (]: 6 of 10 ERROR creating sql view model main_main.fct_sessions ................... [[31mERROR[0m in 0.17s]
[0m11:09:14.190631 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_orders (models/gold/fct_orders.sql)
  Parser Error: syntax error at or near ";".
[0m11:09:14.192609 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_sessions
[0m11:09:14.196781 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_sessions (models/gold/fct_sessions.sql)
  Parser Error: syntax error at or near ";".
[0m11:09:14.199521 [debug] [Thread-4 (]: Began running node model.ecomm.dim_user_360
[0m11:09:14.202064 [info ] [Thread-4 (]: 10 of 10 SKIP relation main_main.dim_user_360 .................................. [[33mSKIP[0m]
[0m11:09:14.204169 [debug] [Thread-4 (]: Finished running node model.ecomm.dim_user_360
[0m11:09:14.207085 [debug] [MainThread]: Using duckdb connection "master"
[0m11:09:14.208587 [debug] [MainThread]: On master: BEGIN
[0m11:09:14.210657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:14.256723 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m11:09:14.259134 [debug] [MainThread]: On master: COMMIT
[0m11:09:14.261581 [debug] [MainThread]: Using duckdb connection "master"
[0m11:09:14.263826 [debug] [MainThread]: On master: COMMIT
[0m11:09:14.266282 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:09:14.268907 [debug] [MainThread]: On master: Close
[0m11:09:14.273910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:14.276201 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:09:14.278424 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:09:14.280676 [debug] [MainThread]: Connection 'model.ecomm.fct_orders' was properly closed.
[0m11:09:14.282681 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m11:09:14.284871 [debug] [MainThread]: Connection 'model.ecomm.fct_daily_sales' was properly closed.
[0m11:09:14.287782 [debug] [MainThread]: Connection 'model.ecomm.fct_order_items' was properly closed.
[0m11:09:14.290462 [info ] [MainThread]: 
[0m11:09:14.296291 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m11:09:14.300045 [debug] [MainThread]: Command end result
[0m11:09:14.362570 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:09:14.380052 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:09:14.398540 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:09:14.400432 [info ] [MainThread]: 
[0m11:09:14.401951 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m11:09:14.403469 [info ] [MainThread]: 
[0m11:09:14.405724 [error] [MainThread]: [31mFailure in model daily_funnel (models/gold/daily_funnel.sql)[0m
[0m11:09:14.407534 [error] [MainThread]:   Runtime Error in model daily_funnel (models/gold/daily_funnel.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.411113 [info ] [MainThread]: 
[0m11:09:14.414131 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/daily_funnel.sql
[0m11:09:14.416618 [info ] [MainThread]: 
[0m11:09:14.418965 [error] [MainThread]: [31mFailure in model fct_cart_events (models/gold/fct_cart_events.sql)[0m
[0m11:09:14.420999 [error] [MainThread]:   Runtime Error in model fct_cart_events (models/gold/fct_cart_events.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.423210 [info ] [MainThread]: 
[0m11:09:14.425639 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_cart_events.sql
[0m11:09:14.427794 [info ] [MainThread]: 
[0m11:09:14.430103 [error] [MainThread]: [31mFailure in model fct_daily_sales (models/gold/fct_daily_sales.sql)[0m
[0m11:09:14.432881 [error] [MainThread]:   Runtime Error in model fct_daily_sales (models/gold/fct_daily_sales.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.434370 [info ] [MainThread]: 
[0m11:09:14.436599 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_daily_sales.sql
[0m11:09:14.438968 [info ] [MainThread]: 
[0m11:09:14.441335 [error] [MainThread]: [31mFailure in model fct_order_items (models/gold/fct_order_items.sql)[0m
[0m11:09:14.443843 [error] [MainThread]:   Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.445693 [info ] [MainThread]: 
[0m11:09:14.447817 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_order_items.sql
[0m11:09:14.449884 [info ] [MainThread]: 
[0m11:09:14.451829 [error] [MainThread]: [31mFailure in model fct_orders (models/gold/fct_orders.sql)[0m
[0m11:09:14.453765 [error] [MainThread]:   Runtime Error in model fct_orders (models/gold/fct_orders.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.455154 [info ] [MainThread]: 
[0m11:09:14.456700 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_orders.sql
[0m11:09:14.458955 [info ] [MainThread]: 
[0m11:09:14.461190 [error] [MainThread]: [31mFailure in model fct_sessions (models/gold/fct_sessions.sql)[0m
[0m11:09:14.463519 [error] [MainThread]:   Runtime Error in model fct_sessions (models/gold/fct_sessions.sql)
  Parser Error: syntax error at or near ";"
[0m11:09:14.465358 [info ] [MainThread]: 
[0m11:09:14.467702 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_sessions.sql
[0m11:09:14.470153 [info ] [MainThread]: 
[0m11:09:14.472144 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=4 NO-OP=0 TOTAL=10
[0m11:09:14.474349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.639753, "process_in_blocks": "0", "process_kernel_time": 0.198125, "process_mem_max_rss": "213840", "process_out_blocks": "0", "process_user_time": 2.456757}
[0m11:09:14.476824 [debug] [MainThread]: Command `dbt run` failed at 11:09:14.476716 after 2.64 seconds
[0m11:09:14.479044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82e9adb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff837690ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82ed86110>]}
[0m11:09:14.481262 [debug] [MainThread]: Flushing usage events
[0m11:09:15.575992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:43.354945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729efb7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f178890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f012a90>]}


============================== 11:09:43.359798 | 305301de-55d6-4905-9718-94febad606f8 ==============================
[0m11:09:43.359798 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:09:43.364518 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s models/staging', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/usr/app', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/usr/app/logs'}
[0m11:09:43.534809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729efb5490>]}
[0m11:09:43.581236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a1be0250>]}
[0m11:09:43.585127 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:09:43.630941 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:09:44.674524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 10 files changed.
[0m11:09:44.677375 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/dim_user_360.sql
[0m11:09:44.679737 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_revenue_daily.sql
[0m11:09:44.681678 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_cart_events.sql
[0m11:09:44.684478 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_orders.sql
[0m11:09:44.686628 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_order_items.sql
[0m11:09:44.689180 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/daily_funnel.sql
[0m11:09:44.691994 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/staging/stg_sessions.sql
[0m11:09:44.694684 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_sessions.sql
[0m11:09:44.697659 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_daily_sales.sql
[0m11:09:44.700907 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_revenue_by_category_daily.sql
[0m11:09:44.973821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729aabf090>]}
[0m11:09:45.135326 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:09:45.152159 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:09:45.186698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729ab1d290>]}
[0m11:09:45.190264 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:09:45.192770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7298908790>]}
[0m11:09:45.206538 [info ] [MainThread]: 
[0m11:09:45.208563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:45.210437 [info ] [MainThread]: 
[0m11:09:45.212933 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:09:45.219599 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:09:45.245838 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:09:45.247790 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:09:45.251237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:45.310740 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m11:09:45.314055 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:09:45.320264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m11:09:45.322728 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m11:09:45.329869 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:09:45.332228 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:09:45.334357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:45.387836 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m11:09:45.391336 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:09:45.394591 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m11:09:45.398082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:09:45.401503 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:09:45.404378 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m11:09:45.407361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:09:45.411505 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m11:09:45.415243 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:09:45.418035 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m11:09:45.421666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:09:45.424575 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m11:09:45.432237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main_main)
[0m11:09:45.432768 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m11:09:45.439539 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:09:45.444204 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:09:45.447148 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:09:45.449457 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:09:45.451780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:45.454101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:45.504590 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m11:09:45.505488 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m11:09:45.506765 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:09:45.509092 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:09:45.511204 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:09:45.513411 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:09:45.523754 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:09:45.524561 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:09:45.527237 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:09:45.530342 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:09:45.532008 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:09:45.534601 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:09:45.537370 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:09:45.539634 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:09:45.547936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729894cd10>]}
[0m11:09:45.550241 [debug] [MainThread]: Using duckdb connection "master"
[0m11:09:45.552619 [debug] [MainThread]: On master: BEGIN
[0m11:09:45.555637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:45.605476 [debug] [MainThread]: SQL status: OK in 0.050 seconds
[0m11:09:45.608345 [debug] [MainThread]: On master: COMMIT
[0m11:09:45.610218 [debug] [MainThread]: Using duckdb connection "master"
[0m11:09:45.613142 [debug] [MainThread]: On master: COMMIT
[0m11:09:45.615974 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:09:45.618242 [debug] [MainThread]: On master: Close
[0m11:09:45.626245 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m11:09:45.626588 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m11:09:45.626842 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m11:09:45.628445 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_add_to_cart ............................... [RUN]
[0m11:09:45.630691 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_placed .............................. [RUN]
[0m11:09:45.633009 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_page_view ................................. [RUN]
[0m11:09:45.635049 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m11:09:45.637364 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m11:09:45.639729 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m11:09:45.641537 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m11:09:45.644041 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m11:09:45.646010 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m11:09:45.654620 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m11:09:45.657894 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m11:09:45.661481 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m11:09:45.678622 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m11:09:45.680516 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m11:09:45.686564 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m11:09:45.708396 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m11:09:45.708808 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m11:09:45.713352 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m11:09:45.732109 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:09:45.733704 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:09:45.736353 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m11:09:45.737755 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:09:45.738602 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m11:09:45.740597 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:09:45.742916 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m11:09:45.744903 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:09:45.749082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:45.794083 [debug] [Thread-3 (]: SQL status: OK in 0.053 seconds
[0m11:09:45.794475 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m11:09:45.794738 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m11:09:45.796295 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:09:45.798938 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:09:45.800679 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:09:45.803202 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  url,
  referrer,
  ua,
  session_hint,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet')
  );

[0m11:09:45.805086 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(order_id as varchar)    as order_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  cast(total    as double)     as total,
  line_items,                      -- DuckDB can read LIST<STRUCT{sku,qty,price}>
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet')
  );

[0m11:09:45.807433 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  sku,
  cast(qty   as integer)       as qty,
  cast(price as double)        as price,
  cast(qty * price as double)  as line_total,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet')
  );

[0m11:09:48.573108 [debug] [Thread-2 (]: SQL status: OK in 2.760 seconds
[0m11:09:48.580960 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:09:48.582650 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed" rename to "stg_order_placed__dbt_backup"
[0m11:09:48.584694 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:09:48.589374 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:09:48.590986 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed__dbt_tmp" rename to "stg_order_placed"
[0m11:09:48.593245 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:09:48.606621 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m11:09:48.608339 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:09:48.609670 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m11:09:48.620696 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m11:09:48.626124 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:09:48.627758 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
drop view if exists "warehouse"."main"."stg_order_placed__dbt_backup" cascade
[0m11:09:48.632160 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:09:48.635546 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m11:09:48.638560 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729ae329d0>]}
[0m11:09:48.640652 [info ] [Thread-2 (]: 2 of 4 OK created sql view model main.stg_order_placed ......................... [[32mOK[0m in 3.00s]
[0m11:09:48.642753 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m11:09:50.391946 [debug] [Thread-1 (]: SQL status: OK in 4.576 seconds
[0m11:09:50.398459 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:09:50.401893 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart" rename to "stg_add_to_cart__dbt_backup"
[0m11:09:50.405273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:09:50.411058 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:09:50.413556 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart__dbt_tmp" rename to "stg_add_to_cart"
[0m11:09:50.416516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:09:50.419501 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m11:09:50.421983 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:09:50.424171 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m11:09:50.435208 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:09:50.440527 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:09:50.444335 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
drop view if exists "warehouse"."main"."stg_add_to_cart__dbt_backup" cascade
[0m11:09:50.452433 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:09:50.455675 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m11:09:50.458556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7298563e10>]}
[0m11:09:50.461847 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.stg_add_to_cart .......................... [[32mOK[0m in 4.82s]
[0m11:09:50.464323 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m11:09:53.328690 [debug] [Thread-3 (]: SQL status: OK in 7.519 seconds
[0m11:09:53.333126 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:09:53.335136 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view" rename to "stg_page_view__dbt_backup"
[0m11:09:53.337804 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:09:53.342275 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:09:53.344217 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view__dbt_tmp" rename to "stg_page_view"
[0m11:09:53.346609 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:09:53.349799 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m11:09:53.352548 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:09:53.355463 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m11:09:53.363686 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:09:53.367728 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:09:53.369693 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
drop view if exists "warehouse"."main"."stg_page_view__dbt_backup" cascade
[0m11:09:53.375905 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:09:53.378960 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m11:09:53.408180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7298656010>]}
[0m11:09:53.411395 [info ] [Thread-3 (]: 3 of 4 OK created sql view model main.stg_page_view ............................ [[32mOK[0m in 7.77s]
[0m11:09:53.414327 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m11:09:53.417003 [debug] [Thread-4 (]: Began running node model.ecomm.stg_sessions
[0m11:09:53.418960 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_sessions .................................. [RUN]
[0m11:09:53.420811 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.stg_sessions'
[0m11:09:53.422927 [debug] [Thread-4 (]: Began compiling node model.ecomm.stg_sessions
[0m11:09:53.428640 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m11:09:53.452715 [debug] [Thread-4 (]: Began executing node model.ecomm.stg_sessions
[0m11:09:53.457120 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m11:09:53.484886 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:09:53.487158 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: BEGIN
[0m11:09:53.489182 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:09:53.540582 [debug] [Thread-4 (]: SQL status: OK in 0.051 seconds
[0m11:09:53.542730 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:09:53.545568 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

with events as (
  select user_id, ts, 'page_view'    as event_type from "warehouse"."main"."stg_page_view"
  union all
  select user_id, ts, 'add_to_cart'  as event_type from "warehouse"."main"."stg_add_to_cart"
  union all
  select user_id, ts, 'order_placed' as event_type from "warehouse"."main"."stg_order_placed"
),
ordered as (
  select
    user_id,
    ts,
    event_type,
    lag(ts) over (partition by user_id order by ts) as prev_ts
  from events
),
marks as (
  select
    *,
    case when prev_ts is null or ts - prev_ts > interval '30 minutes' then 1 else 0 end as is_new_session
  from ordered
),
grp as (
  select
    *,
    sum(is_new_session) over (partition by user_id order by ts rows unbounded preceding) as session_num
  from marks
)
select
  user_id || '|' || strftime('%Y-%m-%dT%H:%M:%S', min(ts)) || '|' || strftime('%Y-%m-%dT%H:%M:%S', max(ts)) as session_id,
  user_id,
  min(ts) as session_start,
  max(ts) as session_end,
  sum(case when event_type='page_view' then 1 else 0 end) as page_count,
  sum(case when event_type='add_to_cart' then 1 else 0 end) as cart_events,
  max(case when event_type='order_placed' then 1 else 0 end) as conversion_flag,
  cast(min(ts) as date) as session_date,
  now() as ingest_ts
from grp
group by user_id, session_num
  );

[0m11:10:07.209368 [debug] [Thread-4 (]: SQL status: OK in 12.247 seconds
[0m11:10:07.213223 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:10:07.214961 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */
alter view "warehouse"."main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m11:10:07.217342 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:10:07.219819 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: COMMIT
[0m11:10:07.221422 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:10:07.223220 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: COMMIT
[0m11:10:07.236959 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m11:10:07.240298 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:10:07.242438 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */
drop view if exists "warehouse"."main"."stg_sessions__dbt_backup" cascade
[0m11:10:07.245390 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:10:07.247668 [debug] [Thread-4 (]: On model.ecomm.stg_sessions: Close
[0m11:10:07.266290 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305301de-55d6-4905-9718-94febad606f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729ad0b6d0>]}
[0m11:10:07.269946 [info ] [Thread-4 (]: 4 of 4 OK created sql view model main.stg_sessions ............................. [[32mOK[0m in 13.85s]
[0m11:10:07.271713 [debug] [Thread-4 (]: Finished running node model.ecomm.stg_sessions
[0m11:10:07.274688 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:07.276188 [debug] [MainThread]: On master: BEGIN
[0m11:10:07.277790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:07.319775 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m11:10:07.321293 [debug] [MainThread]: On master: COMMIT
[0m11:10:07.322568 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:07.324222 [debug] [MainThread]: On master: COMMIT
[0m11:10:07.326097 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:10:07.327350 [debug] [MainThread]: On master: Close
[0m11:10:07.331188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:07.332451 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:10:07.333690 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:10:07.334966 [debug] [MainThread]: Connection 'model.ecomm.stg_add_to_cart' was properly closed.
[0m11:10:07.336359 [debug] [MainThread]: Connection 'model.ecomm.stg_order_placed' was properly closed.
[0m11:10:07.337688 [debug] [MainThread]: Connection 'model.ecomm.stg_page_view' was properly closed.
[0m11:10:07.338938 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m11:10:07.340630 [info ] [MainThread]: 
[0m11:10:07.342844 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 22.13 seconds (22.13s).
[0m11:10:07.344827 [debug] [MainThread]: Command end result
[0m11:10:07.382283 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:10:07.391422 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:10:07.406633 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:10:07.411816 [info ] [MainThread]: 
[0m11:10:07.415758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:07.418817 [info ] [MainThread]: 
[0m11:10:07.422099 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:10:07.424932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.759007, "process_in_blocks": "288", "process_kernel_time": 0.77622, "process_mem_max_rss": "212844", "process_out_blocks": "0", "process_user_time": 2.801143}
[0m11:10:07.426960 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:07.426805 after 22.76 seconds
[0m11:10:07.429001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f023290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729f020090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729aaf2f50>]}
[0m11:10:07.431164 [debug] [MainThread]: Flushing usage events
[0m11:10:08.344476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:14.558357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b57d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b5b84550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b5a94910>]}


============================== 11:10:14.562935 | eb418abd-cc38-426f-852e-e6a8217a9a17 ==============================
[0m11:10:14.562935 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:10:14.566137 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run -s models/gold', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80'}
[0m11:10:14.727816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b20f08d0>]}
[0m11:10:14.771297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b8408810>]}
[0m11:10:14.773793 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:10:14.815844 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:10:15.613074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:15.614267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:15.644768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b15850d0>]}
[0m11:10:15.725156 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:10:15.734207 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:10:15.756268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b120bf10>]}
[0m11:10:15.757673 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:10:15.759248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b133e550>]}
[0m11:10:15.768972 [info ] [MainThread]: 
[0m11:10:15.770713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:10:15.773299 [info ] [MainThread]: 
[0m11:10:15.775113 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:10:15.781294 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:10:15.808170 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:10:15.809481 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:10:15.810808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:15.859876 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m11:10:15.862248 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:10:15.868400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:10:15.870300 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:10:15.877497 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:10:15.878754 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:10:15.880425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:15.919195 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m11:10:15.921211 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:10:15.922379 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:10:15.923662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:10:15.924488 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:10:15.925276 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:10:15.926615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:10:15.927922 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:10:15.928981 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:10:15.930071 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:10:15.931433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:10:15.932490 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:10:15.937715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main)
[0m11:10:15.938183 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m11:10:15.942804 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:10:15.945033 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:10:15.946219 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:10:15.947384 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:10:15.948635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:15.949812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:15.986729 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m11:10:15.987020 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m11:10:15.987853 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:10:15.989063 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:10:15.990109 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:10:15.991020 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:10:15.998744 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:10:15.999142 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:10:16.000763 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:10:16.002167 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:10:16.003063 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:10:16.003799 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:10:16.004323 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:10:16.005300 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:10:16.011238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b1625bd0>]}
[0m11:10:16.012442 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:16.013371 [debug] [MainThread]: On master: BEGIN
[0m11:10:16.014399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:16.050815 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m11:10:16.052151 [debug] [MainThread]: On master: COMMIT
[0m11:10:16.053432 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:16.054546 [debug] [MainThread]: On master: COMMIT
[0m11:10:16.055954 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:10:16.056808 [debug] [MainThread]: On master: Close
[0m11:10:16.062251 [debug] [Thread-1 (]: Began running node model.ecomm.daily_funnel
[0m11:10:16.062539 [debug] [Thread-2 (]: Began running node model.ecomm.fct_cart_events
[0m11:10:16.062857 [debug] [Thread-3 (]: Began running node model.ecomm.fct_daily_sales
[0m11:10:16.063095 [debug] [Thread-4 (]: Began running node model.ecomm.fct_order_items
[0m11:10:16.063877 [info ] [Thread-1 (]: 1 of 10 START sql view model main_main.daily_funnel ............................ [RUN]
[0m11:10:16.064981 [info ] [Thread-2 (]: 2 of 10 START sql view model main_main.fct_cart_events ......................... [RUN]
[0m11:10:16.066089 [info ] [Thread-3 (]: 3 of 10 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m11:10:16.067269 [info ] [Thread-4 (]: 4 of 10 START sql view model main_main.fct_order_items ......................... [RUN]
[0m11:10:16.068473 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.daily_funnel'
[0m11:10:16.069577 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.fct_cart_events'
[0m11:10:16.070525 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_daily_sales'
[0m11:10:16.071704 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m11:10:16.073019 [debug] [Thread-1 (]: Began compiling node model.ecomm.daily_funnel
[0m11:10:16.074126 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_cart_events
[0m11:10:16.075270 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_daily_sales
[0m11:10:16.076401 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_order_items
[0m11:10:16.084353 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m11:10:16.128259 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m11:10:16.131244 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m11:10:16.134628 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:10:16.144696 [debug] [Thread-1 (]: Began executing node model.ecomm.daily_funnel
[0m11:10:16.145694 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_daily_sales
[0m11:10:16.146198 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_cart_events
[0m11:10:16.151649 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_order_items
[0m11:10:16.173023 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m11:10:16.174999 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m11:10:16.178913 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m11:10:16.181843 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:10:16.189389 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:10:16.190641 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:10:16.191027 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:10:16.192430 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m11:10:16.194057 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: BEGIN
[0m11:10:16.194622 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:10:16.196355 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:10:16.198253 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:10:16.199487 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:16.200600 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: BEGIN
[0m11:10:16.201595 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:10:16.204724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:10:16.239243 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m11:10:16.239625 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m11:10:16.239899 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m11:10:16.240144 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m11:10:16.241030 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:10:16.242341 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:10:16.243198 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:10:16.244205 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:10:16.245427 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:10:16.247114 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date
  );

[0m11:10:16.248291 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items
  );

[0m11:10:16.249393 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date
  );

[0m11:10:17.581090 [debug] [Thread-3 (]: SQL status: OK in 1.330 seconds
[0m11:10:17.586917 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:10:17.587316 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items
  );

[0m11:10:17.588444 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m11:10:17.589714 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:10:17.591326 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:10:17.592260 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m11:10:17.603397 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:10:17.606747 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m11:10:17.607037 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:10:17.608852 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: Close
[0m11:10:17.610266 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:10:17.613354 [debug] [Thread-4 (]: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "qty"
  
  Candidate bindings: : "sku"
  
  LINE 15:     li.qty,
               ^
[0m11:10:17.616626 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b0684550>]}
[0m11:10:17.618699 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model main_main.fct_order_items ................ [[31mERROR[0m in 1.54s]
[0m11:10:17.620362 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_order_items
[0m11:10:17.621710 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m11:10:17.622079 [debug] [Thread-4 (]: Began running node model.ecomm.fct_orders
[0m11:10:17.622420 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "qty"
  
  Candidate bindings: : "sku"
  
  LINE 15:     li.qty,
               ^.
[0m11:10:17.628807 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:10:17.630931 [info ] [Thread-4 (]: 5 of 10 START sql view model main_main.fct_orders .............................. [RUN]
[0m11:10:17.634316 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
drop view if exists "warehouse"."main_main"."fct_daily_sales__dbt_backup" cascade
[0m11:10:17.636071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.fct_orders)
[0m11:10:17.637759 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:10:17.638759 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_orders
[0m11:10:17.641601 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: Close
[0m11:10:17.644824 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m11:10:17.646567 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b07ba810>]}
[0m11:10:17.648988 [info ] [Thread-3 (]: 3 of 10 OK created sql view model main_main.fct_daily_sales .................... [[32mOK[0m in 1.58s]
[0m11:10:17.650680 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_daily_sales
[0m11:10:17.652074 [debug] [Thread-3 (]: Began running node model.ecomm.fct_sessions
[0m11:10:17.653549 [info ] [Thread-3 (]: 6 of 10 START sql view model main_main.fct_sessions ............................ [RUN]
[0m11:10:17.655040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_daily_sales, now model.ecomm.fct_sessions)
[0m11:10:17.656424 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_sessions
[0m11:10:17.659897 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m11:10:17.661585 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_orders
[0m11:10:17.665404 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m11:10:17.673115 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_sessions
[0m11:10:17.676853 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m11:10:17.678823 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:10:17.680267 [debug] [Thread-4 (]: On model.ecomm.fct_orders: BEGIN
[0m11:10:17.682617 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:10:17.684652 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:10:17.686775 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:10:17.688511 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:10:17.691497 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:10:17.692910 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: BEGIN
[0m11:10:17.694857 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:10:17.696662 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:10:17.698246 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:10:17.699804 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main"."stg_sessions"
group by session_date
order by session_date
  );

[0m11:10:19.758142 [debug] [Thread-4 (]: SQL status: OK in 2.068 seconds
[0m11:10:19.762330 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:10:19.764298 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:10:19.767116 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:10:19.769458 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m11:10:19.771312 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:10:19.773273 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m11:10:19.781509 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m11:10:19.784151 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:10:19.785566 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
drop view if exists "warehouse"."main_main"."fct_orders__dbt_backup" cascade
[0m11:10:19.787424 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:10:19.789744 [debug] [Thread-4 (]: On model.ecomm.fct_orders: Close
[0m11:10:19.792137 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b06407d0>]}
[0m11:10:19.793735 [info ] [Thread-4 (]: 5 of 10 OK created sql view model main_main.fct_orders ......................... [[32mOK[0m in 2.16s]
[0m11:10:19.795793 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_orders
[0m11:10:19.797662 [debug] [Thread-4 (]: Began running node model.ecomm.dim_sku_360
[0m11:10:19.798944 [info ] [Thread-4 (]: 7 of 10 SKIP relation main_main.dim_sku_360 .................................... [[33mSKIP[0m]
[0m11:10:19.801338 [debug] [Thread-4 (]: Finished running node model.ecomm.dim_sku_360
[0m11:10:19.802783 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_daily
[0m11:10:19.804292 [info ] [Thread-4 (]: 8 of 10 SKIP relation main_main.fct_revenue_daily .............................. [[33mSKIP[0m]
[0m11:10:19.806292 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_daily
[0m11:10:19.808605 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m11:10:19.809755 [info ] [Thread-4 (]: 9 of 10 SKIP relation main_main.fct_revenue_by_category_daily .................. [[33mSKIP[0m]
[0m11:10:19.811604 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m11:10:20.017681 [debug] [Thread-2 (]: SQL status: OK in 3.763 seconds
[0m11:10:20.021723 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:10:20.023128 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events__dbt_tmp" rename to "fct_cart_events"
[0m11:10:20.025500 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:10:20.028526 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:10:20.030288 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:10:20.032362 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:10:20.040290 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m11:10:20.043732 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:10:20.046075 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
drop view if exists "warehouse"."main_main"."fct_cart_events__dbt_backup" cascade
[0m11:10:20.049188 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:10:20.052686 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: Close
[0m11:10:20.055564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b124c5d0>]}
[0m11:10:20.058466 [info ] [Thread-2 (]: 2 of 10 OK created sql view model main_main.fct_cart_events .................... [[32mOK[0m in 3.99s]
[0m11:10:20.061076 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_cart_events
[0m11:10:29.679341 [debug] [Thread-1 (]: SQL status: OK in 13.427 seconds
[0m11:10:29.683091 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:10:29.686820 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel__dbt_tmp" rename to "daily_funnel"
[0m11:10:29.688834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:29.691309 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:10:29.692586 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:10:29.694027 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:10:29.701261 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:10:29.703618 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:10:29.704383 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
drop view if exists "warehouse"."main_main"."daily_funnel__dbt_backup" cascade
[0m11:10:29.705439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:29.706805 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: Close
[0m11:10:29.708260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b125f890>]}
[0m11:10:29.709258 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_main.daily_funnel ....................... [[32mOK[0m in 13.64s]
[0m11:10:29.710680 [debug] [Thread-1 (]: Finished running node model.ecomm.daily_funnel
[0m11:10:30.817722 [debug] [Thread-3 (]: SQL status: OK in 13.116 seconds
[0m11:10:30.822623 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:10:30.824663 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m11:10:30.827801 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:10:30.831356 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:10:30.833177 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:10:30.834833 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:10:30.842951 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m11:10:30.846776 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:10:30.848399 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
drop view if exists "warehouse"."main_main"."fct_sessions__dbt_backup" cascade
[0m11:10:30.850396 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:10:30.853103 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: Close
[0m11:10:30.877991 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b050af10>]}
[0m11:10:30.879610 [info ] [Thread-3 (]: 6 of 10 OK created sql view model main_main.fct_sessions ....................... [[32mOK[0m in 13.22s]
[0m11:10:30.881436 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_sessions
[0m11:10:30.884584 [debug] [Thread-4 (]: Began running node model.ecomm.dim_user_360
[0m11:10:30.887145 [info ] [Thread-4 (]: 10 of 10 START sql view model main_main.dim_user_360 ........................... [RUN]
[0m11:10:30.888627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.dim_user_360)
[0m11:10:30.889803 [debug] [Thread-4 (]: Began compiling node model.ecomm.dim_user_360
[0m11:10:30.893949 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.dim_user_360"
[0m11:10:30.908954 [debug] [Thread-4 (]: Began executing node model.ecomm.dim_user_360
[0m11:10:30.912884 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.dim_user_360"
[0m11:10:30.929476 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.dim_user_360"
[0m11:10:30.931492 [debug] [Thread-4 (]: On model.ecomm.dim_user_360: BEGIN
[0m11:10:30.933945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:10:30.982594 [debug] [Thread-4 (]: SQL status: OK in 0.049 seconds
[0m11:10:30.984694 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.dim_user_360"
[0m11:10:30.986530 [debug] [Thread-4 (]: On model.ecomm.dim_user_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user_360"} */

  
  create view "warehouse"."main_main"."dim_user_360__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main_main"."fct_sessions"
),
orders as (
  -- use the staging view that reads Parquet
  select user_id, total
  from "warehouse"."main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*) as total_orders,
    sum(total) as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)     as total_orders,
  coalesce(o.lifetime_value, 0.0) as lifetime_value,
  a.converting_sessions
from agg a
left join ord o using (user_id)
  );

[0m11:10:41.770422 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user_360"} */

  
  create view "warehouse"."main_main"."dim_user_360__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main_main"."fct_sessions"
),
orders as (
  -- use the staging view that reads Parquet
  select user_id, total
  from "warehouse"."main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*) as total_orders,
    sum(total) as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)     as total_orders,
  coalesce(o.lifetime_value, 0.0) as lifetime_value,
  a.converting_sessions
from agg a
left join ord o using (user_id)
  );

[0m11:10:41.773561 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:10:41.777478 [debug] [Thread-4 (]: On model.ecomm.dim_user_360: ROLLBACK
[0m11:10:41.781290 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.dim_user_360'
[0m11:10:41.783988 [debug] [Thread-4 (]: On model.ecomm.dim_user_360: Close
[0m11:10:41.790253 [debug] [Thread-4 (]: Runtime Error in model dim_user_360 (models/gold/dim_user_360.sql)
  Binder Error: Referenced column "user_id" not found in FROM clause!
  Candidate bindings: "session_date", "sessions", "conversions"
  
  LINE 8:   select user_id, session_start, session_end, conversion_flag
                   ^
[0m11:10:41.792924 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb418abd-cc38-426f-852e-e6a8217a9a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b06e8ad0>]}
[0m11:10:41.797529 [error] [Thread-4 (]: 10 of 10 ERROR creating sql view model main_main.dim_user_360 .................. [[31mERROR[0m in 10.90s]
[0m11:10:41.802361 [debug] [Thread-4 (]: Finished running node model.ecomm.dim_user_360
[0m11:10:41.805357 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.dim_user_360' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_user_360 (models/gold/dim_user_360.sql)
  Binder Error: Referenced column "user_id" not found in FROM clause!
  Candidate bindings: "session_date", "sessions", "conversions"
  
  LINE 8:   select user_id, session_start, session_end, conversion_flag
                   ^.
[0m11:10:41.809482 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:41.811440 [debug] [MainThread]: On master: BEGIN
[0m11:10:41.813900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:41.860130 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m11:10:41.862423 [debug] [MainThread]: On master: COMMIT
[0m11:10:41.864031 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:41.866925 [debug] [MainThread]: On master: COMMIT
[0m11:10:41.869763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:10:41.872286 [debug] [MainThread]: On master: Close
[0m11:10:41.877297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:41.879112 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:10:41.881248 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:10:41.882615 [debug] [MainThread]: Connection 'model.ecomm.daily_funnel' was properly closed.
[0m11:10:41.884254 [debug] [MainThread]: Connection 'model.ecomm.fct_cart_events' was properly closed.
[0m11:10:41.886712 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m11:10:41.888855 [debug] [MainThread]: Connection 'model.ecomm.dim_user_360' was properly closed.
[0m11:10:41.891138 [info ] [MainThread]: 
[0m11:10:41.893147 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 26.12 seconds (26.12s).
[0m11:10:41.896298 [debug] [MainThread]: Command end result
[0m11:10:41.949581 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:10:41.962666 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:10:41.978365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:10:41.980164 [info ] [MainThread]: 
[0m11:10:41.982579 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:10:41.984867 [info ] [MainThread]: 
[0m11:10:41.987748 [error] [MainThread]: [31mFailure in model fct_order_items (models/gold/fct_order_items.sql)[0m
[0m11:10:41.989886 [error] [MainThread]:   Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "qty"
  
  Candidate bindings: : "sku"
  
  LINE 15:     li.qty,
               ^
[0m11:10:41.991859 [info ] [MainThread]: 
[0m11:10:41.994030 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_order_items.sql
[0m11:10:41.996048 [info ] [MainThread]: 
[0m11:10:41.997661 [error] [MainThread]: [31mFailure in model dim_user_360 (models/gold/dim_user_360.sql)[0m
[0m11:10:41.999762 [error] [MainThread]:   Runtime Error in model dim_user_360 (models/gold/dim_user_360.sql)
  Binder Error: Referenced column "user_id" not found in FROM clause!
  Candidate bindings: "session_date", "sessions", "conversions"
  
  LINE 8:   select user_id, session_start, session_end, conversion_flag
                   ^
[0m11:10:42.001861 [info ] [MainThread]: 
[0m11:10:42.003816 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/dim_user_360.sql
[0m11:10:42.005777 [info ] [MainThread]: 
[0m11:10:42.008439 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=10
[0m11:10:42.011392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 26.230991, "process_in_blocks": "912", "process_kernel_time": 0.983116, "process_mem_max_rss": "215124", "process_out_blocks": "0", "process_user_time": 2.709564}
[0m11:10:42.013257 [debug] [MainThread]: Command `dbt run` failed at 11:10:42.013134 after 26.23 seconds
[0m11:10:42.015247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b0897a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ba071050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56b0642790>]}
[0m11:10:42.017978 [debug] [MainThread]: Flushing usage events
[0m11:10:43.166596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:35.373251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf0319790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf030e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf0371490>]}


============================== 11:11:35.376918 | bb6260f2-e27d-445d-baf5-9bb9974da489 ==============================
[0m11:11:35.376918 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:11:35.378515 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/usr/app', 'invocation_command': 'dbt run -s models/gold', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'empty': 'False'}
[0m11:11:35.526279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf034dbd0>]}
[0m11:11:35.570698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf2f30590>]}
[0m11:11:35.572573 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:11:35.614761 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:11:36.126236 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:11:36.127436 [debug] [MainThread]: Partial parsing: added file: ecomm://models/gold/dim_user.sql
[0m11:11:36.128664 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_user_360.sql
[0m11:11:36.323961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cebe16910>]}
[0m11:11:36.392887 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:11:36.406405 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:11:36.468603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cec0fbdd0>]}
[0m11:11:36.470142 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:11:36.471876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce9d53d10>]}
[0m11:11:36.484258 [info ] [MainThread]: 
[0m11:11:36.486429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:36.487805 [info ] [MainThread]: 
[0m11:11:36.489639 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:11:36.495234 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:11:36.522466 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:11:36.523935 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:11:36.524825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:36.567201 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m11:11:36.569741 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:11:36.575859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:11:36.577565 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:11:36.583538 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:11:36.584973 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:11:36.586004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:36.620812 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:11:36.624061 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:11:36.625451 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:11:36.627177 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:36.628342 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:11:36.629879 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:11:36.631422 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:36.633212 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:11:36.634728 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:11:36.635938 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:11:36.637572 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:36.639096 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:11:36.644629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m11:11:36.645118 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m11:11:36.649856 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:11:36.652198 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:11:36.653520 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:11:36.654832 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:11:36.656026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:36.657250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:36.691743 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m11:11:36.692063 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:11:36.693585 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:11:36.694911 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:11:36.696033 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:11:36.697296 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:11:36.704635 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:11:36.705008 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:11:36.706908 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:11:36.708485 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:11:36.709845 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:11:36.710746 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:11:36.711692 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:11:36.712805 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:11:36.719031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cebe54790>]}
[0m11:11:36.720485 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:36.721733 [debug] [MainThread]: On master: BEGIN
[0m11:11:36.722837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:36.754896 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m11:11:36.757041 [debug] [MainThread]: On master: COMMIT
[0m11:11:36.758485 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:36.760216 [debug] [MainThread]: On master: COMMIT
[0m11:11:36.762157 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:11:36.763460 [debug] [MainThread]: On master: Close
[0m11:11:36.768932 [debug] [Thread-1 (]: Began running node model.ecomm.daily_funnel
[0m11:11:36.769203 [debug] [Thread-2 (]: Began running node model.ecomm.fct_cart_events
[0m11:11:36.769459 [debug] [Thread-3 (]: Began running node model.ecomm.fct_daily_sales
[0m11:11:36.769775 [debug] [Thread-4 (]: Began running node model.ecomm.fct_order_items
[0m11:11:36.770755 [info ] [Thread-1 (]: 1 of 10 START sql view model main_main.daily_funnel ............................ [RUN]
[0m11:11:36.772344 [info ] [Thread-2 (]: 2 of 10 START sql view model main_main.fct_cart_events ......................... [RUN]
[0m11:11:36.773652 [info ] [Thread-3 (]: 3 of 10 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m11:11:36.775168 [info ] [Thread-4 (]: 4 of 10 START sql view model main_main.fct_order_items ......................... [RUN]
[0m11:11:36.776648 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.daily_funnel'
[0m11:11:36.777991 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.fct_cart_events'
[0m11:11:36.779267 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_daily_sales'
[0m11:11:36.780580 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m11:11:36.781665 [debug] [Thread-1 (]: Began compiling node model.ecomm.daily_funnel
[0m11:11:36.782830 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_cart_events
[0m11:11:36.783948 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_daily_sales
[0m11:11:36.785265 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_order_items
[0m11:11:36.792427 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m11:11:36.795954 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m11:11:36.798991 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m11:11:36.801563 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:11:36.810335 [debug] [Thread-1 (]: Began executing node model.ecomm.daily_funnel
[0m11:11:36.811339 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_order_items
[0m11:11:36.817304 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_daily_sales
[0m11:11:36.835085 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m11:11:36.835422 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_cart_events
[0m11:11:36.837855 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:11:36.841481 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m11:11:36.846211 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m11:11:36.853992 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:11:36.855662 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:11:36.856071 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: BEGIN
[0m11:11:36.856367 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:11:36.857670 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:11:36.859949 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m11:11:36.866419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:11:36.867524 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: BEGIN
[0m11:11:36.868498 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:11:36.869743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:11:36.872339 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:11:36.873748 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:11:36.906494 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m11:11:36.906963 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m11:11:36.908510 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m11:11:36.908815 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:11:36.909482 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m11:11:36.910233 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:11:36.911532 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:11:36.912859 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date
  );

[0m11:11:36.914095 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:11:36.915599 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date
  );

[0m11:11:36.916852 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items
  );

[0m11:11:36.919298 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:11:38.236316 [debug] [Thread-3 (]: SQL status: OK in 1.313 seconds
[0m11:11:38.236775 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with items as (
  select
    o.event_id,
    o.order_id,
    o.user_id,
    o.ts,
    o.event_date,
    li.sku,
    li.qty,
    li.price,
    (li.qty * li.price) as line_amount
  from "warehouse"."main"."stg_order_placed" o
  cross join unnest(o.line_items) as li(sku, qty, price)
)
select * from items
  );

[0m11:11:38.242174 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:11:38.243742 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:11:38.245021 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m11:11:38.246353 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m11:11:38.248159 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:11:38.253304 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:11:38.254757 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m11:11:38.255267 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m11:11:38.256607 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: Close
[0m11:11:38.258369 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:11:38.260330 [debug] [Thread-4 (]: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "qty"
  
  Candidate bindings: : "sku"
  
  LINE 15:     li.qty,
               ^
[0m11:11:38.272427 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:11:38.274096 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cebfbdb90>]}
[0m11:11:38.275102 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:11:38.276823 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model main_main.fct_order_items ................ [[31mERROR[0m in 1.49s]
[0m11:11:38.277954 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:11:38.279221 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_order_items
[0m11:11:38.281716 [debug] [Thread-4 (]: Began running node model.ecomm.fct_orders
[0m11:11:38.282130 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "qty"
  
  Candidate bindings: : "sku"
  
  LINE 15:     li.qty,
               ^.
[0m11:11:38.283854 [info ] [Thread-4 (]: 5 of 10 START sql view model main_main.fct_orders .............................. [RUN]
[0m11:11:38.287322 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.fct_orders)
[0m11:11:38.288435 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m11:11:38.288724 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_orders
[0m11:11:38.294816 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:11:38.298603 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m11:11:38.300355 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
drop view if exists "warehouse"."main_main"."fct_daily_sales__dbt_backup" cascade
[0m11:11:38.305363 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:11:38.308441 [debug] [Thread-3 (]: On model.ecomm.fct_daily_sales: Close
[0m11:11:38.310044 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce8103cd0>]}
[0m11:11:38.311526 [info ] [Thread-3 (]: 3 of 10 OK created sql view model main_main.fct_daily_sales .................... [[32mOK[0m in 1.53s]
[0m11:11:38.312136 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_orders
[0m11:11:38.313119 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_daily_sales
[0m11:11:38.316922 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m11:11:38.318280 [debug] [Thread-3 (]: Began running node model.ecomm.fct_sessions
[0m11:11:38.320833 [info ] [Thread-3 (]: 6 of 10 START sql view model main_main.fct_sessions ............................ [RUN]
[0m11:11:38.322003 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_daily_sales, now model.ecomm.fct_sessions)
[0m11:11:38.323118 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_sessions
[0m11:11:38.326386 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m11:11:38.330861 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:11:38.332063 [debug] [Thread-4 (]: On model.ecomm.fct_orders: BEGIN
[0m11:11:38.333576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:11:38.335430 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:11:38.336390 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:11:38.337712 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:11:38.338460 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_sessions
[0m11:11:38.343373 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m11:11:38.361326 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:11:38.362626 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: BEGIN
[0m11:11:38.364063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:11:38.366405 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:11:38.368081 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:11:38.369566 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main"."stg_sessions"
group by session_date
order by session_date
  );

[0m11:11:41.912693 [debug] [Thread-4 (]: SQL status: OK in 2.264 seconds
[0m11:11:41.917578 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:11:41.919188 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:11:41.922844 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:11:41.927697 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:11:41.930193 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:11:41.933119 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:11:41.936835 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m11:11:41.940309 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:11:41.943311 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m11:11:41.954944 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m11:11:41.960049 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:11:41.963769 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
drop view if exists "warehouse"."main_main"."fct_orders__dbt_backup" cascade
[0m11:11:41.970148 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:11:41.973104 [debug] [Thread-4 (]: On model.ecomm.fct_orders: Close
[0m11:11:41.975288 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce93ac050>]}
[0m11:11:41.977852 [info ] [Thread-4 (]: 5 of 10 OK created sql view model main_main.fct_orders ......................... [[32mOK[0m in 3.69s]
[0m11:11:41.980323 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_orders
[0m11:11:41.982829 [debug] [Thread-4 (]: Began running node model.ecomm.dim_sku_360
[0m11:11:41.984859 [info ] [Thread-4 (]: 7 of 10 SKIP relation main_main.dim_sku_360 .................................... [[33mSKIP[0m]
[0m11:11:41.987093 [debug] [Thread-4 (]: Finished running node model.ecomm.dim_sku_360
[0m11:11:41.989233 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_daily
[0m11:11:41.991763 [info ] [Thread-4 (]: 8 of 10 SKIP relation main_main.fct_revenue_daily .............................. [[33mSKIP[0m]
[0m11:11:41.993844 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_daily
[0m11:11:41.995845 [debug] [Thread-4 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m11:11:41.998394 [info ] [Thread-4 (]: 9 of 10 SKIP relation main_main.fct_revenue_by_category_daily .................. [[33mSKIP[0m]
[0m11:11:42.000371 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m11:11:42.369952 [debug] [Thread-2 (]: SQL status: OK in 4.140 seconds
[0m11:11:42.375718 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:11:42.377982 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events" rename to "fct_cart_events__dbt_backup"
[0m11:11:42.382862 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:11:42.387589 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:11:42.390648 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events__dbt_tmp" rename to "fct_cart_events"
[0m11:11:42.393578 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:11:42.396816 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:11:42.399014 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:11:42.401146 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:11:42.409833 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m11:11:42.414174 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:11:42.416354 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
drop view if exists "warehouse"."main_main"."fct_cart_events__dbt_backup" cascade
[0m11:11:42.424009 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m11:11:42.427615 [debug] [Thread-2 (]: On model.ecomm.fct_cart_events: Close
[0m11:11:42.429802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce93a7a10>]}
[0m11:11:42.433071 [info ] [Thread-2 (]: 2 of 10 OK created sql view model main_main.fct_cart_events .................... [[32mOK[0m in 5.65s]
[0m11:11:42.436177 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_cart_events
[0m11:11:52.946309 [debug] [Thread-1 (]: SQL status: OK in 14.718 seconds
[0m11:11:52.952365 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:11:52.955279 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel" rename to "daily_funnel__dbt_backup"
[0m11:11:52.958560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:11:52.963212 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:11:52.966952 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel__dbt_tmp" rename to "daily_funnel"
[0m11:11:52.969684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:11:52.973165 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:11:52.976175 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:11:52.979327 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:11:52.990382 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:11:52.995033 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:11:52.998187 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
drop view if exists "warehouse"."main_main"."daily_funnel__dbt_backup" cascade
[0m11:11:53.004348 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:11:53.007846 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: Close
[0m11:11:53.010727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c9d6f8c10>]}
[0m11:11:53.013844 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_main.daily_funnel ....................... [[32mOK[0m in 16.23s]
[0m11:11:53.016570 [debug] [Thread-1 (]: Finished running node model.ecomm.daily_funnel
[0m11:11:55.050653 [debug] [Thread-3 (]: SQL status: OK in 15.370 seconds
[0m11:11:55.054309 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:11:55.055548 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions" rename to "fct_sessions__dbt_backup"
[0m11:11:55.057355 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:11:55.060232 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:11:55.061516 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m11:11:55.063686 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:11:55.065771 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:11:55.067067 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:11:55.068719 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:11:55.075549 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:11:55.078628 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:11:55.079652 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
drop view if exists "warehouse"."main_main"."fct_sessions__dbt_backup" cascade
[0m11:11:55.082026 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:11:55.083283 [debug] [Thread-3 (]: On model.ecomm.fct_sessions: Close
[0m11:11:55.097840 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce93c5d50>]}
[0m11:11:55.100918 [info ] [Thread-3 (]: 6 of 10 OK created sql view model main_main.fct_sessions ....................... [[32mOK[0m in 16.78s]
[0m11:11:55.102727 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_sessions
[0m11:11:55.104891 [debug] [Thread-4 (]: Began running node model.ecomm.dim_user
[0m11:11:55.106496 [info ] [Thread-4 (]: 10 of 10 START sql view model main_main.dim_user ............................... [RUN]
[0m11:11:55.107879 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.dim_user)
[0m11:11:55.109679 [debug] [Thread-4 (]: Began compiling node model.ecomm.dim_user
[0m11:11:55.113771 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m11:11:55.127788 [debug] [Thread-4 (]: Began executing node model.ecomm.dim_user
[0m11:11:55.131365 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m11:11:55.144761 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:11:55.146274 [debug] [Thread-4 (]: On model.ecomm.dim_user: BEGIN
[0m11:11:55.147551 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:11:55.185712 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m11:11:55.187186 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:11:55.188314 [debug] [Thread-4 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
  create view "warehouse"."main_main"."dim_user__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main_main"."fct_sessions"
),
orders as (
  -- use the staging view that reads Parquet
  select user_id, total
  from "warehouse"."main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*) as total_orders,
    sum(total) as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)     as total_orders,
  coalesce(o.lifetime_value, 0.0) as lifetime_value,
  a.converting_sessions
from agg a
left join ord o using (user_id)
  );

[0m11:12:04.268772 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
  create view "warehouse"."main_main"."dim_user__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main_main"."fct_sessions"
),
orders as (
  -- use the staging view that reads Parquet
  select user_id, total
  from "warehouse"."main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*) as total_orders,
    sum(total) as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)     as total_orders,
  coalesce(o.lifetime_value, 0.0) as lifetime_value,
  a.converting_sessions
from agg a
left join ord o using (user_id)
  );

[0m11:12:04.270124 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:12:04.271782 [debug] [Thread-4 (]: On model.ecomm.dim_user: ROLLBACK
[0m11:12:04.277684 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.dim_user'
[0m11:12:04.280172 [debug] [Thread-4 (]: On model.ecomm.dim_user: Close
[0m11:12:04.289105 [debug] [Thread-4 (]: Runtime Error in model dim_user (models/gold/dim_user.sql)
  Binder Error: Referenced column "user_id" not found in FROM clause!
  Candidate bindings: "session_date", "sessions", "conversions"
  
  LINE 8:   select user_id, session_start, session_end, conversion_flag
                   ^
[0m11:12:04.290967 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6260f2-e27d-445d-baf5-9bb9974da489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce9272610>]}
[0m11:12:04.292822 [error] [Thread-4 (]: 10 of 10 ERROR creating sql view model main_main.dim_user ...................... [[31mERROR[0m in 9.18s]
[0m11:12:04.295209 [debug] [Thread-4 (]: Finished running node model.ecomm.dim_user
[0m11:12:04.296970 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.dim_user' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_user (models/gold/dim_user.sql)
  Binder Error: Referenced column "user_id" not found in FROM clause!
  Candidate bindings: "session_date", "sessions", "conversions"
  
  LINE 8:   select user_id, session_start, session_end, conversion_flag
                   ^.
[0m11:12:04.299482 [debug] [MainThread]: Using duckdb connection "master"
[0m11:12:04.300900 [debug] [MainThread]: On master: BEGIN
[0m11:12:04.302197 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:04.341973 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m11:12:04.343417 [debug] [MainThread]: On master: COMMIT
[0m11:12:04.344934 [debug] [MainThread]: Using duckdb connection "master"
[0m11:12:04.346001 [debug] [MainThread]: On master: COMMIT
[0m11:12:04.347763 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:12:04.348786 [debug] [MainThread]: On master: Close
[0m11:12:04.352187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:04.353530 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:12:04.354536 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:12:04.355561 [debug] [MainThread]: Connection 'model.ecomm.daily_funnel' was properly closed.
[0m11:12:04.356305 [debug] [MainThread]: Connection 'model.ecomm.fct_cart_events' was properly closed.
[0m11:12:04.357191 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m11:12:04.358091 [debug] [MainThread]: Connection 'model.ecomm.dim_user' was properly closed.
[0m11:12:04.359391 [info ] [MainThread]: 
[0m11:12:04.360948 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 27.87 seconds (27.87s).
[0m11:12:04.362991 [debug] [MainThread]: Command end result
[0m11:12:04.401314 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:12:04.408032 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:12:04.420010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:12:04.421461 [info ] [MainThread]: 
[0m11:12:04.422610 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:12:04.424004 [info ] [MainThread]: 
[0m11:12:04.425709 [error] [MainThread]: [31mFailure in model fct_order_items (models/gold/fct_order_items.sql)[0m
[0m11:12:04.427018 [error] [MainThread]:   Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "qty"
  
  Candidate bindings: : "sku"
  
  LINE 15:     li.qty,
               ^
[0m11:12:04.428404 [info ] [MainThread]: 
[0m11:12:04.430060 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_order_items.sql
[0m11:12:04.431625 [info ] [MainThread]: 
[0m11:12:04.433201 [error] [MainThread]: [31mFailure in model dim_user (models/gold/dim_user.sql)[0m
[0m11:12:04.434383 [error] [MainThread]:   Runtime Error in model dim_user (models/gold/dim_user.sql)
  Binder Error: Referenced column "user_id" not found in FROM clause!
  Candidate bindings: "session_date", "sessions", "conversions"
  
  LINE 8:   select user_id, session_start, session_end, conversion_flag
                   ^
[0m11:12:04.435225 [info ] [MainThread]: 
[0m11:12:04.436258 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/dim_user.sql
[0m11:12:04.437287 [info ] [MainThread]: 
[0m11:12:04.438902 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=10
[0m11:12:04.440617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 27.821096, "process_in_blocks": "0", "process_kernel_time": 1.073975, "process_mem_max_rss": "222592", "process_out_blocks": "0", "process_user_time": 2.918787}
[0m11:12:04.441716 [debug] [MainThread]: Command `dbt run` failed at 11:12:04.441611 after 27.82 seconds
[0m11:12:04.443003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf4d1d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf0381810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf4ba9090>]}
[0m11:12:04.444313 [debug] [MainThread]: Flushing usage events
[0m11:12:05.855733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:36.002981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbefa8eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbefa81f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbefae5250>]}


============================== 11:15:36.011455 | 0fbf910a-7358-4180-b656-02649f2bde6f ==============================
[0m11:15:36.011455 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:15:36.023347 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -s models/gold', 'write_json': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True'}
[0m11:15:36.255217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbef92cc50>]}
[0m11:15:36.323284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbf26a87d0>]}
[0m11:15:36.327115 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:15:36.375934 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:15:37.068084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:15:37.070084 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_order_items.sql
[0m11:15:37.072009 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/dim_user.sql
[0m11:15:37.371884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe9441750>]}
[0m11:15:37.521465 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:15:37.533183 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:15:37.565259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe945ef10>]}
[0m11:15:37.570743 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:15:37.572889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe9430410>]}
[0m11:15:37.580725 [info ] [MainThread]: 
[0m11:15:37.582602 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:37.584499 [info ] [MainThread]: 
[0m11:15:37.586444 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:15:37.592541 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:15:37.621595 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:15:37.623220 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:15:37.624732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:37.676112 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m11:15:37.679040 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:15:37.686629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:15:37.688568 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:15:37.694929 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:15:37.696585 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:15:37.698139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:37.734126 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m11:15:37.737559 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:15:37.739469 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:15:37.741932 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:15:37.743796 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:15:37.745394 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:15:37.747350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:15:37.749668 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:15:37.751247 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:15:37.752780 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:15:37.754498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:15:37.755946 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:15:37.761486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main)
[0m11:15:37.761986 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_main'
[0m11:15:37.766627 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:15:37.770745 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:15:37.772954 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:15:37.774709 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:15:37.776003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:37.777228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:37.814414 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m11:15:37.815202 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m11:15:37.816595 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:15:37.818175 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:15:37.819855 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:15:37.821131 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:15:37.830245 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:15:37.830584 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:15:37.835213 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:15:37.838962 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:15:37.840663 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:15:37.841830 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:15:37.842662 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:15:37.843948 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:15:37.851065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe890ebd0>]}
[0m11:15:37.852506 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:37.853806 [debug] [MainThread]: On master: BEGIN
[0m11:15:37.855034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:37.902982 [debug] [MainThread]: SQL status: OK in 0.048 seconds
[0m11:15:37.905778 [debug] [MainThread]: On master: COMMIT
[0m11:15:37.908203 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:37.910225 [debug] [MainThread]: On master: COMMIT
[0m11:15:37.914986 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:15:37.916749 [debug] [MainThread]: On master: Close
[0m11:15:37.930201 [debug] [Thread-1 (]: Began running node model.ecomm.daily_funnel
[0m11:15:37.930955 [debug] [Thread-2 (]: Began running node model.ecomm.dim_user
[0m11:15:37.931593 [debug] [Thread-3 (]: Began running node model.ecomm.fct_cart_events
[0m11:15:37.931930 [debug] [Thread-4 (]: Began running node model.ecomm.fct_daily_sales
[0m11:15:37.934590 [info ] [Thread-1 (]: 1 of 10 START sql view model main_main.daily_funnel ............................ [RUN]
[0m11:15:37.939038 [info ] [Thread-2 (]: 2 of 10 START sql view model main_main.dim_user ................................ [RUN]
[0m11:15:37.942624 [info ] [Thread-3 (]: 3 of 10 START sql view model main_main.fct_cart_events ......................... [RUN]
[0m11:15:37.945281 [info ] [Thread-4 (]: 4 of 10 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m11:15:37.949044 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.daily_funnel'
[0m11:15:37.951677 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.dim_user'
[0m11:15:37.954678 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_cart_events'
[0m11:15:37.957235 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_daily_sales'
[0m11:15:37.960264 [debug] [Thread-1 (]: Began compiling node model.ecomm.daily_funnel
[0m11:15:37.963948 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_user
[0m11:15:37.970133 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_cart_events
[0m11:15:37.972506 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_daily_sales
[0m11:15:37.983594 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m11:15:37.988435 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m11:15:37.994533 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m11:15:37.999206 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m11:15:38.015429 [debug] [Thread-1 (]: Began executing node model.ecomm.daily_funnel
[0m11:15:38.018059 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_cart_events
[0m11:15:38.019285 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_user
[0m11:15:38.025021 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_daily_sales
[0m11:15:38.052978 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m11:15:38.053394 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m11:15:38.057194 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m11:15:38.061599 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m11:15:38.071842 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:15:38.072853 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:15:38.073722 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:15:38.074007 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: BEGIN
[0m11:15:38.075360 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m11:15:38.075685 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:15:38.076836 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: BEGIN
[0m11:15:38.078465 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:15:38.080010 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:15:38.081418 [debug] [Thread-2 (]: On model.ecomm.dim_user: BEGIN
[0m11:15:38.082607 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:15:38.087041 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:15:38.122365 [debug] [Thread-4 (]: SQL status: OK in 0.042 seconds
[0m11:15:38.122960 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m11:15:38.123516 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m11:15:38.124454 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m11:15:38.125125 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:15:38.126795 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:15:38.128199 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:15:38.129481 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:15:38.130851 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:15:38.132627 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date
  );

[0m11:15:38.134161 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date
  );

[0m11:15:38.135606 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
  create view "warehouse"."main_main"."dim_user__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main"."stg_sessions"
),
orders as (
  select user_id, total
  from "warehouse"."main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*)    as total_orders,
    sum(total)  as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)    as total_orders,
  coalesce(o.lifetime_value, 0)  as lifetime_value,
  a.converting_sessions
from agg a
left join ord o on a.user_id = o.user_id
  );

[0m11:15:40.577884 [debug] [Thread-4 (]: SQL status: OK in 2.441 seconds
[0m11:15:40.587951 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:15:40.591594 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m11:15:40.594133 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:15:40.600390 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:15:40.603356 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m11:15:40.608279 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:15:40.623762 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:15:40.626330 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:15:40.628976 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:15:40.646103 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m11:15:40.654008 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:15:40.658121 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
drop view if exists "warehouse"."main_main"."fct_daily_sales__dbt_backup" cascade
[0m11:15:40.667394 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m11:15:40.674393 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: Close
[0m11:15:40.680160 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbeb941ad0>]}
[0m11:15:40.683825 [info ] [Thread-4 (]: 4 of 10 OK created sql view model main_main.fct_daily_sales .................... [[32mOK[0m in 2.72s]
[0m11:15:40.688367 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_daily_sales
[0m11:15:40.692074 [debug] [Thread-4 (]: Began running node model.ecomm.fct_order_items
[0m11:15:40.695627 [info ] [Thread-4 (]: 5 of 10 START sql view model main_main.fct_order_items ......................... [RUN]
[0m11:15:40.699714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_daily_sales, now model.ecomm.fct_order_items)
[0m11:15:40.704136 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_order_items
[0m11:15:40.714517 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:15:40.758170 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_order_items
[0m11:15:40.766803 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:15:40.818688 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:15:40.824788 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:15:40.833752 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:15:40.837854 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:15:40.842023 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:15:40.846919 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  li_sku    as sku,
  li_qty    as qty,
  li_price  as price,
  li_qty * li_price as line_total
from orders o
cross join unnest(o.line_items) as u(li_sku, li_qty, li_price)
  );

[0m11:15:44.257857 [debug] [Thread-3 (]: SQL status: OK in 6.119 seconds
[0m11:15:44.263703 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:15:44.267545 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events" rename to "fct_cart_events__dbt_backup"
[0m11:15:44.271223 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:15:44.276578 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:15:44.281742 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events__dbt_tmp" rename to "fct_cart_events"
[0m11:15:44.286610 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:15:44.289920 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:15:44.293792 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:15:44.295553 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:15:44.307966 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m11:15:44.312758 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:15:44.315746 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
drop view if exists "warehouse"."main_main"."fct_cart_events__dbt_backup" cascade
[0m11:15:44.324224 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m11:15:44.327543 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: Close
[0m11:15:44.331358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe88f3ed0>]}
[0m11:15:44.333650 [info ] [Thread-3 (]: 3 of 10 OK created sql view model main_main.fct_cart_events .................... [[32mOK[0m in 6.38s]
[0m11:15:44.335978 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_cart_events
[0m11:15:44.337575 [debug] [Thread-3 (]: Began running node model.ecomm.fct_orders
[0m11:15:44.339670 [info ] [Thread-3 (]: 6 of 10 START sql view model main_main.fct_orders .............................. [RUN]
[0m11:15:44.341771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_cart_events, now model.ecomm.fct_orders)
[0m11:15:44.343655 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_orders
[0m11:15:44.348450 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m11:15:44.371726 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_orders
[0m11:15:44.377577 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m11:15:44.404681 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:15:44.408533 [debug] [Thread-3 (]: On model.ecomm.fct_orders: BEGIN
[0m11:15:44.411122 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:15:44.414698 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:15:44.417274 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:15:44.420544 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:15:44.739264 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  li_sku    as sku,
  li_qty    as qty,
  li_price  as price,
  li_qty * li_price as line_total
from orders o
cross join unnest(o.line_items) as u(li_sku, li_qty, li_price)
  );

[0m11:15:44.743348 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m11:15:44.746577 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m11:15:44.752811 [debug] [Thread-4 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m11:15:44.756825 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: Close
[0m11:15:44.761978 [debug] [Thread-4 (]: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Referenced column "li_qty" not found in FROM clause!
  Candidate bindings: "line_items", "li_sku"
  
  LINE 18:   li_qty    as qty,
             ^
[0m11:15:44.765220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe8955150>]}
[0m11:15:44.769517 [error] [Thread-4 (]: 5 of 10 ERROR creating sql view model main_main.fct_order_items ................ [[31mERROR[0m in 4.07s]
[0m11:15:44.772200 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_order_items
[0m11:15:44.775108 [debug] [Thread-4 (]: Began running node model.ecomm.fct_sessions
[0m11:15:44.775531 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Referenced column "li_qty" not found in FROM clause!
  Candidate bindings: "line_items", "li_sku"
  
  LINE 18:   li_qty    as qty,
             ^.
[0m11:15:44.778990 [info ] [Thread-4 (]: 7 of 10 START sql view model main_main.fct_sessions ............................ [RUN]
[0m11:15:44.784541 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.fct_sessions)
[0m11:15:44.787269 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_sessions
[0m11:15:44.792939 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m11:15:44.819934 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_sessions
[0m11:15:44.824941 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m11:15:44.856961 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:15:44.860164 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: BEGIN
[0m11:15:44.862002 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:15:44.865387 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:15:44.868270 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:15:44.870803 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main"."stg_sessions"
group by session_date
order by session_date
  );

[0m11:15:47.583718 [debug] [Thread-3 (]: SQL status: OK in 3.161 seconds
[0m11:15:47.587482 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:15:47.589205 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:15:47.592271 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:15:47.596985 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:15:47.598982 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:15:47.600732 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:15:47.602677 [debug] [Thread-3 (]: On model.ecomm.fct_orders: COMMIT
[0m11:15:47.604453 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:15:47.606172 [debug] [Thread-3 (]: On model.ecomm.fct_orders: COMMIT
[0m11:15:47.612032 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:15:47.615284 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:15:47.616990 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
drop view if exists "warehouse"."main_main"."fct_orders__dbt_backup" cascade
[0m11:15:47.622071 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:15:47.624319 [debug] [Thread-3 (]: On model.ecomm.fct_orders: Close
[0m11:15:47.626316 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe8762810>]}
[0m11:15:47.627848 [info ] [Thread-3 (]: 6 of 10 OK created sql view model main_main.fct_orders ......................... [[32mOK[0m in 3.28s]
[0m11:15:47.629730 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_orders
[0m11:15:47.631200 [debug] [Thread-3 (]: Began running node model.ecomm.dim_sku_360
[0m11:15:47.632581 [info ] [Thread-3 (]: 8 of 10 SKIP relation main_main.dim_sku_360 .................................... [[33mSKIP[0m]
[0m11:15:47.634539 [debug] [Thread-3 (]: Finished running node model.ecomm.dim_sku_360
[0m11:15:47.636278 [debug] [Thread-3 (]: Began running node model.ecomm.fct_revenue_daily
[0m11:15:47.637595 [info ] [Thread-3 (]: 9 of 10 SKIP relation main_main.fct_revenue_daily .............................. [[33mSKIP[0m]
[0m11:15:47.639085 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_revenue_daily
[0m11:15:47.640805 [debug] [Thread-3 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m11:15:47.642045 [info ] [Thread-3 (]: 10 of 10 SKIP relation main_main.fct_revenue_by_category_daily ................. [[33mSKIP[0m]
[0m11:15:47.643552 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m11:15:49.559853 [debug] [Thread-1 (]: SQL status: OK in 11.420 seconds
[0m11:15:49.563885 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:15:49.565794 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel" rename to "daily_funnel__dbt_backup"
[0m11:15:49.567794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:15:49.571555 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:15:49.573321 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel__dbt_tmp" rename to "daily_funnel"
[0m11:15:49.575282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:15:49.577749 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:15:49.579357 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:15:49.581167 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:15:49.589726 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:15:49.593684 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:15:49.595481 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
drop view if exists "warehouse"."main_main"."daily_funnel__dbt_backup" cascade
[0m11:15:49.600461 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:15:49.602670 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: Close
[0m11:15:49.607189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe8a8da90>]}
[0m11:15:49.609632 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_main.daily_funnel ....................... [[32mOK[0m in 11.66s]
[0m11:15:49.611679 [debug] [Thread-1 (]: Finished running node model.ecomm.daily_funnel
[0m11:15:53.658591 [debug] [Thread-2 (]: SQL status: OK in 14.151 seconds
[0m11:15:53.662382 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:15:53.664924 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter table "warehouse"."main_main"."dim_user" rename to "dim_user__dbt_backup"
[0m11:15:53.668149 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:15:53.673115 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:15:53.675696 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter view "warehouse"."main_main"."dim_user__dbt_tmp" rename to "dim_user"
[0m11:15:53.680566 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:15:53.684837 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m11:15:53.688520 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:15:53.693007 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m11:15:53.701001 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m11:15:53.705746 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:15:53.708418 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
drop table if exists "warehouse"."main_main"."dim_user__dbt_backup" cascade
[0m11:15:53.715227 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m11:15:53.718436 [debug] [Thread-2 (]: On model.ecomm.dim_user: Close
[0m11:15:53.723877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe88f3dd0>]}
[0m11:15:53.726919 [info ] [Thread-2 (]: 2 of 10 OK created sql view model main_main.dim_user ........................... [[32mOK[0m in 15.77s]
[0m11:15:53.729450 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_user
[0m11:15:58.863772 [debug] [Thread-4 (]: SQL status: OK in 12.624 seconds
[0m11:15:58.866866 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:15:58.867747 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions" rename to "fct_sessions__dbt_backup"
[0m11:15:58.869541 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:15:58.871921 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:15:58.872575 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m11:15:58.873761 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:15:58.875443 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:15:58.876112 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:15:58.876672 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:15:58.891333 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m11:15:58.893772 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:15:58.894685 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
drop view if exists "warehouse"."main_main"."fct_sessions__dbt_backup" cascade
[0m11:15:58.896824 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:15:58.898262 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: Close
[0m11:15:58.907745 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf910a-7358-4180-b656-02649f2bde6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbe896fb50>]}
[0m11:15:58.909237 [info ] [Thread-4 (]: 7 of 10 OK created sql view model main_main.fct_sessions ....................... [[32mOK[0m in 14.12s]
[0m11:15:58.910558 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_sessions
[0m11:15:58.912831 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:58.913697 [debug] [MainThread]: On master: BEGIN
[0m11:15:58.914378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:58.946157 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m11:15:58.947858 [debug] [MainThread]: On master: COMMIT
[0m11:15:58.949861 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:58.951804 [debug] [MainThread]: On master: COMMIT
[0m11:15:58.953863 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:15:58.955454 [debug] [MainThread]: On master: Close
[0m11:15:58.959802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:58.961522 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:15:58.963012 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:15:58.964524 [debug] [MainThread]: Connection 'model.ecomm.daily_funnel' was properly closed.
[0m11:15:58.965898 [debug] [MainThread]: Connection 'model.ecomm.dim_user' was properly closed.
[0m11:15:58.967339 [debug] [MainThread]: Connection 'model.ecomm.fct_orders' was properly closed.
[0m11:15:58.968938 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m11:15:58.970532 [info ] [MainThread]: 
[0m11:15:58.972123 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 21.38 seconds (21.38s).
[0m11:15:58.974302 [debug] [MainThread]: Command end result
[0m11:15:59.008069 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:15:59.013156 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:15:59.028616 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:15:59.029491 [info ] [MainThread]: 
[0m11:15:59.030972 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:15:59.032423 [info ] [MainThread]: 
[0m11:15:59.033975 [error] [MainThread]: [31mFailure in model fct_order_items (models/gold/fct_order_items.sql)[0m
[0m11:15:59.035719 [error] [MainThread]:   Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Referenced column "li_qty" not found in FROM clause!
  Candidate bindings: "line_items", "li_sku"
  
  LINE 18:   li_qty    as qty,
             ^
[0m11:15:59.037012 [info ] [MainThread]: 
[0m11:15:59.038082 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_order_items.sql
[0m11:15:59.039439 [info ] [MainThread]: 
[0m11:15:59.041362 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=10
[0m11:15:59.043469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.866014, "process_in_blocks": "0", "process_kernel_time": 1.13404, "process_mem_max_rss": "214036", "process_out_blocks": "0", "process_user_time": 2.994575}
[0m11:15:59.044636 [debug] [MainThread]: Command `dbt run` failed at 11:15:59.044550 after 21.87 seconds
[0m11:15:59.045734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbf267a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbf4310610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbefa8f650>]}
[0m11:15:59.046752 [debug] [MainThread]: Flushing usage events
[0m11:16:00.311512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:28.627542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5883191210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58831e9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58831860d0>]}


============================== 11:17:28.633029 | 1623f4f2-d728-4366-8ef2-f40493c0f256 ==============================
[0m11:17:28.633029 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:17:28.636912 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/usr/app', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -s models/gold/fct_order_items.sql', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'printer_width': '80'}
[0m11:17:28.825994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1623f4f2-d728-4366-8ef2-f40493c0f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58830685d0>]}
[0m11:17:28.872679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1623f4f2-d728-4366-8ef2-f40493c0f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5885d79a10>]}
[0m11:17:28.874479 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:17:28.917794 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:17:29.281226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:17:29.282413 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_order_items.sql
[0m11:17:29.525948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1623f4f2-d728-4366-8ef2-f40493c0f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587ec0bb10>]}
[0m11:17:29.656839 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:17:29.663170 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:17:29.685579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1623f4f2-d728-4366-8ef2-f40493c0f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587cb38e50>]}
[0m11:17:29.687457 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:17:29.689218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1623f4f2-d728-4366-8ef2-f40493c0f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587ca43e10>]}
[0m11:17:29.698784 [info ] [MainThread]: 
[0m11:17:29.701026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:29.702624 [info ] [MainThread]: 
[0m11:17:29.704054 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:17:29.705802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:17:29.733553 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:17:29.735668 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:17:29.737020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:29.783330 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m11:17:29.785854 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:17:29.791004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:17:29.792793 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:17:29.799114 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:17:29.800804 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:17:29.802350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:29.842831 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m11:17:29.846315 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:17:29.848791 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:17:29.851127 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:17:29.852749 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:17:29.854823 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:17:29.857430 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:17:29.859970 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:17:29.861572 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:17:29.862861 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:17:29.864747 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:17:29.865747 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:17:29.874128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m11:17:29.874850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m11:17:29.879730 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:17:29.882056 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:17:29.883276 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:17:29.884696 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:17:29.885772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:29.886830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:29.925601 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m11:17:29.926032 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m11:17:29.928406 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:17:29.930561 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:17:29.932575 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:17:29.934618 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:17:29.944097 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:17:29.944385 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:17:29.946751 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:17:29.948680 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:17:29.949990 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:17:29.951242 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:17:29.952450 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:17:29.953786 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:17:29.960717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1623f4f2-d728-4366-8ef2-f40493c0f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587ec8ca90>]}
[0m11:17:29.962366 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:29.963592 [debug] [MainThread]: On master: BEGIN
[0m11:17:29.964888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:30.001217 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m11:17:30.002743 [debug] [MainThread]: On master: COMMIT
[0m11:17:30.004112 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:30.005776 [debug] [MainThread]: On master: COMMIT
[0m11:17:30.008107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:17:30.010105 [debug] [MainThread]: On master: Close
[0m11:17:30.016691 [debug] [Thread-1 (]: Began running node model.ecomm.fct_order_items
[0m11:17:30.018503 [info ] [Thread-1 (]: 1 of 1 START sql view model main_main.fct_order_items .......................... [RUN]
[0m11:17:30.020850 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m11:17:30.022999 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_order_items
[0m11:17:30.031067 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:17:30.052181 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_order_items
[0m11:17:30.080480 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:17:30.110702 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:17:30.115062 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:17:30.119515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:17:30.173650 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m11:17:30.175813 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:17:30.177701 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  li.sku     as sku,
  li.qty     as qty,
  li.price   as price,
  li.qty * li.price as line_total
from orders o
cross join unnest(o.line_items) as li
  );

[0m11:17:33.026418 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  li.sku     as sku,
  li.qty     as qty,
  li.price   as price,
  li.qty * li.price as line_total
from orders o
cross join unnest(o.line_items) as li
  );

[0m11:17:33.028275 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:17:33.031035 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: ROLLBACK
[0m11:17:33.036333 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.fct_order_items'
[0m11:17:33.039179 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: Close
[0m11:17:33.045889 [debug] [Thread-1 (]: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "sku"
  
  Candidate bindings: : "unnest"
  
  LINE 17:   li.sku     as sku,
             ^
[0m11:17:33.049464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1623f4f2-d728-4366-8ef2-f40493c0f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587eea8490>]}
[0m11:17:33.052782 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main_main.fct_order_items ................. [[31mERROR[0m in 3.03s]
[0m11:17:33.055496 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_order_items
[0m11:17:33.057706 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_order_items' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "sku"
  
  Candidate bindings: : "unnest"
  
  LINE 17:   li.sku     as sku,
             ^.
[0m11:17:33.062010 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:33.063135 [debug] [MainThread]: On master: BEGIN
[0m11:17:33.065032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:33.110296 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m11:17:33.112485 [debug] [MainThread]: On master: COMMIT
[0m11:17:33.114524 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:33.116337 [debug] [MainThread]: On master: COMMIT
[0m11:17:33.118597 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:17:33.120612 [debug] [MainThread]: On master: Close
[0m11:17:33.126249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:33.128818 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:17:33.131121 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:17:33.133229 [debug] [MainThread]: Connection 'model.ecomm.fct_order_items' was properly closed.
[0m11:17:33.135809 [info ] [MainThread]: 
[0m11:17:33.137762 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m11:17:33.139838 [debug] [MainThread]: Command end result
[0m11:17:33.194237 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:17:33.205163 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:17:33.219593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:17:33.221580 [info ] [MainThread]: 
[0m11:17:33.225121 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:17:33.228113 [info ] [MainThread]: 
[0m11:17:33.231104 [error] [MainThread]: [31mFailure in model fct_order_items (models/gold/fct_order_items.sql)[0m
[0m11:17:33.233534 [error] [MainThread]:   Runtime Error in model fct_order_items (models/gold/fct_order_items.sql)
  Binder Error: Table "li" does not have a column named "sku"
  
  Candidate bindings: : "unnest"
  
  LINE 17:   li.sku     as sku,
             ^
[0m11:17:33.235377 [info ] [MainThread]: 
[0m11:17:33.236461 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_order_items.sql
[0m11:17:33.238749 [info ] [MainThread]: 
[0m11:17:33.240583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:17:33.242476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.7237616, "process_in_blocks": "0", "process_kernel_time": 0.336732, "process_mem_max_rss": "210060", "process_out_blocks": "0", "process_user_time": 2.453336}
[0m11:17:33.244613 [debug] [MainThread]: Command `dbt run` failed at 11:17:33.244510 after 4.73 seconds
[0m11:17:33.246630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5885d59210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5885d68790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5883348b50>]}
[0m11:17:33.248491 [debug] [MainThread]: Flushing usage events
[0m11:17:34.187016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:20:00.382504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58a6fd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58a7570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58a6edfd0>]}


============================== 11:20:00.386499 | dab948fc-1d08-4604-9dca-03bb36b67b76 ==============================
[0m11:20:00.386499 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:20:00.388545 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/usr/app/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s models/gold/fct_order_items.sql', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'debug': 'False', 'profiles_dir': '/usr/app', 'quiet': 'False', 'cache_selected_only': 'False'}
[0m11:20:00.551027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab948fc-1d08-4604-9dca-03bb36b67b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58a5c6450>]}
[0m11:20:00.595693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab948fc-1d08-4604-9dca-03bb36b67b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58d314490>]}
[0m11:20:00.600631 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:20:00.643559 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:20:01.188897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:01.191019 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_order_items.sql
[0m11:20:02.849972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab948fc-1d08-4604-9dca-03bb36b67b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5862a8a50>]}
[0m11:20:02.966016 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:20:02.975296 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:20:03.000430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab948fc-1d08-4604-9dca-03bb36b67b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58626dcd0>]}
[0m11:20:03.002477 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:20:03.004120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab948fc-1d08-4604-9dca-03bb36b67b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5843937d0>]}
[0m11:20:03.015039 [info ] [MainThread]: 
[0m11:20:03.016651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:03.018414 [info ] [MainThread]: 
[0m11:20:03.020439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:20:03.022964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:20:03.052415 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:20:03.054911 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:20:03.056648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:03.109793 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m11:20:03.112482 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:20:03.118685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:20:03.120598 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:20:03.127811 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:20:03.129563 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:20:03.130685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:03.174855 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m11:20:03.177554 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:20:03.178898 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:20:03.181177 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:20:03.183032 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:20:03.184497 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:20:03.186293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:20:03.188166 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:20:03.189633 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:20:03.190987 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:20:03.192522 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:20:03.193840 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:20:03.202252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m11:20:03.202889 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m11:20:03.208147 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:20:03.210718 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:20:03.212118 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:20:03.213408 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:20:03.214688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:03.215943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:03.251712 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m11:20:03.252047 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m11:20:03.253712 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:20:03.255157 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:20:03.256488 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:20:03.257727 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:20:03.265332 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:20:03.265694 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:20:03.267871 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:20:03.269286 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:20:03.270664 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:20:03.271568 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:20:03.272643 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:20:03.273862 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:20:03.281366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab948fc-1d08-4604-9dca-03bb36b67b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58433fc50>]}
[0m11:20:03.282902 [debug] [MainThread]: Using duckdb connection "master"
[0m11:20:03.284154 [debug] [MainThread]: On master: BEGIN
[0m11:20:03.285313 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:03.325180 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m11:20:03.327265 [debug] [MainThread]: On master: COMMIT
[0m11:20:03.328865 [debug] [MainThread]: Using duckdb connection "master"
[0m11:20:03.330319 [debug] [MainThread]: On master: COMMIT
[0m11:20:03.332252 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:20:03.334113 [debug] [MainThread]: On master: Close
[0m11:20:03.340384 [debug] [Thread-1 (]: Began running node model.ecomm.fct_order_items
[0m11:20:03.342180 [info ] [Thread-1 (]: 1 of 1 START sql view model main_main.fct_order_items .......................... [RUN]
[0m11:20:03.343677 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.fct_order_items'
[0m11:20:03.345108 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_order_items
[0m11:20:03.352815 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:20:03.366452 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_order_items
[0m11:20:03.391459 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:20:03.406527 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:20:03.410089 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:20:03.412182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:20:03.452047 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m11:20:03.454209 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:20:03.456100 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  u.li.sku      as sku,
  u.li.qty      as qty,
  u.li.price    as price,
  u.li.qty * u.li.price as line_total
from orders o
cross join unnest(o.line_items) as u(li)   -- u = table alias, li = column alias (STRUCT)
  );

[0m11:20:05.563752 [debug] [Thread-1 (]: SQL status: OK in 2.106 seconds
[0m11:20:05.569529 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:20:05.570392 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
alter view "warehouse"."main_main"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m11:20:05.573717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:20:05.584432 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: COMMIT
[0m11:20:05.586650 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:20:05.588413 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: COMMIT
[0m11:20:05.596159 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:20:05.600092 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:20:05.601349 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
drop view if exists "warehouse"."main_main"."fct_order_items__dbt_backup" cascade
[0m11:20:05.603224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:20:05.605432 [debug] [Thread-1 (]: On model.ecomm.fct_order_items: Close
[0m11:20:05.620930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab948fc-1d08-4604-9dca-03bb36b67b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58416c650>]}
[0m11:20:05.622988 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main_main.fct_order_items ..................... [[32mOK[0m in 2.28s]
[0m11:20:05.624651 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_order_items
[0m11:20:05.627135 [debug] [MainThread]: Using duckdb connection "master"
[0m11:20:05.628232 [debug] [MainThread]: On master: BEGIN
[0m11:20:05.629192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:05.663497 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m11:20:05.665932 [debug] [MainThread]: On master: COMMIT
[0m11:20:05.667967 [debug] [MainThread]: Using duckdb connection "master"
[0m11:20:05.669692 [debug] [MainThread]: On master: COMMIT
[0m11:20:05.671885 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:20:05.673779 [debug] [MainThread]: On master: Close
[0m11:20:05.677884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:05.679775 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:20:05.681588 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:20:05.683244 [debug] [MainThread]: Connection 'model.ecomm.fct_order_items' was properly closed.
[0m11:20:05.685103 [info ] [MainThread]: 
[0m11:20:05.686803 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m11:20:05.688733 [debug] [MainThread]: Command end result
[0m11:20:05.734184 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:20:05.745011 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:20:05.752966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:20:05.754179 [info ] [MainThread]: 
[0m11:20:05.755597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:05.757082 [info ] [MainThread]: 
[0m11:20:05.761767 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:20:05.764220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.045482, "process_in_blocks": "0", "process_kernel_time": 0.327983, "process_mem_max_rss": "212172", "process_out_blocks": "0", "process_user_time": 2.746865}
[0m11:20:05.765880 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:05.765781 after 4.05 seconds
[0m11:20:05.767993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58a756f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58a767310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58a8a94d0>]}
[0m11:20:05.769950 [debug] [MainThread]: Flushing usage events
[0m11:20:06.717244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:45.316315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaacf87690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaacf7a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad13c450>]}


============================== 11:24:45.319384 | feb5b09d-2f77-495f-ab82-a21102a72e67 ==============================
[0m11:24:45.319384 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:24:45.320832 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'invocation_command': 'dbt build', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True', 'empty': 'False', 'log_path': '/usr/app/logs', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/usr/app', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m11:24:45.457610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaadfa49d0>]}
[0m11:24:45.500174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaafb9b7d0>]}
[0m11:24:45.501714 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:24:45.542993 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:24:45.817670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:45.818590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:45.846950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa8b4ab90>]}
[0m11:24:45.915204 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:24:45.922254 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:24:45.944317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa894a250>]}
[0m11:24:45.945417 [info ] [MainThread]: Found 14 models, 4 sources, 426 macros
[0m11:24:45.949757 [info ] [MainThread]: 
[0m11:24:45.951347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:45.952842 [info ] [MainThread]: 
[0m11:24:45.954208 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:24:45.959332 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:24:45.960634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:24:46.019306 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:24:46.019594 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:24:46.021301 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:24:46.022848 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m11:24:46.023963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:46.024925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:46.064326 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m11:24:46.064680 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m11:24:46.067196 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:24:46.068800 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:24:46.074977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m11:24:46.075267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m11:24:46.076507 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m11:24:46.078005 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m11:24:46.083821 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:24:46.086367 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:24:46.087478 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:24:46.088800 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m11:24:46.090022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:46.090979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:46.123207 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m11:24:46.123548 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m11:24:46.126620 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:24:46.128476 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:24:46.129332 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m11:24:46.130545 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m11:24:46.131832 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:24:46.132749 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:24:46.133560 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:24:46.134743 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:24:46.136136 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m11:24:46.137238 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m11:24:46.138826 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:24:46.140366 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:24:46.140928 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m11:24:46.142467 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:24:46.143528 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m11:24:46.144712 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m11:24:46.145944 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m11:24:46.146999 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m11:24:46.148709 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:24:46.149759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:24:46.150441 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m11:24:46.151414 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m11:24:46.157360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m11:24:46.157842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main, now list_warehouse_main)
[0m11:24:46.161886 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:24:46.164234 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:24:46.165050 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m11:24:46.166030 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:24:46.166728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:46.167443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:46.198032 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m11:24:46.198341 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m11:24:46.199661 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m11:24:46.201059 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:24:46.202351 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m11:24:46.204110 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'warehouse'
  
[0m11:24:46.212245 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:24:46.212702 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:24:46.214766 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m11:24:46.216345 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:24:46.217622 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m11:24:46.218527 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:24:46.219488 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m11:24:46.220863 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:24:46.226614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa8f6b110>]}
[0m11:24:46.227941 [debug] [MainThread]: Using duckdb connection "master"
[0m11:24:46.229031 [debug] [MainThread]: On master: BEGIN
[0m11:24:46.230104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:46.260336 [debug] [MainThread]: SQL status: OK in 0.030 seconds
[0m11:24:46.262404 [debug] [MainThread]: On master: COMMIT
[0m11:24:46.263642 [debug] [MainThread]: Using duckdb connection "master"
[0m11:24:46.265258 [debug] [MainThread]: On master: COMMIT
[0m11:24:46.266754 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:24:46.268089 [debug] [MainThread]: On master: Close
[0m11:24:46.273826 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m11:24:46.274096 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m11:24:46.274474 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m11:24:46.275395 [info ] [Thread-1 (]: 1 of 14 START sql view model main.stg_add_to_cart .............................. [RUN]
[0m11:24:46.276819 [info ] [Thread-2 (]: 2 of 14 START sql view model main.stg_order_placed ............................. [RUN]
[0m11:24:46.277891 [info ] [Thread-3 (]: 3 of 14 START sql view model main.stg_page_view ................................ [RUN]
[0m11:24:46.279186 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m11:24:46.280311 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m11:24:46.281199 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m11:24:46.282317 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m11:24:46.283419 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m11:24:46.284609 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m11:24:46.290798 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m11:24:46.293770 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m11:24:46.296356 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m11:24:46.303292 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m11:24:46.304170 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m11:24:46.314892 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m11:24:46.332475 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m11:24:46.332751 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m11:24:46.336324 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m11:24:46.346176 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:24:46.347104 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:24:46.347796 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m11:24:46.349332 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m11:24:46.349592 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:24:46.351242 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:24:46.352204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:24:46.353482 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m11:24:46.356238 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:24:46.382887 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m11:24:46.383281 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m11:24:46.383520 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m11:24:46.384946 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:24:46.386483 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:24:46.387817 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:24:46.389067 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main"."stg_page_view__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  url,
  referrer,
  ua,
  session_hint,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet')
  );

[0m11:24:46.390465 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main"."stg_add_to_cart__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  sku,
  cast(qty   as integer)       as qty,
  cast(price as double)        as price,
  cast(qty * price as double)  as line_total,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet')
  );

[0m11:24:46.391851 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main"."stg_order_placed__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(order_id as varchar)    as order_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  cast(total    as double)     as total,
  line_items,                      -- DuckDB can read LIST<STRUCT{sku,qty,price}>
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet')
  );

[0m11:24:48.187937 [debug] [Thread-2 (]: SQL status: OK in 1.792 seconds
[0m11:24:48.195797 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:24:48.198038 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed" rename to "stg_order_placed__dbt_backup"
[0m11:24:48.200917 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:24:48.205424 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:24:48.207129 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main"."stg_order_placed__dbt_tmp" rename to "stg_order_placed"
[0m11:24:48.209704 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:24:48.222761 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m11:24:48.224278 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:24:48.226383 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m11:24:48.241868 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m11:24:48.247647 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m11:24:48.249229 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
drop view if exists "warehouse"."main"."stg_order_placed__dbt_backup" cascade
[0m11:24:48.254324 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:24:48.257444 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m11:24:48.260892 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa35da510>]}
[0m11:24:48.262839 [info ] [Thread-2 (]: 2 of 14 OK created sql view model main.stg_order_placed ........................ [[32mOK[0m in 1.98s]
[0m11:24:48.264674 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m11:24:48.266790 [debug] [Thread-4 (]: Began running node model.ecomm.fct_daily_sales
[0m11:24:48.267073 [debug] [Thread-2 (]: Began running node model.ecomm.fct_order_items
[0m11:24:48.268516 [info ] [Thread-4 (]: 4 of 14 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m11:24:48.269993 [info ] [Thread-2 (]: 5 of 14 START sql view model main_main.fct_order_items ......................... [RUN]
[0m11:24:48.271918 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_daily_sales'
[0m11:24:48.274116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_order_placed, now model.ecomm.fct_order_items)
[0m11:24:48.275664 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_daily_sales
[0m11:24:48.277168 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_order_items
[0m11:24:48.280924 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m11:24:48.284620 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m11:24:48.298809 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_daily_sales
[0m11:24:48.302832 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m11:24:48.303179 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_order_items
[0m11:24:48.308895 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m11:24:48.319885 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:24:48.321621 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m11:24:48.321924 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:24:48.323278 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:24:48.324923 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: BEGIN
[0m11:24:48.327147 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:24:48.328559 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:24:48.330416 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:24:48.332689 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m11:24:48.334041 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:24:48.335600 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:24:48.339224 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  u.li.sku      as sku,
  u.li.qty      as qty,
  u.li.price    as price,
  u.li.qty * u.li.price as line_total
from orders o
cross join unnest(o.line_items) as u(li)   -- u = table alias, li = column alias (STRUCT)
  );

[0m11:24:49.812081 [debug] [Thread-4 (]: SQL status: OK in 1.474 seconds
[0m11:24:49.812740 [debug] [Thread-2 (]: SQL status: OK in 1.472 seconds
[0m11:24:49.818368 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:24:49.822051 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:24:49.825856 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m11:24:49.827529 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
alter view "warehouse"."main_main"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m11:24:49.829501 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:24:49.830586 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:24:49.833662 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:24:49.837436 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:24:49.839148 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m11:24:49.841069 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
alter view "warehouse"."main_main"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m11:24:49.843041 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:24:49.843970 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:24:49.846310 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:24:49.848820 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: COMMIT
[0m11:24:49.850803 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:24:49.852680 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:24:49.854660 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m11:24:49.856252 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: COMMIT
[0m11:24:49.862022 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:24:49.866518 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m11:24:49.866942 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m11:24:49.868091 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
drop view if exists "warehouse"."main_main"."fct_daily_sales__dbt_backup" cascade
[0m11:24:49.871624 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m11:24:49.874976 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
drop view if exists "warehouse"."main_main"."fct_order_items__dbt_backup" cascade
[0m11:24:49.876809 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:24:49.879326 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: Close
[0m11:24:49.879633 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:24:49.881165 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa8fa1410>]}
[0m11:24:49.883035 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: Close
[0m11:24:49.884439 [info ] [Thread-4 (]: 4 of 14 OK created sql view model main_main.fct_daily_sales .................... [[32mOK[0m in 1.61s]
[0m11:24:49.886146 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa3461990>]}
[0m11:24:49.887235 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_daily_sales
[0m11:24:49.888743 [info ] [Thread-2 (]: 5 of 14 OK created sql view model main_main.fct_order_items .................... [[32mOK[0m in 1.61s]
[0m11:24:49.889987 [debug] [Thread-4 (]: Began running node model.ecomm.fct_orders
[0m11:24:49.891349 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_order_items
[0m11:24:49.892847 [info ] [Thread-4 (]: 6 of 14 START sql view model main_main.fct_orders .............................. [RUN]
[0m11:24:49.894663 [debug] [Thread-2 (]: Began running node model.ecomm.dim_sku_360
[0m11:24:49.895868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_daily_sales, now model.ecomm.fct_orders)
[0m11:24:49.897405 [info ] [Thread-2 (]: 7 of 14 START sql table model main_main.dim_sku_360 ............................ [RUN]
[0m11:24:49.898801 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_orders
[0m11:24:49.899996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.dim_sku_360)
[0m11:24:49.904209 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m11:24:49.905374 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_sku_360
[0m11:24:49.910853 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_sku_360"
[0m11:24:49.918386 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_orders
[0m11:24:49.919827 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_sku_360
[0m11:24:49.923301 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m11:24:49.941201 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_sku_360"
[0m11:24:49.952096 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:24:49.953165 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m11:24:49.955774 [debug] [Thread-4 (]: On model.ecomm.fct_orders: BEGIN
[0m11:24:49.957224 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: BEGIN
[0m11:24:49.959115 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:24:49.961445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:24:49.963687 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:24:49.965314 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m11:24:49.966602 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:24:49.967998 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m11:24:49.969405 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m11:24:49.971162 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_sku_360__dbt_tmp"
  
    as (
      

with li as (
  select
    sku,
    qty,
    price,
    line_total,
    /* if fct_order_items doesn't have event_date, replace with CAST(ts AS date) */
    event_date
  from "warehouse"."main_main"."fct_order_items"
)
select
  sku,
  min(event_date)                         as first_sold_date,
  sum(qty)                                as units_sold,
  cast(sum(line_total) as decimal(18,2))  as gross_revenue,
  cast(round(avg(price), 2) as decimal(18,2)) as avg_unit_price
from li
group by sku
    );
  
  
[0m11:24:50.015430 [debug] [Thread-1 (]: SQL status: OK in 3.621 seconds
[0m11:24:50.019307 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:24:50.021012 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart" rename to "stg_add_to_cart__dbt_backup"
[0m11:24:50.022909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:24:50.027675 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:24:50.029219 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main"."stg_add_to_cart__dbt_tmp" rename to "stg_add_to_cart"
[0m11:24:50.030908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:24:50.033400 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m11:24:50.034747 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:24:50.036377 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m11:24:50.044870 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:24:50.048312 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m11:24:50.049825 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
drop view if exists "warehouse"."main"."stg_add_to_cart__dbt_backup" cascade
[0m11:24:50.055417 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:24:50.058040 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m11:24:50.060963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa0107ed0>]}
[0m11:24:50.062874 [info ] [Thread-1 (]: 1 of 14 OK created sql view model main.stg_add_to_cart ......................... [[32mOK[0m in 3.78s]
[0m11:24:50.064582 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m11:24:50.066158 [debug] [Thread-1 (]: Began running node model.ecomm.fct_revenue_daily
[0m11:24:50.068353 [info ] [Thread-1 (]: 8 of 14 START sql view model main_main.fct_revenue_daily ....................... [RUN]
[0m11:24:50.070145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_add_to_cart, now model.ecomm.fct_revenue_daily)
[0m11:24:50.071584 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_revenue_daily
[0m11:24:50.074980 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_revenue_daily"
[0m11:24:50.092708 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_revenue_daily
[0m11:24:50.098017 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_revenue_daily"
[0m11:24:50.118763 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m11:24:50.120980 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: BEGIN
[0m11:24:50.122593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:50.124712 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:24:50.127168 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m11:24:50.129950 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_daily__dbt_tmp" as (
    
select
  event_date,
  sum(line_amount) as revenue,
  sum(qty)         as units
from "warehouse"."main_main"."fct_order_items"
group by event_date
order by event_date
  );

[0m11:24:51.854212 [debug] [Thread-4 (]: SQL status: OK in 1.881 seconds
[0m11:24:51.859150 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:24:51.861095 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:24:51.863786 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:24:51.868264 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:24:51.870777 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:24:51.873515 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:24:51.876253 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m11:24:51.877881 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:24:51.880159 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m11:24:51.889004 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m11:24:51.892360 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m11:24:51.894233 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
drop view if exists "warehouse"."main_main"."fct_orders__dbt_backup" cascade
[0m11:24:51.898893 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m11:24:51.901157 [debug] [Thread-4 (]: On model.ecomm.fct_orders: Close
[0m11:24:51.903378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaace55750>]}
[0m11:24:51.905192 [info ] [Thread-4 (]: 6 of 14 OK created sql view model main_main.fct_orders ......................... [[32mOK[0m in 2.01s]
[0m11:24:51.907115 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_orders
[0m11:24:51.908684 [debug] [Thread-4 (]: Began running node model.ecomm.fct_cart_events
[0m11:24:51.910311 [info ] [Thread-4 (]: 9 of 14 START sql view model main_main.fct_cart_events ......................... [RUN]
[0m11:24:51.912107 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.fct_cart_events)
[0m11:24:51.913343 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_cart_events
[0m11:24:51.917087 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m11:24:51.937910 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_cart_events
[0m11:24:51.941765 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m11:24:51.956325 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:24:51.957719 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: BEGIN
[0m11:24:51.959040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:24:51.960849 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:24:51.962234 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:24:51.963526 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main"."stg_add_to_cart"
group by event_date
order by event_date
  );

[0m11:24:52.033403 [debug] [Thread-3 (]: SQL status: OK in 5.640 seconds
[0m11:24:52.037938 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:24:52.039753 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view" rename to "stg_page_view__dbt_backup"
[0m11:24:52.042066 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:24:52.045915 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:24:52.047678 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main"."stg_page_view__dbt_tmp" rename to "stg_page_view"
[0m11:24:52.049913 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:24:52.052217 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m11:24:52.053971 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:24:52.055796 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m11:24:52.063336 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m11:24:52.068255 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m11:24:52.070041 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
drop view if exists "warehouse"."main"."stg_page_view__dbt_backup" cascade
[0m11:24:52.075505 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m11:24:52.077843 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m11:24:52.080079 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa0148990>]}
[0m11:24:52.082488 [info ] [Thread-3 (]: 3 of 14 OK created sql view model main.stg_page_view ........................... [[32mOK[0m in 5.80s]
[0m11:24:52.084503 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m11:24:52.086897 [debug] [Thread-3 (]: Began running node model.ecomm.daily_funnel
[0m11:24:52.088560 [info ] [Thread-3 (]: 10 of 14 START sql view model main_main.daily_funnel ........................... [RUN]
[0m11:24:52.090853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_page_view, now model.ecomm.daily_funnel)
[0m11:24:52.092478 [debug] [Thread-3 (]: Began compiling node model.ecomm.daily_funnel
[0m11:24:52.096448 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m11:24:52.112379 [debug] [Thread-3 (]: Began executing node model.ecomm.daily_funnel
[0m11:24:52.116273 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m11:24:52.129021 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:24:52.130400 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: BEGIN
[0m11:24:52.131559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:24:52.132857 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:24:52.134195 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:24:52.135508 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date
  );

[0m11:24:52.321944 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_daily__dbt_tmp" as (
    
select
  event_date,
  sum(line_amount) as revenue,
  sum(qty)         as units
from "warehouse"."main_main"."fct_order_items"
group by event_date
order by event_date
  );

[0m11:24:52.324431 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:24:52.326611 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: ROLLBACK
[0m11:24:52.332356 [debug] [Thread-1 (]: Failed to rollback 'model.ecomm.fct_revenue_daily'
[0m11:24:52.334097 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_daily: Close
[0m11:24:52.338079 [debug] [Thread-1 (]: Runtime Error in model fct_revenue_daily (models/gold/fct_revenue_daily.sql)
  Binder Error: Referenced column "line_amount" not found in FROM clause!
  Candidate bindings: "line_total", "event_date", "price"
  
  LINE 8:   sum(line_amount) as revenue,
                ^
[0m11:24:52.340273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa0129850>]}
[0m11:24:52.342216 [error] [Thread-1 (]: 8 of 14 ERROR creating sql view model main_main.fct_revenue_daily .............. [[31mERROR[0m in 2.27s]
[0m11:24:52.344074 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_revenue_daily
[0m11:24:52.345764 [debug] [Thread-1 (]: Began running node model.ecomm.stg_sessions
[0m11:24:52.346137 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_revenue_daily' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_revenue_daily (models/gold/fct_revenue_daily.sql)
  Binder Error: Referenced column "line_amount" not found in FROM clause!
  Candidate bindings: "line_total", "event_date", "price"
  
  LINE 8:   sum(line_amount) as revenue,
                ^.
[0m11:24:52.347647 [info ] [Thread-1 (]: 11 of 14 START sql view model main.stg_sessions ................................ [RUN]
[0m11:24:52.351507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_revenue_daily, now model.ecomm.stg_sessions)
[0m11:24:52.353042 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_sessions
[0m11:24:52.357751 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m11:24:52.374351 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_sessions
[0m11:24:52.378377 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m11:24:52.396592 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:24:52.398828 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: BEGIN
[0m11:24:52.400436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:52.402693 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:24:52.404235 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:24:52.405697 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main"."stg_sessions__dbt_tmp" as (
    

with events as (
  select user_id, ts, 'page_view'    as event_type from "warehouse"."main"."stg_page_view"
  union all
  select user_id, ts, 'add_to_cart'  as event_type from "warehouse"."main"."stg_add_to_cart"
  union all
  select user_id, ts, 'order_placed' as event_type from "warehouse"."main"."stg_order_placed"
),
ordered as (
  select
    user_id,
    ts,
    event_type,
    lag(ts) over (partition by user_id order by ts) as prev_ts
  from events
),
marks as (
  select
    *,
    case when prev_ts is null or ts - prev_ts > interval '30 minutes' then 1 else 0 end as is_new_session
  from ordered
),
grp as (
  select
    *,
    sum(is_new_session) over (partition by user_id order by ts rows unbounded preceding) as session_num
  from marks
)
select
  user_id || '|' || strftime('%Y-%m-%dT%H:%M:%S', min(ts)) || '|' || strftime('%Y-%m-%dT%H:%M:%S', max(ts)) as session_id,
  user_id,
  min(ts) as session_start,
  max(ts) as session_end,
  sum(case when event_type='page_view' then 1 else 0 end) as page_count,
  sum(case when event_type='add_to_cart' then 1 else 0 end) as cart_events,
  max(case when event_type='order_placed' then 1 else 0 end) as conversion_flag,
  cast(min(ts) as date) as session_date,
  now() as ingest_ts
from grp
group by user_id, session_num
  );

[0m11:24:53.608380 [debug] [Thread-2 (]: SQL status: OK in 3.634 seconds
[0m11:24:53.611685 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m11:24:53.612987 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
alter table "warehouse"."main_main"."dim_sku_360__dbt_tmp" rename to "dim_sku_360"
[0m11:24:53.614641 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:24:53.619103 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: COMMIT
[0m11:24:53.620348 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m11:24:53.621582 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: COMMIT
[0m11:24:53.628840 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m11:24:53.631536 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m11:24:53.632932 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
drop table if exists "warehouse"."main_main"."dim_sku_360__dbt_backup" cascade
[0m11:24:53.634791 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:24:53.636598 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: Close
[0m11:24:53.640566 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa346cad0>]}
[0m11:24:53.641986 [info ] [Thread-2 (]: 7 of 14 OK created sql table model main_main.dim_sku_360 ....................... [[32mOK[0m in 3.74s]
[0m11:24:53.643546 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_sku_360
[0m11:24:53.644941 [debug] [Thread-2 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m11:24:53.646503 [info ] [Thread-2 (]: 12 of 14 START sql view model main_main.fct_revenue_by_category_daily .......... [RUN]
[0m11:24:53.648097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.dim_sku_360, now model.ecomm.fct_revenue_by_category_daily)
[0m11:24:53.649730 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_revenue_by_category_daily
[0m11:24:53.653532 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_revenue_by_category_daily"
[0m11:24:53.670448 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_revenue_by_category_daily
[0m11:24:53.674544 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_revenue_by_category_daily"
[0m11:24:53.690222 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m11:24:53.691968 [debug] [Thread-2 (]: On model.ecomm.fct_revenue_by_category_daily: BEGIN
[0m11:24:53.694080 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:24:53.697125 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m11:24:53.698845 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m11:24:53.700415 [debug] [Thread-2 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_tmp" as (
    
select
  oi.event_date,
  coalesce(s.category, 'Unknown') as category,
  sum(oi.line_amount) as revenue,
  sum(oi.qty)         as units
from "warehouse"."main_main"."fct_order_items" oi
left join "warehouse"."main_main"."dim_sku_360" s using (sku)
group by oi.event_date, category
order by oi.event_date, category
  );

[0m11:24:55.594419 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_tmp" as (
    
select
  oi.event_date,
  coalesce(s.category, 'Unknown') as category,
  sum(oi.line_amount) as revenue,
  sum(oi.qty)         as units
from "warehouse"."main_main"."fct_order_items" oi
left join "warehouse"."main_main"."dim_sku_360" s using (sku)
group by oi.event_date, category
order by oi.event_date, category
  );

[0m11:24:55.595954 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m11:24:55.597326 [debug] [Thread-2 (]: On model.ecomm.fct_revenue_by_category_daily: ROLLBACK
[0m11:24:55.599920 [debug] [Thread-2 (]: Failed to rollback 'model.ecomm.fct_revenue_by_category_daily'
[0m11:24:55.601400 [debug] [Thread-2 (]: On model.ecomm.fct_revenue_by_category_daily: Close
[0m11:24:55.604813 [debug] [Thread-2 (]: Runtime Error in model fct_revenue_by_category_daily (models/gold/fct_revenue_by_category_daily.sql)
  Binder Error: Table "s" does not have a column named "category"
  
  Candidate bindings: : "gross_revenue"
  
  LINE 8:   coalesce(s.category, 'Unknown') as category,
                     ^
[0m11:24:55.606605 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa015bb50>]}
[0m11:24:55.608512 [error] [Thread-2 (]: 12 of 14 ERROR creating sql view model main_main.fct_revenue_by_category_daily . [[31mERROR[0m in 1.96s]
[0m11:24:55.609798 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m11:24:55.611138 [debug] [Thread-7 (]: Marking all children of 'model.ecomm.fct_revenue_by_category_daily' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_revenue_by_category_daily (models/gold/fct_revenue_by_category_daily.sql)
  Binder Error: Table "s" does not have a column named "category"
  
  Candidate bindings: : "gross_revenue"
  
  LINE 8:   coalesce(s.category, 'Unknown') as category,
                     ^.
[0m11:24:55.697111 [debug] [Thread-4 (]: SQL status: OK in 3.732 seconds
[0m11:24:55.700409 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:24:55.701447 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events" rename to "fct_cart_events__dbt_backup"
[0m11:24:55.703205 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:24:55.706847 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:24:55.708090 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events__dbt_tmp" rename to "fct_cart_events"
[0m11:24:55.709923 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:24:55.713633 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:24:55.714676 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:24:55.715672 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: COMMIT
[0m11:24:55.722003 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m11:24:55.725421 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m11:24:55.726609 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
drop view if exists "warehouse"."main_main"."fct_cart_events__dbt_backup" cascade
[0m11:24:55.730437 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m11:24:55.732739 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: Close
[0m11:24:55.734463 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa01d4150>]}
[0m11:24:55.735860 [info ] [Thread-4 (]: 9 of 14 OK created sql view model main_main.fct_cart_events .................... [[32mOK[0m in 3.82s]
[0m11:24:55.737149 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_cart_events
[0m11:25:00.945897 [debug] [Thread-3 (]: SQL status: OK in 8.809 seconds
[0m11:25:00.949049 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:25:00.949875 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel" rename to "daily_funnel__dbt_backup"
[0m11:25:00.950976 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:25:00.953321 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:25:00.954836 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel__dbt_tmp" rename to "daily_funnel"
[0m11:25:00.956812 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m11:25:00.959075 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:25:00.959847 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:25:00.960713 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: COMMIT
[0m11:25:00.965946 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m11:25:00.968710 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m11:25:00.969822 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
drop view if exists "warehouse"."main_main"."daily_funnel__dbt_backup" cascade
[0m11:25:00.972356 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m11:25:00.973680 [debug] [Thread-3 (]: On model.ecomm.daily_funnel: Close
[0m11:25:00.975155 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa35f9b50>]}
[0m11:25:00.975978 [info ] [Thread-3 (]: 10 of 14 OK created sql view model main_main.daily_funnel ...................... [[32mOK[0m in 8.88s]
[0m11:25:00.977372 [debug] [Thread-3 (]: Finished running node model.ecomm.daily_funnel
[0m11:25:01.037073 [debug] [Thread-1 (]: SQL status: OK in 8.629 seconds
[0m11:25:01.040701 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:25:01.042093 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */
alter view "warehouse"."main"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m11:25:01.044128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:25:01.047879 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:25:01.050238 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */
alter view "warehouse"."main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m11:25:01.052266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:25:01.054599 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: COMMIT
[0m11:25:01.056608 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:25:01.057945 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: COMMIT
[0m11:25:01.066721 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:25:01.071369 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m11:25:01.073000 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */
drop view if exists "warehouse"."main"."stg_sessions__dbt_backup" cascade
[0m11:25:01.077182 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:25:01.079343 [debug] [Thread-1 (]: On model.ecomm.stg_sessions: Close
[0m11:25:01.105737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa8fe0110>]}
[0m11:25:01.108106 [info ] [Thread-1 (]: 11 of 14 OK created sql view model main.stg_sessions ........................... [[32mOK[0m in 8.75s]
[0m11:25:01.110352 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_sessions
[0m11:25:01.112289 [debug] [Thread-2 (]: Began running node model.ecomm.dim_user
[0m11:25:01.112564 [debug] [Thread-4 (]: Began running node model.ecomm.fct_sessions
[0m11:25:01.113830 [info ] [Thread-2 (]: 13 of 14 START sql view model main_main.dim_user ............................... [RUN]
[0m11:25:01.115657 [info ] [Thread-4 (]: 14 of 14 START sql view model main_main.fct_sessions ........................... [RUN]
[0m11:25:01.117929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_revenue_by_category_daily, now model.ecomm.dim_user)
[0m11:25:01.119346 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_cart_events, now model.ecomm.fct_sessions)
[0m11:25:01.121143 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_user
[0m11:25:01.122916 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_sessions
[0m11:25:01.128057 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m11:25:01.133217 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m11:25:01.143101 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_user
[0m11:25:01.146969 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m11:25:01.147349 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_sessions
[0m11:25:01.152979 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m11:25:01.160829 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:25:01.161935 [debug] [Thread-2 (]: On model.ecomm.dim_user: BEGIN
[0m11:25:01.162338 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:25:01.163019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:01.164061 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: BEGIN
[0m11:25:01.166103 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:25:01.208495 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m11:25:01.208911 [debug] [Thread-4 (]: SQL status: OK in 0.043 seconds
[0m11:25:01.210167 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:25:01.211368 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:25:01.212752 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
  create view "warehouse"."main_main"."dim_user__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main"."stg_sessions"
),
orders as (
  select user_id, total
  from "warehouse"."main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*)    as total_orders,
    sum(total)  as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)    as total_orders,
  coalesce(o.lifetime_value, 0)  as lifetime_value,
  a.converting_sessions
from agg a
left join ord o on a.user_id = o.user_id
  );

[0m11:25:01.214051 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main"."stg_sessions"
group by session_date
order by session_date
  );

[0m11:25:05.829474 [debug] [Thread-4 (]: SQL status: OK in 4.613 seconds
[0m11:25:05.833437 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:25:05.835049 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions" rename to "fct_sessions__dbt_backup"
[0m11:25:05.836841 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m11:25:05.840025 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:25:05.841377 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m11:25:05.845230 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m11:25:05.847074 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:25:05.848787 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:25:05.850194 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m11:25:05.861457 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m11:25:05.864612 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m11:25:05.866361 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
drop view if exists "warehouse"."main_main"."fct_sessions__dbt_backup" cascade
[0m11:25:05.873312 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m11:25:05.877229 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: Close
[0m11:25:05.879811 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa3586f10>]}
[0m11:25:05.881217 [info ] [Thread-4 (]: 14 of 14 OK created sql view model main_main.fct_sessions ...................... [[32mOK[0m in 4.76s]
[0m11:25:05.882971 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_sessions
[0m11:25:06.906266 [debug] [Thread-2 (]: SQL status: OK in 5.691 seconds
[0m11:25:06.909296 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:25:06.910118 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter view "warehouse"."main_main"."dim_user" rename to "dim_user__dbt_backup"
[0m11:25:06.911314 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:25:06.913695 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:25:06.914450 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter view "warehouse"."main_main"."dim_user__dbt_tmp" rename to "dim_user"
[0m11:25:06.915553 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m11:25:06.917540 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m11:25:06.918372 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:25:06.919187 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m11:25:06.925564 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m11:25:06.927889 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m11:25:06.928678 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
drop view if exists "warehouse"."main_main"."dim_user__dbt_backup" cascade
[0m11:25:06.931217 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m11:25:06.932595 [debug] [Thread-2 (]: On model.ecomm.dim_user: Close
[0m11:25:06.943195 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb5b09d-2f77-495f-ab82-a21102a72e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa347b450>]}
[0m11:25:06.944978 [info ] [Thread-2 (]: 13 of 14 OK created sql view model main_main.dim_user .......................... [[32mOK[0m in 5.83s]
[0m11:25:06.946426 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_user
[0m11:25:06.948684 [debug] [MainThread]: Using duckdb connection "master"
[0m11:25:06.949833 [debug] [MainThread]: On master: BEGIN
[0m11:25:06.950618 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:06.983631 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m11:25:06.985252 [debug] [MainThread]: On master: COMMIT
[0m11:25:06.986641 [debug] [MainThread]: Using duckdb connection "master"
[0m11:25:06.987873 [debug] [MainThread]: On master: COMMIT
[0m11:25:06.989610 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:25:06.990963 [debug] [MainThread]: On master: Close
[0m11:25:06.995091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:06.996334 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:25:06.997466 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m11:25:06.998667 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m11:25:06.999683 [debug] [MainThread]: Connection 'model.ecomm.dim_user' was properly closed.
[0m11:25:07.000938 [debug] [MainThread]: Connection 'model.ecomm.daily_funnel' was properly closed.
[0m11:25:07.002142 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m11:25:07.003633 [info ] [MainThread]: 
[0m11:25:07.005095 [info ] [MainThread]: Finished running 1 table model, 13 view models in 0 hours 0 minutes and 21.05 seconds (21.05s).
[0m11:25:07.007336 [debug] [MainThread]: Command end result
[0m11:25:07.041823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:25:07.049903 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:25:07.061846 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:25:07.063035 [info ] [MainThread]: 
[0m11:25:07.064455 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:25:07.065283 [info ] [MainThread]: 
[0m11:25:07.066519 [error] [MainThread]: [31mFailure in model fct_revenue_daily (models/gold/fct_revenue_daily.sql)[0m
[0m11:25:07.067753 [error] [MainThread]:   Runtime Error in model fct_revenue_daily (models/gold/fct_revenue_daily.sql)
  Binder Error: Referenced column "line_amount" not found in FROM clause!
  Candidate bindings: "line_total", "event_date", "price"
  
  LINE 8:   sum(line_amount) as revenue,
                ^
[0m11:25:07.069056 [info ] [MainThread]: 
[0m11:25:07.070628 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_revenue_daily.sql
[0m11:25:07.071921 [info ] [MainThread]: 
[0m11:25:07.073113 [error] [MainThread]: [31mFailure in model fct_revenue_by_category_daily (models/gold/fct_revenue_by_category_daily.sql)[0m
[0m11:25:07.074379 [error] [MainThread]:   Runtime Error in model fct_revenue_by_category_daily (models/gold/fct_revenue_by_category_daily.sql)
  Binder Error: Table "s" does not have a column named "category"
  
  Candidate bindings: : "gross_revenue"
  
  LINE 8:   coalesce(s.category, 'Unknown') as category,
                     ^
[0m11:25:07.075724 [info ] [MainThread]: 
[0m11:25:07.076979 [info ] [MainThread]:   compiled code at target/compiled/ecomm/models/gold/fct_revenue_by_category_daily.sql
[0m11:25:07.078086 [info ] [MainThread]: 
[0m11:25:07.079214 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=14
[0m11:25:07.081023 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 21.818192, "process_in_blocks": "2480", "process_kernel_time": 1.677865, "process_mem_max_rss": "267616", "process_out_blocks": "0", "process_user_time": 4.746474}
[0m11:25:07.082558 [debug] [MainThread]: Command `dbt build` failed at 11:25:07.082441 after 21.82 seconds
[0m11:25:07.083917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaacf7a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab1811210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa015bc50>]}
[0m11:25:07.084890 [debug] [MainThread]: Flushing usage events
[0m11:25:08.304078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:18.406248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8e18a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8e17dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8e1ebe50>]}


============================== 11:31:18.410743 | b84e7c02-565a-4420-a334-179db0311b57 ==============================
[0m11:31:18.410743 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:31:18.412283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt seed', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/usr/app', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:31:18.624659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84e7c02-565a-4420-a334-179db0311b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8f019d90>]}
[0m11:31:18.685674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b84e7c02-565a-4420-a334-179db0311b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b90dbc590>]}
[0m11:31:18.689938 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:31:18.740699 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:31:19.120974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:31:19.122845 [debug] [MainThread]: Partial parsing: added file: ecomm://models/gold/dim_sku.sql
[0m11:31:19.124469 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_revenue_by_category_daily.sql
[0m11:31:19.125718 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_revenue_daily.sql
[0m11:31:19.365060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84e7c02-565a-4420-a334-179db0311b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b89f06710>]}
[0m11:31:19.465947 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:31:19.470814 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:31:19.488142 [error] [MainThread]: Encountered an error:
Found a cycle: model.ecomm.dim_sku
[0m11:31:19.491717 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 718, in seed
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ecomm.dim_sku

[0m11:31:19.493897 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.1438224, "process_in_blocks": "129760", "process_kernel_time": 0.226783, "process_mem_max_rss": "139852", "process_out_blocks": "0", "process_user_time": 1.700873}
[0m11:31:19.494822 [debug] [MainThread]: Command `dbt seed` failed at 11:31:19.494731 after 1.14 seconds
[0m11:31:19.495930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b89cc3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b89cc3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b89cc2ad0>]}
[0m11:31:19.496746 [debug] [MainThread]: Flushing usage events
[0m11:31:20.629957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:20.853199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44034697d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4403700450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440342a790>]}


============================== 11:32:20.856746 | 6964e4f9-a1a5-43f4-8bfe-ec789d00db37 ==============================
[0m11:32:20.856746 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:32:20.858085 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt seed', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'None', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/usr/app', 'warn_error': 'None', 'no_print': 'None'}
[0m11:32:21.041756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6964e4f9-a1a5-43f4-8bfe-ec789d00db37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44032f48d0>]}
[0m11:32:21.082227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6964e4f9-a1a5-43f4-8bfe-ec789d00db37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440601f710>]}
[0m11:32:21.084647 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:32:21.129800 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:32:21.445526 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m11:32:21.448063 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:32:21.449751 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/dim_sku_360.sql
[0m11:32:21.624910 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.fct_revenue_by_category_daily' (models/gold/fct_revenue_by_category_daily.sql) depends on a node named 'dim_sku' which was not found
[0m11:32:21.629238 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.82581997, "process_in_blocks": "128344", "process_kernel_time": 0.177916, "process_mem_max_rss": "134224", "process_out_blocks": "0", "process_user_time": 1.371004}
[0m11:32:21.630248 [debug] [MainThread]: Command `dbt seed` failed at 11:32:21.630151 after 0.83 seconds
[0m11:32:21.632102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440342a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440342a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fefe0350>]}
[0m11:32:21.633854 [debug] [MainThread]: Flushing usage events
[0m11:32:22.919928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:40.256862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee35b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee35b22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee35b2250>]}


============================== 11:32:40.259663 | b592bb28-63aa-4ca8-b29c-cefddf3b9984 ==============================
[0m11:32:40.259663 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:32:40.261538 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt seed'}
[0m11:32:40.401614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b592bb28-63aa-4ca8-b29c-cefddf3b9984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee3428710>]}
[0m11:32:40.445843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b592bb28-63aa-4ca8-b29c-cefddf3b9984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee614ff10>]}
[0m11:32:40.448157 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:32:40.489896 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:32:40.750581 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m11:32:40.751654 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:32:40.753010 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/fct_revenue_by_category_daily.sql
[0m11:32:40.754499 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/dim_sku_360.sql
[0m11:32:40.926807 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:32:40.929128 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.72082883, "process_in_blocks": "0", "process_kernel_time": 0.155021, "process_mem_max_rss": "136752", "process_out_blocks": "0", "process_user_time": 1.343523}
[0m11:32:40.930886 [debug] [MainThread]: Command `dbt seed` failed at 11:32:40.930793 after 0.72 seconds
[0m11:32:40.932199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee3541f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee3541cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedf03ab10>]}
[0m11:32:40.933645 [debug] [MainThread]: Flushing usage events
[0m11:32:41.844906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:08.218368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b03f2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b03f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b03f2090>]}


============================== 11:33:08.221318 | ef727ad2-2288-4779-9ad4-8ff9c9f37739 ==============================
[0m11:33:08.221318 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:33:08.222743 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/app', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_path': '/usr/app/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'None', 'partial_parse': 'True'}
[0m11:33:08.359831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef727ad2-2288-4779-9ad4-8ff9c9f37739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b02a69d0>]}
[0m11:33:08.403279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef727ad2-2288-4779-9ad4-8ff9c9f37739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b2ffc190>]}
[0m11:33:08.405910 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:33:08.445858 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:33:09.127106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:09.129616 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/dim_sku_360.sql
[0m11:33:09.333165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef727ad2-2288-4779-9ad4-8ff9c9f37739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7abecbf50>]}
[0m11:33:09.420177 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:09.433173 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:09.456593 [error] [MainThread]: Encountered an error:
Found a cycle: model.ecomm.dim_sku
[0m11:33:09.460518 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 718, in seed
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ecomm.dim_sku

[0m11:33:09.462626 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.2922908, "process_in_blocks": "1416", "process_kernel_time": 0.147323, "process_mem_max_rss": "139340", "process_out_blocks": "0", "process_user_time": 1.43114}
[0m11:33:09.464567 [debug] [MainThread]: Command `dbt seed` failed at 11:33:09.464391 after 1.29 seconds
[0m11:33:09.466140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b03e5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7b03e67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7abecb350>]}
[0m11:33:09.467808 [debug] [MainThread]: Flushing usage events
[0m11:33:10.590775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:54.544407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dd222d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dd215a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dd279f90>]}


============================== 11:36:54.548111 | d62ddc53-89e3-4388-960e-e4a26f16da3c ==============================
[0m11:36:54.548111 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:36:54.549945 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/app', 'log_format': 'default', 'printer_width': '80', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt parse', 'write_json': 'True'}
[0m11:36:54.733515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd62ddc53-89e3-4388-960e-e4a26f16da3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dd7f0290>]}
[0m11:36:54.775700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd62ddc53-89e3-4388-960e-e4a26f16da3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dfe09a90>]}
[0m11:36:54.778943 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:36:54.824713 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:36:55.150784 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m11:36:55.153095 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:36:55.336394 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:36:55.339625 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.844226, "process_in_blocks": "127480", "process_kernel_time": 0.22743, "process_mem_max_rss": "138280", "process_out_blocks": "0", "process_user_time": 1.342923}
[0m11:36:55.341276 [debug] [MainThread]: Command `dbt parse` failed at 11:36:55.341167 after 0.85 seconds
[0m11:36:55.342505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dd0a8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d8c96090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d8c49590>]}
[0m11:36:55.343895 [debug] [MainThread]: Flushing usage events
[0m11:36:56.247319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:20.161519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4772be8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775611c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4772cf7490>]}


============================== 11:39:20.164961 | 320b52cc-4eec-4a47-8a74-38ecf219f71b ==============================
[0m11:39:20.164961 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:39:20.166484 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt seed', 'profiles_dir': '/usr/app', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'static_parser': 'True'}
[0m11:39:20.338603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '320b52cc-4eec-4a47-8a74-38ecf219f71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f476f2b6790>]}
[0m11:39:20.385988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '320b52cc-4eec-4a47-8a74-38ecf219f71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775648050>]}
[0m11:39:20.388657 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:39:20.433548 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:39:20.775172 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m11:39:20.776513 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:39:20.963252 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:39:20.965184 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.85292673, "process_in_blocks": "127480", "process_kernel_time": 0.192309, "process_mem_max_rss": "134204", "process_out_blocks": "0", "process_user_time": 1.367532}
[0m11:39:20.966174 [debug] [MainThread]: Command `dbt seed` failed at 11:39:20.966072 after 0.85 seconds
[0m11:39:20.967466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4772a8f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f476e5e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f476e912710>]}
[0m11:39:20.968474 [debug] [MainThread]: Flushing usage events
[0m11:39:22.046797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:07.317055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6552135b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6552136f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6552137250>]}


============================== 11:40:07.319920 | 6edba840-1fce-4547-ab54-fd1cdc4641c2 ==============================
[0m11:40:07.319920 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:40:07.321561 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/usr/app/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'None', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None'}
[0m11:40:07.457684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6edba840-1fce-4547-ab54-fd1cdc4641c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6551fa0590>]}
[0m11:40:07.499146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6edba840-1fce-4547-ab54-fd1cdc4641c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6554cdc5d0>]}
[0m11:40:07.500886 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:40:07.540249 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:40:07.770145 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m11:40:07.771410 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku_360.sql
[0m11:40:07.772785 [debug] [MainThread]: Partial parsing: updated file: ecomm://models/gold/dim_sku.sql
[0m11:40:07.962740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6edba840-1fce-4547-ab54-fd1cdc4641c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654db46890>]}
[0m11:40:08.026003 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:40:08.042289 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:40:08.060372 [error] [MainThread]: Encountered an error:
Found a cycle: model.ecomm.dim_sku
[0m11:40:08.064263 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 718, in seed
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ecomm.dim_sku

[0m11:40:08.065865 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.7956306, "process_in_blocks": "1416", "process_kernel_time": 0.123176, "process_mem_max_rss": "137240", "process_out_blocks": "0", "process_user_time": 1.396}
[0m11:40:08.066749 [debug] [MainThread]: Command `dbt seed` failed at 11:40:08.066665 after 0.80 seconds
[0m11:40:08.067671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6552135b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654dbb3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654dbe2310>]}
[0m11:40:08.068513 [debug] [MainThread]: Flushing usage events
[0m11:40:09.244882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:36.864499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f305d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ee9f8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef8c4d50>]}


============================== 11:40:36.869649 | d2d7137a-78d7-42f9-ad70-2746c80d39fd ==============================
[0m11:40:36.869649 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:40:36.871291 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/usr/app', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/app/logs', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'empty': 'None', 'invocation_command': 'dbt seed', 'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:40:37.027896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d7137a-78d7-42f9-ad70-2746c80d39fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99eb111bd0>]}
[0m11:40:37.071966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2d7137a-78d7-42f9-ad70-2746c80d39fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f142da50>]}
[0m11:40:37.073790 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:40:37.118748 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:40:37.413405 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m11:40:37.414564 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:40:37.594670 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.fct_revenue_by_category_daily' (models/gold/fct_revenue_by_category_daily.sql) depends on a node named 'dim_sku' which was not found
[0m11:40:37.596913 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.91664493, "process_in_blocks": "0", "process_kernel_time": 0.135848, "process_mem_max_rss": "134612", "process_out_blocks": "0", "process_user_time": 1.389835}
[0m11:40:37.597886 [debug] [MainThread]: Command `dbt seed` failed at 11:40:37.597794 after 0.92 seconds
[0m11:40:37.598750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f0ea6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f30a4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ea4ccc50>]}
[0m11:40:37.599637 [debug] [MainThread]: Flushing usage events
[0m11:40:38.697663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:02.773987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b05539e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b05596a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0552df50>]}


============================== 11:41:02.776683 | 9f0ee1a7-8826-4c9e-a811-c1bec932e281 ==============================
[0m11:41:02.776683 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:41:02.778493 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/usr/app/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'empty': 'None', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt seed', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/usr/app', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m11:41:02.911004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f0ee1a7-8826-4c9e-a811-c1bec932e281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0552e850>]}
[0m11:41:02.954057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f0ee1a7-8826-4c9e-a811-c1bec932e281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b08117f50>]}
[0m11:41:02.955830 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:41:02.999287 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:41:03.286685 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:41:03.287993 [debug] [MainThread]: Partial parsing: added file: ecomm://models/gold/dim_sku_360.sql
[0m11:41:03.289038 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:41:03.466162 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:41:03.468427 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.7416964, "process_in_blocks": "0", "process_kernel_time": 0.094833, "process_mem_max_rss": "138848", "process_out_blocks": "0", "process_user_time": 1.401423}
[0m11:41:03.469570 [debug] [MainThread]: Command `dbt seed` failed at 11:41:03.469478 after 0.74 seconds
[0m11:41:03.470482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0556dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0107add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b09d893d0>]}
[0m11:41:03.471372 [debug] [MainThread]: Flushing usage events
[0m11:41:04.737126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:48.324682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787d9b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787d8e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787d8db90>]}


============================== 11:42:48.328049 | 9f11046b-8e43-479b-81f0-6172309e678f ==============================
[0m11:42:48.328049 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:42:48.330126 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/usr/app/logs', 'empty': 'None', 'profiles_dir': '/usr/app', 'warn_error': 'None', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True'}
[0m11:42:48.501765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f11046b-8e43-479b-81f0-6172309e678f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87846b5390>]}
[0m11:42:48.544628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f11046b-8e43-479b-81f0-6172309e678f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878a9d0550>]}
[0m11:42:48.547719 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:42:48.602512 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:42:49.062977 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:42:49.064843 [debug] [MainThread]: Partial parsing: added file: ecomm://models/gold/dim_sku_360.sql
[0m11:42:49.066529 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:42:49.262679 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:42:49.266768 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.99137044, "process_in_blocks": "127480", "process_kernel_time": 0.242701, "process_mem_max_rss": "136060", "process_out_blocks": "0", "process_user_time": 1.308479}
[0m11:42:49.268765 [debug] [MainThread]: Command `dbt seed` failed at 11:42:49.268488 after 0.99 seconds
[0m11:42:49.270583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787dff2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787dd1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878c639410>]}
[0m11:42:49.271633 [debug] [MainThread]: Flushing usage events
[0m11:42:50.215222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:27.218704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a13a0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a1400b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a1395d90>]}


============================== 11:43:27.222006 | acd5e235-95db-400a-83b1-ee3e0ea35ea1 ==============================
[0m11:43:27.222006 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:43:27.223411 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'introspect': 'True', 'log_path': '/usr/app/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'log_cache_events': 'False', 'log_format': 'default', 'static_parser': 'True'}
[0m11:43:27.379432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acd5e235-95db-400a-83b1-ee3e0ea35ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a1403bd0>]}
[0m11:43:27.420228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acd5e235-95db-400a-83b1-ee3e0ea35ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a3fbc650>]}
[0m11:43:27.421853 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:43:27.462072 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:43:27.787142 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:43:27.788043 [debug] [MainThread]: Partial parsing: added file: ecomm://models/gold/dim_sku_360.sql
[0m11:43:27.789154 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:43:27.963677 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:43:27.966030 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.92732674, "process_in_blocks": "0", "process_kernel_time": 0.128403, "process_mem_max_rss": "138868", "process_out_blocks": "0", "process_user_time": 1.316135}
[0m11:43:27.968090 [debug] [MainThread]: Command `dbt seed` failed at 11:43:27.967994 after 0.93 seconds
[0m11:43:27.969688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a1554910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489d154610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a5c24610>]}
[0m11:43:27.971671 [debug] [MainThread]: Flushing usage events
[0m11:43:29.040493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:10.084452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc413090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc472590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc6d0a10>]}


============================== 11:46:10.088189 | e4676313-f098-4fb9-b2d4-6179a46b5b90 ==============================
[0m11:46:10.088189 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:46:10.089801 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'profiles_dir': '/usr/app', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'empty': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt seed --full-refresh', 'write_json': 'True'}
[0m11:46:10.262631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4676313-f098-4fb9-b2d4-6179a46b5b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ce154bd0>]}
[0m11:46:10.307183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4676313-f098-4fb9-b2d4-6179a46b5b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cf027890>]}
[0m11:46:10.310363 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:46:10.357817 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:46:11.459510 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:46:11.461321 [debug] [MainThread]: Partial parsing: added file: ecomm://models/gold/dim_sku_360.sql
[0m11:46:11.462282 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:46:12.438591 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:46:12.442907 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.9969972, "process_in_blocks": "128344", "process_kernel_time": 0.16405, "process_mem_max_rss": "134208", "process_out_blocks": "0", "process_user_time": 1.443648}
[0m11:46:12.444111 [debug] [MainThread]: Command `dbt seed` failed at 11:46:12.444016 after 1.00 seconds
[0m11:46:12.444820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc473990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5c8255050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d0c9c510>]}
[0m11:46:12.446012 [debug] [MainThread]: Flushing usage events
[0m11:46:13.387861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:29.560782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8e23e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8e51950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8fd8550>]}


============================== 11:46:29.564007 | 2306f565-8d69-40dc-b68b-c51c80f28439 ==============================
[0m11:46:29.564007 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:46:29.565313 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run -s models/staging', 'fail_fast': 'False', 'debug': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/app', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'introspect': 'True'}
[0m11:46:29.704119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2306f565-8d69-40dc-b68b-c51c80f28439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8ceec10>]}
[0m11:46:29.746089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2306f565-8d69-40dc-b68b-c51c80f28439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20eba3cfd0>]}
[0m11:46:29.748384 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:46:29.790886 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:46:30.059137 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:46:30.060089 [debug] [MainThread]: Partial parsing: added file: ecomm://models/gold/dim_sku_360.sql
[0m11:46:30.061379 [debug] [MainThread]: Partial parsing: deleted file: ecomm://models/gold/dim_sku.sql
[0m11:46:30.235982 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecomm.dim_sku_360' (models/gold/dim_sku_360.sql) depends on a node named 'dim_sku' which was not found
[0m11:46:30.238126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73367685, "process_in_blocks": "0", "process_kernel_time": 0.115607, "process_mem_max_rss": "136876", "process_out_blocks": "0", "process_user_time": 1.366271}
[0m11:46:30.239573 [debug] [MainThread]: Command `dbt run` failed at 11:46:30.239458 after 0.74 seconds
[0m11:46:30.240987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ed8196d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8e8ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8e8b410>]}
[0m11:46:30.242428 [debug] [MainThread]: Flushing usage events
[0m11:46:31.283089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:46.500221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e841d1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e86f97350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e84228f90>]}


============================== 11:49:46.504280 | 06feac0d-d0b8-4bf9-954b-a7e200d00760 ==============================
[0m11:49:46.504280 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:49:46.505896 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True'}
[0m11:49:46.597513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06feac0d-d0b8-4bf9-954b-a7e200d00760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e84205150>]}
[0m11:49:46.723410 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.35408974, "process_in_blocks": "98008", "process_kernel_time": 0.130263, "process_mem_max_rss": "105328", "process_out_blocks": "0", "process_user_time": 1.020399}
[0m11:49:46.724990 [debug] [MainThread]: Command `dbt clean` succeeded at 11:49:46.724890 after 0.36 seconds
[0m11:49:46.725913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e84384350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e84207f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e842046d0>]}
[0m11:49:46.726712 [debug] [MainThread]: Flushing usage events
[0m11:49:47.729834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:58.925189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981350a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797e908350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981331290>]}


============================== 11:49:58.928283 | a0c3adc4-87d9-4165-acf1-de39cbe6b776 ==============================
[0m11:49:58.928283 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:49:58.929566 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt parse', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/usr/app', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/usr/app/logs', 'empty': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False'}
[0m11:49:59.091079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0c3adc4-87d9-4165-acf1-de39cbe6b776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797e61c0d0>]}
[0m11:49:59.132073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0c3adc4-87d9-4165-acf1-de39cbe6b776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981364190>]}
[0m11:49:59.135550 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:49:59.180003 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:49:59.182895 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:49:59.183979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0c3adc4-87d9-4165-acf1-de39cbe6b776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797a563e90>]}
[0m11:49:59.358473 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ecomm: schema.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | docker compose exec dbt bash -lc "cat > /usr/app/seeds/schema.yml <<'YAML'
    2  | version: 2
    3  | seeds:
    4  |   - name: dim_sku
    5  |     description: Static SKU dimension (category lookup)
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 8
[0m11:49:59.360011 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.48806536, "process_in_blocks": "28896", "process_kernel_time": 0.074854, "process_mem_max_rss": "126612", "process_out_blocks": "0", "process_user_time": 1.122824}
[0m11:49:59.361256 [debug] [MainThread]: Command `dbt parse` failed at 11:49:59.361125 after 0.49 seconds
[0m11:49:59.362328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797f743850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797e7d2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797a793f50>]}
[0m11:49:59.363413 [debug] [MainThread]: Flushing usage events
[0m11:50:00.422583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:08.610125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6c26e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6c26ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6c26d410>]}


============================== 11:52:08.613394 | bfa9a2ac-fc15-4126-8d15-d1bbc49a4f49 ==============================
[0m11:52:08.613394 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:52:08.614980 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'None', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/usr/app', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/app/logs', 'target_path': 'None', 'invocation_command': 'dbt parse', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m11:52:08.788018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa9a2ac-fc15-4126-8d15-d1bbc49a4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6c0c1610>]}
[0m11:52:08.831440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa9a2ac-fc15-4126-8d15-d1bbc49a4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6ee2c410>]}
[0m11:52:08.834108 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:52:08.877784 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:52:08.880450 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:52:08.881689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfa9a2ac-fc15-4126-8d15-d1bbc49a4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6c0dd090>]}
[0m11:52:09.077566 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ecomm: schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | docker compose exec dbt bash -lc @'
    2  | cat > /usr/app/seeds/schema.yml <<'YAML'
    3  | version: 2
    4  | seeds:
    5  |   - name: dim_sku
    6  |     description: Static SKU dimension (category lookup)
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m11:52:09.080622 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.5217739, "process_in_blocks": "126392", "process_kernel_time": 0.17141, "process_mem_max_rss": "126404", "process_out_blocks": "0", "process_user_time": 1.119209}
[0m11:52:09.082271 [debug] [MainThread]: Command `dbt parse` failed at 11:52:09.082160 after 0.52 seconds
[0m11:52:09.083811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6c211b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d68026850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d68043f50>]}
[0m11:52:09.085533 [debug] [MainThread]: Flushing usage events
[0m11:52:10.107705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:40.719172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182be3ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182c2e8a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182be2dd90>]}


============================== 11:53:40.723013 | f73688f4-7f2e-4181-bc71-810d54c8c22a ==============================
[0m11:53:40.723013 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:53:40.724460 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True'}
[0m11:53:40.813378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f73688f4-7f2e-4181-bc71-810d54c8c22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182bd852d0>]}
[0m11:53:40.839983 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17325492, "process_in_blocks": "98008", "process_kernel_time": 0.142394, "process_mem_max_rss": "105224", "process_out_blocks": "0", "process_user_time": 1.017102}
[0m11:53:40.841190 [debug] [MainThread]: Command `dbt clean` succeeded at 11:53:40.841092 after 0.17 seconds
[0m11:53:40.842329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182c0f87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182bd6d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18306bced0>]}
[0m11:53:40.843565 [debug] [MainThread]: Flushing usage events
[0m11:53:41.739707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:49.561195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77e8bc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77eb274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77eb24890>]}


============================== 11:53:49.565030 | c4994669-b689-4dc6-acb2-e7e17b88b8df ==============================
[0m11:53:49.565030 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:53:49.566553 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'no_print': 'None', 'invocation_command': 'dbt parse', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m11:53:49.750170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4994669-b689-4dc6-acb2-e7e17b88b8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77a913850>]}
[0m11:53:49.796412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4994669-b689-4dc6-acb2-e7e17b88b8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb781498a50>]}
[0m11:53:49.801676 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:53:49.848395 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:53:49.853220 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:53:49.854559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4994669-b689-4dc6-acb2-e7e17b88b8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77a912650>]}
[0m11:53:50.027857 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ecomm: schema.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | docker compose exec dbt bash -lc "cat > /usr/app/seeds/schema.yml <<'YAML'
    2  | version: 2
    3  | seeds:
    4  |   - name: dim_sku
    5  |     description: Static SKU dimension (category lookup)
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 8
[0m11:53:50.029573 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.53959924, "process_in_blocks": "29152", "process_kernel_time": 0.114171, "process_mem_max_rss": "127448", "process_out_blocks": "0", "process_user_time": 1.152092}
[0m11:53:50.030774 [debug] [MainThread]: Command `dbt parse` failed at 11:53:50.030681 after 0.54 seconds
[0m11:53:50.031610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77e894850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77e897f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77a632310>]}
[0m11:53:50.032449 [debug] [MainThread]: Flushing usage events
[0m11:53:50.956700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:33.097403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c3b02750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c3b02290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c3b024d0>]}


============================== 11:56:33.101587 | 1dbba1a8-97c0-40ae-a0a5-7b3e8a8ec170 ==============================
[0m11:56:33.101587 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:56:33.103007 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt clean', 'fail_fast': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/usr/app/logs', 'no_print': 'None', 'profiles_dir': '/usr/app', 'printer_width': '80', 'warn_error': 'None'}
[0m11:56:33.196382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbba1a8-97c0-40ae-a0a5-7b3e8a8ec170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c3af2190>]}
[0m11:56:33.217057 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18419977, "process_in_blocks": "98008", "process_kernel_time": 0.112974, "process_mem_max_rss": "105332", "process_out_blocks": "0", "process_user_time": 1.095848}
[0m11:56:33.218167 [debug] [MainThread]: Command `dbt clean` succeeded at 11:56:33.218074 after 0.19 seconds
[0m11:56:33.219462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c398a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c398a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c38b7f50>]}
[0m11:56:33.221025 [debug] [MainThread]: Flushing usage events
[0m11:56:34.128962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:43.345570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b01a3a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b01a39e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b01a39250>]}


============================== 11:56:43.348692 | 4bc3a8a3-926a-4cd4-8ff9-53d63332833a ==============================
[0m11:56:43.348692 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:56:43.350896 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/app/logs', 'quiet': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt parse'}
[0m11:56:43.548787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bc3a8a3-926a-4cd4-8ff9-53d63332833a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b018e6d50>]}
[0m11:56:43.594683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bc3a8a3-926a-4cd4-8ff9-53d63332833a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b04657b90>]}
[0m11:56:43.597222 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:56:43.644814 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:56:43.649856 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:56:43.651142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4bc3a8a3-926a-4cd4-8ff9-53d63332833a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0190c050>]}
[0m11:56:43.907504 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ecomm: schema.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |         tests: [not_null, unique]
    8  |       - name: category
    9  | YAML"
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 9, column 1
    could not find expected ':'
      in "<unicode string>", line 10, column 1
[0m11:56:43.909176 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.6283871, "process_in_blocks": "28896", "process_kernel_time": 0.104105, "process_mem_max_rss": "126800", "process_out_blocks": "0", "process_user_time": 1.165982}
[0m11:56:43.910148 [debug] [MainThread]: Command `dbt parse` failed at 11:56:43.910048 after 0.63 seconds
[0m11:56:43.911063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b01a3b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b01a6d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b018ed810>]}
[0m11:56:43.911914 [debug] [MainThread]: Flushing usage events
[0m11:56:44.745781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:03.907830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3a91f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3c60150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3be02d0>]}


============================== 11:59:03.911425 | 032f6344-2025-42e1-adef-256600beed05 ==============================
[0m11:59:03.911425 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:59:03.912843 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt clean', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'empty': 'None', 'log_format': 'default', 'profiles_dir': '/usr/app'}
[0m11:59:04.005251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032f6344-2025-42e1-adef-256600beed05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3985d10>]}
[0m11:59:04.031795 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18635584, "process_in_blocks": "98008", "process_kernel_time": 0.152095, "process_mem_max_rss": "105332", "process_out_blocks": "0", "process_user_time": 1.013969}
[0m11:59:04.033455 [debug] [MainThread]: Command `dbt clean` succeeded at 11:59:04.033379 after 0.19 seconds
[0m11:59:04.035040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3aa31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3af9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b3af9910>]}
[0m11:59:04.036560 [debug] [MainThread]: Flushing usage events
[0m11:59:04.928203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:11.407459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f966250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f995a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7faa0250>]}


============================== 11:59:11.410214 | bd93b501-8b71-4711-b728-4532114e91a6 ==============================
[0m11:59:11.410214 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:59:11.411620 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/app', 'partial_parse': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_path': '/usr/app/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'invocation_command': 'dbt parse', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'None'}
[0m11:59:11.583278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd93b501-8b71-4711-b728-4532114e91a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f835150>]}
[0m11:59:11.627196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd93b501-8b71-4711-b728-4532114e91a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f8341d0>]}
[0m11:59:11.629337 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:59:11.675139 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:59:11.677905 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:59:11.679305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd93b501-8b71-4711-b728-4532114e91a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f81d490>]}
[0m11:59:13.269459 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""warehouse"."main_main"."dim_user"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - model.ecomm.dim_user (models/gold/dim_user.sql)
  - seed.ecomm.dim_user (seeds/dim_user.csv)
[0m11:59:13.271033 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.9189585, "process_in_blocks": "31032", "process_kernel_time": 0.113081, "process_mem_max_rss": "138648", "process_out_blocks": "0", "process_user_time": 2.220517}
[0m11:59:13.272763 [debug] [MainThread]: Command `dbt parse` failed at 11:59:13.272655 after 1.92 seconds
[0m11:59:13.274389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f967210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f995950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc80d61b10>]}
[0m11:59:13.276059 [debug] [MainThread]: Flushing usage events
[0m11:59:14.135676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:03.011845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa617be290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa617b2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa61974450>]}


============================== 12:02:03.016616 | 28f1da62-dc63-40d9-8ac0-e9d6bec78e73 ==============================
[0m12:02:03.016616 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:02:03.018338 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'empty': 'None', 'log_path': '/usr/app/logs', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': '/usr/app', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m12:02:03.112778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28f1da62-dc63-40d9-8ac0-e9d6bec78e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa61826f90>]}
[0m12:02:03.155221 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21003132, "process_in_blocks": "98008", "process_kernel_time": 0.161144, "process_mem_max_rss": "105144", "process_out_blocks": "0", "process_user_time": 1.107871}
[0m12:02:03.157068 [debug] [MainThread]: Command `dbt clean` succeeded at 12:02:03.156682 after 0.21 seconds
[0m12:02:03.158606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa61826f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa61824d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa61558f50>]}
[0m12:02:03.159630 [debug] [MainThread]: Flushing usage events
[0m12:02:04.171792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:09.498555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f3653cb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f364ea250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f364e09d0>]}


============================== 12:02:09.501946 | f7f9cd9c-4c05-4b9b-b6e8-b66c4dfd302c ==============================
[0m12:02:09.501946 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:02:09.503544 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt parse', 'log_format': 'default', 'log_path': '/usr/app/logs', 'empty': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/usr/app', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'version_check': 'True'}
[0m12:02:09.669566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7f9cd9c-4c05-4b9b-b6e8-b66c4dfd302c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f363933d0>]}
[0m12:02:09.713384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7f9cd9c-4c05-4b9b-b6e8-b66c4dfd302c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f39102050>]}
[0m12:02:09.717529 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:02:09.763576 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:02:09.766382 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:02:09.767567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f7f9cd9c-4c05-4b9b-b6e8-b66c4dfd302c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f3639a410>]}
[0m12:02:11.032916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7f9cd9c-4c05-4b9b-b6e8-b66c4dfd302c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f32330810>]}
[0m12:02:11.043296 [info ] [MainThread]: Performance info: /usr/app/target/perf_info.json
[0m12:02:11.144816 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:02:11.149890 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:02:11.152326 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.7241404, "process_in_blocks": "31040", "process_kernel_time": 0.102944, "process_mem_max_rss": "143588", "process_out_blocks": "0", "process_user_time": 2.285378}
[0m12:02:11.153376 [debug] [MainThread]: Command `dbt parse` succeeded at 12:02:11.153270 after 1.73 seconds
[0m12:02:11.154294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f366a46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f364d5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f364d5690>]}
[0m12:02:11.155463 [debug] [MainThread]: Flushing usage events
[0m12:02:12.160938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:22.215304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d2896990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d4ee6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d462da50>]}


============================== 12:02:22.219183 | 44c990e9-bbcc-44a7-ada3-4487c0cf8706 ==============================
[0m12:02:22.219183 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:02:22.221010 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '/usr/app', 'version_check': 'True', 'quiet': 'False', 'invocation_command': 'dbt seed --select dim_sku', 'log_path': '/usr/app/logs', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False'}
[0m12:02:22.358698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44c990e9-bbcc-44a7-ada3-4487c0cf8706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d384a650>]}
[0m12:02:22.404666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44c990e9-bbcc-44a7-ada3-4487c0cf8706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d5472010>]}
[0m12:02:22.406783 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:02:22.481183 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:02:22.789968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:22.791088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:22.834910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44c990e9-bbcc-44a7-ada3-4487c0cf8706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ce410d10>]}
[0m12:02:22.923471 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:02:22.928681 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:02:22.951829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44c990e9-bbcc-44a7-ada3-4487c0cf8706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d28f61d0>]}
[0m12:02:22.953708 [info ] [MainThread]: Found 14 models, 2 seeds, 2 data tests, 4 sources, 426 macros
[0m12:02:22.955430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44c990e9-bbcc-44a7-ada3-4487c0cf8706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d276cd10>]}
[0m12:02:22.958167 [info ] [MainThread]: 
[0m12:02:22.959888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:22.961614 [info ] [MainThread]: 
[0m12:02:22.963915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:22.966167 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m12:02:22.999108 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m12:02:23.000920 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m12:02:23.002265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:23.104410 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m12:02:23.106807 [debug] [ThreadPool]: On list_warehouse: Close
[0m12:02:23.111095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m12:02:23.112590 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m12:02:23.118204 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:23.119887 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m12:02:23.121218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:23.157061 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:02:23.159494 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:23.161156 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m12:02:23.163016 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:23.164102 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:23.165264 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m12:02:23.168072 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:02:23.169907 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m12:02:23.171064 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:23.172197 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m12:02:23.173980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:23.175131 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m12:02:23.183133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m12:02:23.188133 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m12:02:23.189338 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m12:02:23.190409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:23.227833 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m12:02:23.229583 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m12:02:23.230944 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m12:02:23.242752 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:02:23.245086 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m12:02:23.247081 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m12:02:23.248360 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m12:02:23.253078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44c990e9-bbcc-44a7-ada3-4487c0cf8706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ce6869d0>]}
[0m12:02:23.254272 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:23.255546 [debug] [MainThread]: On master: BEGIN
[0m12:02:23.256868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:23.294365 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m12:02:23.296734 [debug] [MainThread]: On master: COMMIT
[0m12:02:23.298405 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:23.299411 [debug] [MainThread]: On master: COMMIT
[0m12:02:23.300776 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:23.302101 [debug] [MainThread]: On master: Close
[0m12:02:23.310075 [debug] [Thread-1 (]: Began running node seed.ecomm.dim_sku
[0m12:02:23.311696 [info ] [Thread-1 (]: 1 of 1 START seed file main_main.dim_sku ....................................... [RUN]
[0m12:02:23.313463 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ecomm.dim_sku'
[0m12:02:23.314829 [debug] [Thread-1 (]: Began compiling node seed.ecomm.dim_sku
[0m12:02:23.316178 [debug] [Thread-1 (]: Began executing node seed.ecomm.dim_sku
[0m12:02:23.386400 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:23.387586 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: BEGIN
[0m12:02:23.388501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:23.423130 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m12:02:23.424986 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:23.426300 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "seed.ecomm.dim_sku"} */
truncate table "warehouse"."main_main"."dim_sku"
[0m12:02:23.431018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:23.441369 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:23.443000 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: 
          COPY "warehouse"."main_main"."dim_sku" FROM '/usr/app/seeds/dim_sku.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:02:23.462074 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m12:02:23.468155 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecomm.dim_sku"
[0m12:02:23.504143 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: COMMIT
[0m12:02:23.505835 [debug] [Thread-1 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:23.506681 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: COMMIT
[0m12:02:23.516400 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m12:02:23.518415 [debug] [Thread-1 (]: On seed.ecomm.dim_sku: Close
[0m12:02:23.547193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44c990e9-bbcc-44a7-ada3-4487c0cf8706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cd8df4d0>]}
[0m12:02:23.548954 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main_main.dim_sku ................................... [[32mINSERT 3[0m in 0.23s]
[0m12:02:23.550474 [debug] [Thread-1 (]: Finished running node seed.ecomm.dim_sku
[0m12:02:23.552958 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:23.554615 [debug] [MainThread]: On master: BEGIN
[0m12:02:23.556024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:23.591514 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m12:02:23.593479 [debug] [MainThread]: On master: COMMIT
[0m12:02:23.595050 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:23.596547 [debug] [MainThread]: On master: COMMIT
[0m12:02:23.598461 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:23.599517 [debug] [MainThread]: On master: Close
[0m12:02:23.602566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:23.603574 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m12:02:23.604513 [debug] [MainThread]: Connection 'seed.ecomm.dim_sku' was properly closed.
[0m12:02:23.605445 [info ] [MainThread]: 
[0m12:02:23.606634 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m12:02:23.607812 [debug] [MainThread]: Command end result
[0m12:02:23.637957 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:02:23.652176 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:02:23.662334 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:02:23.663264 [info ] [MainThread]: 
[0m12:02:23.664579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:23.665826 [info ] [MainThread]: 
[0m12:02:23.667378 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:02:23.669235 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.5158803, "process_in_blocks": "132432", "process_kernel_time": 0.348741, "process_mem_max_rss": "208448", "process_out_blocks": "0", "process_user_time": 2.203024}
[0m12:02:23.670953 [debug] [MainThread]: Command `dbt seed` succeeded at 12:02:23.670849 after 1.52 seconds
[0m12:02:23.672493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d2d48c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d70e4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d70e5190>]}
[0m12:02:23.674437 [debug] [MainThread]: Flushing usage events
[0m12:02:24.539882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:34.755579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff628775010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff628928610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff628774dd0>]}


============================== 12:02:34.758414 | 8587d06f-40d0-4a51-aff9-24108d53b584 ==============================
[0m12:02:34.758414 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:02:34.760033 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/usr/app', 'no_print': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m12:02:34.897371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff628779b90>]}
[0m12:02:34.940832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62b35db10>]}
[0m12:02:34.942762 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:02:34.982170 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:02:35.291286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:35.292364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:35.336938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6244e4c50>]}
[0m12:02:35.569892 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:02:35.588963 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:02:35.621159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62415be50>]}
[0m12:02:35.622622 [info ] [MainThread]: Found 14 models, 2 seeds, 2 data tests, 4 sources, 426 macros
[0m12:02:35.626002 [info ] [MainThread]: 
[0m12:02:35.631029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:35.634137 [info ] [MainThread]: 
[0m12:02:35.635768 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:35.641643 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m12:02:35.708369 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m12:02:35.710207 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m12:02:35.712438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:35.755931 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m12:02:35.758847 [debug] [ThreadPool]: On list_warehouse: Close
[0m12:02:35.763309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m12:02:35.764851 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m12:02:35.770534 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:35.772048 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m12:02:35.773254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:35.807491 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m12:02:35.809954 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:35.811197 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m12:02:35.812808 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:35.814103 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:35.815408 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m12:02:35.816969 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:35.818492 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m12:02:35.819747 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m12:02:35.820928 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m12:02:35.822572 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:35.824013 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m12:02:35.828773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m12:02:35.833752 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m12:02:35.834836 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m12:02:35.835744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:35.864914 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m12:02:35.866667 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m12:02:35.867989 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m12:02:35.875174 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m12:02:35.877741 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m12:02:35.879366 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m12:02:35.880811 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m12:02:35.885238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6245bd450>]}
[0m12:02:35.886825 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:35.888314 [debug] [MainThread]: On master: BEGIN
[0m12:02:35.889682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:35.922234 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m12:02:35.924279 [debug] [MainThread]: On master: COMMIT
[0m12:02:35.925976 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:35.927326 [debug] [MainThread]: On master: COMMIT
[0m12:02:35.928952 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:35.930243 [debug] [MainThread]: On master: Close
[0m12:02:35.935167 [debug] [Thread-1 (]: Began running node model.ecomm.stg_add_to_cart
[0m12:02:35.935455 [debug] [Thread-2 (]: Began running node model.ecomm.stg_order_placed
[0m12:02:35.935712 [debug] [Thread-3 (]: Began running node model.ecomm.stg_page_view
[0m12:02:35.935958 [debug] [Thread-4 (]: Began running node seed.ecomm.dim_sku
[0m12:02:35.936942 [info ] [Thread-1 (]: 1 of 18 START sql view model main_main.stg_add_to_cart ......................... [RUN]
[0m12:02:35.938310 [info ] [Thread-2 (]: 2 of 18 START sql view model main_main.stg_order_placed ........................ [RUN]
[0m12:02:35.939517 [info ] [Thread-3 (]: 3 of 18 START sql view model main_main.stg_page_view ........................... [RUN]
[0m12:02:35.940699 [info ] [Thread-4 (]: 4 of 18 START seed file main_main.dim_sku ...................................... [RUN]
[0m12:02:35.942017 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.stg_add_to_cart'
[0m12:02:35.943312 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.stg_order_placed'
[0m12:02:35.944581 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.stg_page_view'
[0m12:02:35.945958 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ecomm.dim_sku'
[0m12:02:35.947289 [debug] [Thread-1 (]: Began compiling node model.ecomm.stg_add_to_cart
[0m12:02:35.948436 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_order_placed
[0m12:02:35.949758 [debug] [Thread-3 (]: Began compiling node model.ecomm.stg_page_view
[0m12:02:35.950990 [debug] [Thread-4 (]: Began compiling node seed.ecomm.dim_sku
[0m12:02:35.957810 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.stg_add_to_cart"
[0m12:02:35.960490 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_order_placed"
[0m12:02:35.964291 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.stg_page_view"
[0m12:02:35.965413 [debug] [Thread-4 (]: Began executing node seed.ecomm.dim_sku
[0m12:02:35.995743 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:35.998308 [debug] [Thread-4 (]: On seed.ecomm.dim_sku: BEGIN
[0m12:02:35.999197 [debug] [Thread-1 (]: Began executing node model.ecomm.stg_add_to_cart
[0m12:02:36.000332 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:02:36.000585 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_order_placed
[0m12:02:36.007511 [debug] [Thread-3 (]: Began executing node model.ecomm.stg_page_view
[0m12:02:36.023157 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.stg_add_to_cart"
[0m12:02:36.027576 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_order_placed"
[0m12:02:36.031512 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.stg_page_view"
[0m12:02:36.061416 [debug] [Thread-4 (]: SQL status: OK in 0.061 seconds
[0m12:02:36.062964 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m12:02:36.063306 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m12:02:36.063587 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:36.064895 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: BEGIN
[0m12:02:36.066469 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: BEGIN
[0m12:02:36.066806 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m12:02:36.068010 [debug] [Thread-4 (]: On seed.ecomm.dim_sku: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "seed.ecomm.dim_sku"} */
truncate table "warehouse"."main_main"."dim_sku"
[0m12:02:36.069715 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:02:36.071511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:36.072872 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: BEGIN
[0m12:02:36.075449 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:02:36.076286 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m12:02:36.078829 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:02:36.079489 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:02:36.088337 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:36.089482 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m12:02:36.091354 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m12:02:36.092295 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m12:02:36.093816 [debug] [Thread-4 (]: On seed.ecomm.dim_sku: 
          COPY "warehouse"."main_main"."dim_sku" FROM '/usr/app/seeds/dim_sku.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:02:36.095191 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */

  
  create view "warehouse"."main_main"."stg_order_placed__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(order_id as varchar)    as order_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  cast(total    as double)     as total,
  line_items,                      -- DuckDB can read LIST<STRUCT{sku,qty,price}>
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/order_placed/**/*.parquet')
  );

[0m12:02:36.096388 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m12:02:36.097698 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */

  
  create view "warehouse"."main_main"."stg_add_to_cart__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  sku,
  cast(qty   as integer)       as qty,
  cast(price as double)        as price,
  cast(qty * price as double)  as line_total,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/add_to_cart/**/*.parquet')
  );

[0m12:02:36.100408 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */

  
  create view "warehouse"."main_main"."stg_page_view__dbt_tmp" as (
    

select
  cast(event_id as varchar)    as event_id,
  cast(user_id  as varchar)    as user_id,
  cast(ts       as timestamp)  as ts,
  url,
  referrer,
  ua,
  session_hint,
  cast(event_date as date)     as event_date,
  cast(ingest_ts  as timestamp) as ingest_ts
from read_parquet('/opt/data/silver/page_view/**/*.parquet')
  );

[0m12:02:36.108812 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m12:02:36.114725 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ecomm.dim_sku"
[0m12:02:36.139149 [debug] [Thread-4 (]: On seed.ecomm.dim_sku: COMMIT
[0m12:02:36.140833 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_sku"
[0m12:02:36.142258 [debug] [Thread-4 (]: On seed.ecomm.dim_sku: COMMIT
[0m12:02:36.158470 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m12:02:36.161533 [debug] [Thread-4 (]: On seed.ecomm.dim_sku: Close
[0m12:02:36.164312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62478da10>]}
[0m12:02:36.166373 [info ] [Thread-4 (]: 4 of 18 OK loaded seed file main_main.dim_sku .................................. [[32mINSERT 3[0m in 0.22s]
[0m12:02:36.168030 [debug] [Thread-4 (]: Finished running node seed.ecomm.dim_sku
[0m12:02:36.169846 [debug] [Thread-4 (]: Began running node seed.ecomm.dim_user_1
[0m12:02:36.171444 [info ] [Thread-4 (]: 5 of 18 START seed file main_main.dim_user_1 ................................... [RUN]
[0m12:02:36.172851 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ecomm.dim_sku, now seed.ecomm.dim_user_1)
[0m12:02:36.174612 [debug] [Thread-4 (]: Began compiling node seed.ecomm.dim_user_1
[0m12:02:36.176409 [debug] [Thread-4 (]: Began executing node seed.ecomm.dim_user_1
[0m12:02:36.189643 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_user_1"
[0m12:02:36.191346 [debug] [Thread-4 (]: On seed.ecomm.dim_user_1: BEGIN
[0m12:02:36.193054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:36.194894 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:02:36.196190 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_user_1"
[0m12:02:36.197567 [debug] [Thread-4 (]: On seed.ecomm.dim_user_1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "seed.ecomm.dim_user_1"} */

    create table "warehouse"."main_main"."dim_user_1" (user_id text,user_tier text)
  
[0m12:02:36.199306 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:02:36.201309 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_user_1"
[0m12:02:36.202584 [debug] [Thread-4 (]: On seed.ecomm.dim_user_1: 
          COPY "warehouse"."main_main"."dim_user_1" FROM '/usr/app/seeds/dim_user_1.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:02:36.214343 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m12:02:36.216382 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ecomm.dim_user_1"
[0m12:02:36.233748 [debug] [Thread-4 (]: On seed.ecomm.dim_user_1: COMMIT
[0m12:02:36.235776 [debug] [Thread-4 (]: Using duckdb connection "seed.ecomm.dim_user_1"
[0m12:02:36.237219 [debug] [Thread-4 (]: On seed.ecomm.dim_user_1: COMMIT
[0m12:02:36.244823 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:02:36.246892 [debug] [Thread-4 (]: On seed.ecomm.dim_user_1: Close
[0m12:02:36.248535 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62415ae10>]}
[0m12:02:36.250163 [info ] [Thread-4 (]: 5 of 18 OK loaded seed file main_main.dim_user_1 ............................... [[32mINSERT 5[0m in 0.08s]
[0m12:02:36.251987 [debug] [Thread-4 (]: Finished running node seed.ecomm.dim_user_1
[0m12:02:36.253499 [debug] [Thread-4 (]: Began running node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m12:02:36.254676 [info ] [Thread-4 (]: 6 of 18 START test not_null_dim_sku_sku ........................................ [RUN]
[0m12:02:36.255778 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ecomm.dim_user_1, now test.ecomm.not_null_dim_sku_sku.0ac6a5e44c)
[0m12:02:36.256896 [debug] [Thread-4 (]: Began compiling node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m12:02:36.266406 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m12:02:36.295810 [debug] [Thread-4 (]: Began executing node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m12:02:36.309969 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m12:02:36.338491 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m12:02:36.340529 [debug] [Thread-4 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: BEGIN
[0m12:02:36.342357 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:36.344188 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:02:36.346308 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"
[0m12:02:36.348002 [debug] [Thread-4 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.not_null_dim_sku_sku.0ac6a5e44c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from "warehouse"."main_main"."dim_sku"
where sku is null



  
  
      
    ) dbt_internal_test
[0m12:02:36.351493 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:02:36.355210 [debug] [Thread-4 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: ROLLBACK
[0m12:02:36.356762 [debug] [Thread-4 (]: Failed to rollback 'test.ecomm.not_null_dim_sku_sku.0ac6a5e44c'
[0m12:02:36.358685 [debug] [Thread-4 (]: On test.ecomm.not_null_dim_sku_sku.0ac6a5e44c: Close
[0m12:02:36.360362 [info ] [Thread-4 (]: 6 of 18 PASS not_null_dim_sku_sku .............................................. [[32mPASS[0m in 0.10s]
[0m12:02:36.361794 [debug] [Thread-4 (]: Finished running node test.ecomm.not_null_dim_sku_sku.0ac6a5e44c
[0m12:02:36.363122 [debug] [Thread-4 (]: Began running node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m12:02:36.365004 [info ] [Thread-4 (]: 7 of 18 START test unique_dim_sku_sku .......................................... [RUN]
[0m12:02:36.366830 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ecomm.not_null_dim_sku_sku.0ac6a5e44c, now test.ecomm.unique_dim_sku_sku.5799afeb02)
[0m12:02:36.368739 [debug] [Thread-4 (]: Began compiling node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m12:02:36.374542 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m12:02:36.388951 [debug] [Thread-4 (]: Began executing node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m12:02:36.393607 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m12:02:36.409205 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m12:02:36.411597 [debug] [Thread-4 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: BEGIN
[0m12:02:36.414120 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:36.416594 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:02:36.419113 [debug] [Thread-4 (]: Using duckdb connection "test.ecomm.unique_dim_sku_sku.5799afeb02"
[0m12:02:36.421148 [debug] [Thread-4 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "test.ecomm.unique_dim_sku_sku.5799afeb02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sku as unique_field,
    count(*) as n_records

from "warehouse"."main_main"."dim_sku"
where sku is not null
group by sku
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:02:36.427584 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:02:36.430056 [debug] [Thread-4 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: ROLLBACK
[0m12:02:36.431842 [debug] [Thread-4 (]: Failed to rollback 'test.ecomm.unique_dim_sku_sku.5799afeb02'
[0m12:02:36.433595 [debug] [Thread-4 (]: On test.ecomm.unique_dim_sku_sku.5799afeb02: Close
[0m12:02:36.435649 [info ] [Thread-4 (]: 7 of 18 PASS unique_dim_sku_sku ................................................ [[32mPASS[0m in 0.07s]
[0m12:02:36.437507 [debug] [Thread-4 (]: Finished running node test.ecomm.unique_dim_sku_sku.5799afeb02
[0m12:02:37.783780 [debug] [Thread-2 (]: SQL status: OK in 1.684 seconds
[0m12:02:37.789570 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m12:02:37.790462 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
alter view "warehouse"."main_main"."stg_order_placed__dbt_tmp" rename to "stg_order_placed"
[0m12:02:37.791747 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:02:37.793168 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m12:02:37.794889 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m12:02:37.796367 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: COMMIT
[0m12:02:37.801343 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:02:37.805775 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_order_placed"
[0m12:02:37.806529 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_order_placed"} */
drop view if exists "warehouse"."main_main"."stg_order_placed__dbt_backup" cascade
[0m12:02:37.807860 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:37.810015 [debug] [Thread-2 (]: On model.ecomm.stg_order_placed: Close
[0m12:02:37.811829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6247b4310>]}
[0m12:02:37.812969 [info ] [Thread-2 (]: 2 of 18 OK created sql view model main_main.stg_order_placed ................... [[32mOK[0m in 1.87s]
[0m12:02:37.814665 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_order_placed
[0m12:02:37.816902 [debug] [Thread-4 (]: Began running node model.ecomm.fct_daily_sales
[0m12:02:37.817178 [debug] [Thread-2 (]: Began running node model.ecomm.fct_order_items
[0m12:02:37.818645 [info ] [Thread-4 (]: 8 of 18 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m12:02:37.819962 [info ] [Thread-2 (]: 9 of 18 START sql view model main_main.fct_order_items ......................... [RUN]
[0m12:02:37.821759 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ecomm.unique_dim_sku_sku.5799afeb02, now model.ecomm.fct_daily_sales)
[0m12:02:37.823020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_order_placed, now model.ecomm.fct_order_items)
[0m12:02:37.824395 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_daily_sales
[0m12:02:37.825561 [debug] [Thread-2 (]: Began compiling node model.ecomm.fct_order_items
[0m12:02:37.829494 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m12:02:37.833260 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m12:02:37.847402 [debug] [Thread-2 (]: Began executing node model.ecomm.fct_order_items
[0m12:02:37.852299 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m12:02:37.852769 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_daily_sales
[0m12:02:37.857410 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m12:02:37.868168 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m12:02:37.869927 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: BEGIN
[0m12:02:37.870672 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m12:02:37.871491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:37.872654 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m12:02:37.874774 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:02:37.875289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:37.876652 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m12:02:37.878710 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:02:37.879673 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main_main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  u.li.sku      as sku,
  u.li.qty      as qty,
  u.li.price    as price,
  u.li.qty * u.li.price as line_total
from orders o
cross join unnest(o.line_items) as u(li)   -- u = table alias, li = column alias (STRUCT)
  );

[0m12:02:37.880995 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m12:02:37.883424 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main_main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m12:02:39.020763 [debug] [Thread-4 (]: SQL status: OK in 1.136 seconds
[0m12:02:39.023997 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m12:02:39.024295 [debug] [Thread-2 (]: SQL status: OK in 1.142 seconds
[0m12:02:39.025333 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:02:39.027966 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m12:02:39.029537 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:02:39.030255 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
alter view "warehouse"."main_main"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m12:02:39.033080 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m12:02:39.034415 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:39.035092 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:02:39.038266 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m12:02:39.040727 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:02:39.041610 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
alter view "warehouse"."main_main"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m12:02:39.045496 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m12:02:39.046604 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:39.047755 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m12:02:39.049233 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: COMMIT
[0m12:02:39.050134 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m12:02:39.050921 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m12:02:39.052828 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: COMMIT
[0m12:02:39.059478 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m12:02:39.064027 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m12:02:39.064379 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m12:02:39.065296 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
drop view if exists "warehouse"."main_main"."fct_daily_sales__dbt_backup" cascade
[0m12:02:39.067966 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m12:02:39.070753 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
drop view if exists "warehouse"."main_main"."fct_order_items__dbt_backup" cascade
[0m12:02:39.071698 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:02:39.074144 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: Close
[0m12:02:39.075166 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:02:39.076030 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff615082650>]}
[0m12:02:39.077482 [debug] [Thread-2 (]: On model.ecomm.fct_order_items: Close
[0m12:02:39.078966 [info ] [Thread-4 (]: 8 of 18 OK created sql view model main_main.fct_daily_sales .................... [[32mOK[0m in 1.25s]
[0m12:02:39.080539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6235ed110>]}
[0m12:02:39.081501 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_daily_sales
[0m12:02:39.082878 [info ] [Thread-2 (]: 9 of 18 OK created sql view model main_main.fct_order_items .................... [[32mOK[0m in 1.26s]
[0m12:02:39.084194 [debug] [Thread-4 (]: Began running node model.ecomm.fct_orders
[0m12:02:39.085293 [debug] [Thread-2 (]: Finished running node model.ecomm.fct_order_items
[0m12:02:39.086547 [info ] [Thread-4 (]: 10 of 18 START sql view model main_main.fct_orders ............................. [RUN]
[0m12:02:39.088064 [debug] [Thread-2 (]: Began running node model.ecomm.dim_sku_360
[0m12:02:39.089123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_daily_sales, now model.ecomm.fct_orders)
[0m12:02:39.090611 [info ] [Thread-2 (]: 11 of 18 START sql table model main_main.dim_sku_360 ........................... [RUN]
[0m12:02:39.091773 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_orders
[0m12:02:39.092852 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.dim_sku_360)
[0m12:02:39.096249 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m12:02:39.097504 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_sku_360
[0m12:02:39.102937 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_sku_360"
[0m12:02:39.110939 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_orders
[0m12:02:39.114659 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m12:02:39.116460 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_sku_360
[0m12:02:39.133448 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_sku_360"
[0m12:02:39.135354 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m12:02:39.136959 [debug] [Thread-4 (]: On model.ecomm.fct_orders: BEGIN
[0m12:02:39.138735 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:39.140745 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:02:39.142471 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m12:02:39.143946 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main_main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m12:02:39.146296 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m12:02:39.147831 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: BEGIN
[0m12:02:39.149713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:39.151905 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:02:39.154055 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m12:02:39.155721 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_sku_360__dbt_tmp"
  
    as (
      

with li as (
  select sku, qty, price, line_total, event_date
  from "warehouse"."main_main"."fct_order_items"
),
agg as (
  select
    sku,
    min(event_date)         as first_sold_date,
    sum(qty)                as units_sold,
    sum(line_total)         as gross_revenue,
    avg(price)              as avg_unit_price
  from li
  group by 1
),
cat as (
  select sku, category
  from "warehouse"."main_main"."dim_sku"
)
select
  a.sku,
  coalesce(c.category, 'Unknown') as category,
  a.first_sold_date,
  a.units_sold,
  a.gross_revenue,
  a.avg_unit_price
from agg a
left join cat c on c.sku = a.sku
    );
  
  
[0m12:02:39.254977 [debug] [Thread-1 (]: SQL status: OK in 3.154 seconds
[0m12:02:39.259046 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m12:02:39.260649 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
alter view "warehouse"."main_main"."stg_add_to_cart__dbt_tmp" rename to "stg_add_to_cart"
[0m12:02:39.263147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:39.265679 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m12:02:39.266689 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m12:02:39.268065 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: COMMIT
[0m12:02:39.275699 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:39.278877 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.stg_add_to_cart"
[0m12:02:39.280315 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_add_to_cart"} */
drop view if exists "warehouse"."main_main"."stg_add_to_cart__dbt_backup" cascade
[0m12:02:39.282593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:39.284707 [debug] [Thread-1 (]: On model.ecomm.stg_add_to_cart: Close
[0m12:02:39.286950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62367a090>]}
[0m12:02:39.288492 [info ] [Thread-1 (]: 1 of 18 OK created sql view model main_main.stg_add_to_cart .................... [[32mOK[0m in 3.34s]
[0m12:02:39.289975 [debug] [Thread-1 (]: Finished running node model.ecomm.stg_add_to_cart
[0m12:02:39.291736 [debug] [Thread-1 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m12:02:39.293104 [info ] [Thread-1 (]: 12 of 18 START sql view model main_main.fct_revenue_by_category_daily .......... [RUN]
[0m12:02:39.295056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_add_to_cart, now model.ecomm.fct_revenue_by_category_daily)
[0m12:02:39.296608 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_revenue_by_category_daily
[0m12:02:39.299858 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_revenue_by_category_daily"
[0m12:02:39.320663 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_revenue_by_category_daily
[0m12:02:39.325088 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_revenue_by_category_daily"
[0m12:02:39.344261 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m12:02:39.345835 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: BEGIN
[0m12:02:39.347629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:39.349714 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:39.352220 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m12:02:39.354201 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_tmp" as (
    

with li as (
  select sku, event_date, line_total
  from "warehouse"."main_main"."fct_order_items"
),
cat as (
  select sku, category
  from "warehouse"."main_main"."dim_sku"   -- seed with (sku, category)
)
select
  li.event_date,
  coalesce(cat.category, 'Unknown') as category,
  sum(li.line_total)                as revenue
from li
left join cat on cat.sku = li.sku
group by 1,2
order by 1,2
  );

[0m12:02:41.191154 [debug] [Thread-3 (]: SQL status: OK in 5.089 seconds
[0m12:02:41.195985 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m12:02:41.197366 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
alter view "warehouse"."main_main"."stg_page_view__dbt_tmp" rename to "stg_page_view"
[0m12:02:41.199661 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:02:41.202324 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m12:02:41.204692 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m12:02:41.206766 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: COMMIT
[0m12:02:41.214890 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:02:41.218696 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.stg_page_view"
[0m12:02:41.221986 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_page_view"} */
drop view if exists "warehouse"."main_main"."stg_page_view__dbt_backup" cascade
[0m12:02:41.224128 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:02:41.228576 [debug] [Thread-3 (]: On model.ecomm.stg_page_view: Close
[0m12:02:41.230533 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6150a1cd0>]}
[0m12:02:41.232344 [info ] [Thread-3 (]: 3 of 18 OK created sql view model main_main.stg_page_view ...................... [[32mOK[0m in 5.29s]
[0m12:02:41.234061 [debug] [Thread-3 (]: Finished running node model.ecomm.stg_page_view
[0m12:02:41.235907 [debug] [Thread-3 (]: Began running node model.ecomm.fct_revenue_daily
[0m12:02:41.237425 [info ] [Thread-3 (]: 13 of 18 START sql view model main_main.fct_revenue_daily ...................... [RUN]
[0m12:02:41.239195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.stg_page_view, now model.ecomm.fct_revenue_daily)
[0m12:02:41.241298 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_revenue_daily
[0m12:02:41.244908 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_revenue_daily"
[0m12:02:41.264833 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_revenue_daily
[0m12:02:41.269801 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_revenue_daily"
[0m12:02:41.293567 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m12:02:41.294792 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: BEGIN
[0m12:02:41.297009 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:02:41.298958 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:02:41.300721 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m12:02:41.302656 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_daily__dbt_tmp" as (
    

with li as (
  select event_date, qty, line_total
  from "warehouse"."main_main"."fct_order_items"
)
select
  event_date,
  sum(line_total)                 as revenue,
  sum(qty)                        as units_sold
from li
group by 1
order by 1
  );

[0m12:02:41.330526 [debug] [Thread-4 (]: SQL status: OK in 2.185 seconds
[0m12:02:41.334915 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m12:02:41.337240 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m12:02:41.339233 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:02:41.342686 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m12:02:41.344027 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m12:02:41.345919 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:02:41.348178 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m12:02:41.350362 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m12:02:41.351824 [debug] [Thread-4 (]: On model.ecomm.fct_orders: COMMIT
[0m12:02:41.358607 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m12:02:41.361963 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m12:02:41.363297 [debug] [Thread-4 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
drop view if exists "warehouse"."main_main"."fct_orders__dbt_backup" cascade
[0m12:02:41.367564 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:02:41.369813 [debug] [Thread-4 (]: On model.ecomm.fct_orders: Close
[0m12:02:41.372037 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62359b1d0>]}
[0m12:02:41.373788 [info ] [Thread-4 (]: 10 of 18 OK created sql view model main_main.fct_orders ........................ [[32mOK[0m in 2.28s]
[0m12:02:41.375377 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_orders
[0m12:02:41.376673 [debug] [Thread-4 (]: Began running node model.ecomm.fct_cart_events
[0m12:02:41.378000 [info ] [Thread-4 (]: 14 of 18 START sql view model main_main.fct_cart_events ........................ [RUN]
[0m12:02:41.379331 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.fct_cart_events)
[0m12:02:41.380873 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_cart_events
[0m12:02:41.384418 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m12:02:41.396911 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_cart_events
[0m12:02:41.400861 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m12:02:41.413892 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m12:02:41.415111 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: BEGIN
[0m12:02:41.416397 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:41.417788 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:02:41.419051 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m12:02:41.420557 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main_main"."stg_add_to_cart"
group by event_date
order by event_date
  );

[0m12:02:41.483370 [debug] [Thread-1 (]: SQL status: OK in 2.127 seconds
[0m12:02:41.487352 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m12:02:41.488564 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */
alter view "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_tmp" rename to "fct_revenue_by_category_daily"
[0m12:02:41.490040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:41.492157 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: COMMIT
[0m12:02:41.493270 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m12:02:41.494399 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: COMMIT
[0m12:02:41.499719 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:02:41.502916 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m12:02:41.504091 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */
drop view if exists "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_backup" cascade
[0m12:02:41.505418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:41.507172 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: Close
[0m12:02:41.508596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62415b0d0>]}
[0m12:02:41.510022 [info ] [Thread-1 (]: 12 of 18 OK created sql view model main_main.fct_revenue_by_category_daily ..... [[32mOK[0m in 2.21s]
[0m12:02:41.511170 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m12:02:41.512326 [debug] [Thread-1 (]: Began running node model.ecomm.daily_funnel
[0m12:02:41.513534 [info ] [Thread-1 (]: 15 of 18 START sql view model main_main.daily_funnel ........................... [RUN]
[0m12:02:41.514789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_revenue_by_category_daily, now model.ecomm.daily_funnel)
[0m12:02:41.516064 [debug] [Thread-1 (]: Began compiling node model.ecomm.daily_funnel
[0m12:02:41.520565 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m12:02:41.531334 [debug] [Thread-1 (]: Began executing node model.ecomm.daily_funnel
[0m12:02:41.535108 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m12:02:41.547364 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m12:02:41.548673 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: BEGIN
[0m12:02:41.550506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:41.552876 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:41.554474 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m12:02:41.556504 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main_main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main_main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main_main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date
  );

[0m12:02:42.838061 [debug] [Thread-2 (]: SQL status: OK in 3.681 seconds
[0m12:02:42.841353 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m12:02:42.842649 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
alter table "warehouse"."main_main"."dim_sku_360" rename to "dim_sku_360__dbt_backup"
[0m12:02:42.844278 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:42.847160 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m12:02:42.848482 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
alter table "warehouse"."main_main"."dim_sku_360__dbt_tmp" rename to "dim_sku_360"
[0m12:02:42.850003 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:42.852070 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: COMMIT
[0m12:02:42.853371 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m12:02:42.854722 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: COMMIT
[0m12:02:42.862246 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m12:02:42.864827 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m12:02:42.866081 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
drop table if exists "warehouse"."main_main"."dim_sku_360__dbt_backup" cascade
[0m12:02:42.869730 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:02:42.872787 [debug] [Thread-2 (]: On model.ecomm.dim_sku_360: Close
[0m12:02:42.877514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff615106750>]}
[0m12:02:42.879379 [info ] [Thread-2 (]: 11 of 18 OK created sql table model main_main.dim_sku_360 ...................... [[32mOK[0m in 3.78s]
[0m12:02:42.880633 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_sku_360
[0m12:02:42.882245 [debug] [Thread-2 (]: Began running node model.ecomm.stg_sessions
[0m12:02:42.886124 [info ] [Thread-2 (]: 16 of 18 START sql view model main_main.stg_sessions ........................... [RUN]
[0m12:02:42.889606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecomm.dim_sku_360, now model.ecomm.stg_sessions)
[0m12:02:42.892074 [debug] [Thread-2 (]: Began compiling node model.ecomm.stg_sessions
[0m12:02:42.896579 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.stg_sessions"
[0m12:02:42.913807 [debug] [Thread-2 (]: Began executing node model.ecomm.stg_sessions
[0m12:02:42.919671 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.stg_sessions"
[0m12:02:42.938322 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m12:02:42.939838 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: BEGIN
[0m12:02:42.941003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:42.943040 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:02:42.944183 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m12:02:42.945185 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */

  
  create view "warehouse"."main_main"."stg_sessions__dbt_tmp" as (
    

with events as (
  select user_id, ts, 'page_view'    as event_type from "warehouse"."main_main"."stg_page_view"
  union all
  select user_id, ts, 'add_to_cart'  as event_type from "warehouse"."main_main"."stg_add_to_cart"
  union all
  select user_id, ts, 'order_placed' as event_type from "warehouse"."main_main"."stg_order_placed"
),
ordered as (
  select
    user_id,
    ts,
    event_type,
    lag(ts) over (partition by user_id order by ts) as prev_ts
  from events
),
marks as (
  select
    *,
    case when prev_ts is null or ts - prev_ts > interval '30 minutes' then 1 else 0 end as is_new_session
  from ordered
),
grp as (
  select
    *,
    sum(is_new_session) over (partition by user_id order by ts rows unbounded preceding) as session_num
  from marks
)
select
  user_id || '|' || strftime('%Y-%m-%dT%H:%M:%S', min(ts)) || '|' || strftime('%Y-%m-%dT%H:%M:%S', max(ts)) as session_id,
  user_id,
  min(ts) as session_start,
  max(ts) as session_end,
  sum(case when event_type='page_view' then 1 else 0 end) as page_count,
  sum(case when event_type='add_to_cart' then 1 else 0 end) as cart_events,
  max(case when event_type='order_placed' then 1 else 0 end) as conversion_flag,
  cast(min(ts) as date) as session_date,
  now() as ingest_ts
from grp
group by user_id, session_num
  );

[0m12:02:43.107528 [debug] [Thread-3 (]: SQL status: OK in 1.803 seconds
[0m12:02:43.111397 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m12:02:43.112204 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */
alter view "warehouse"."main_main"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m12:02:43.114839 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:02:43.117068 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: COMMIT
[0m12:02:43.119581 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m12:02:43.121220 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: COMMIT
[0m12:02:43.129566 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:02:43.132869 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m12:02:43.134620 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */
drop view if exists "warehouse"."main_main"."fct_revenue_daily__dbt_backup" cascade
[0m12:02:43.136379 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:02:43.138261 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: Close
[0m12:02:43.140237 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61509d910>]}
[0m12:02:43.142033 [info ] [Thread-3 (]: 13 of 18 OK created sql view model main_main.fct_revenue_daily ................. [[32mOK[0m in 1.90s]
[0m12:02:43.143678 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_revenue_daily
[0m12:02:45.559834 [debug] [Thread-4 (]: SQL status: OK in 4.138 seconds
[0m12:02:45.564794 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m12:02:45.566488 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events" rename to "fct_cart_events__dbt_backup"
[0m12:02:45.568778 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:02:45.572725 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m12:02:45.574780 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events__dbt_tmp" rename to "fct_cart_events"
[0m12:02:45.577270 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:02:45.579424 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: COMMIT
[0m12:02:45.580936 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m12:02:45.582545 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: COMMIT
[0m12:02:45.590591 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:02:45.593866 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m12:02:45.596522 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
drop view if exists "warehouse"."main_main"."fct_cart_events__dbt_backup" cascade
[0m12:02:45.602533 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:02:45.604963 [debug] [Thread-4 (]: On model.ecomm.fct_cart_events: Close
[0m12:02:45.607267 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff615137c90>]}
[0m12:02:45.609765 [info ] [Thread-4 (]: 14 of 18 OK created sql view model main_main.fct_cart_events ................... [[32mOK[0m in 4.23s]
[0m12:02:45.611641 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_cart_events
[0m12:02:52.287485 [debug] [Thread-1 (]: SQL status: OK in 10.729 seconds
[0m12:02:52.291753 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m12:02:52.292655 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel" rename to "daily_funnel__dbt_backup"
[0m12:02:52.293744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:52.296240 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m12:02:52.296931 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel__dbt_tmp" rename to "daily_funnel"
[0m12:02:52.297926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:52.299311 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m12:02:52.300014 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m12:02:52.300794 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m12:02:52.311863 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:02:52.316110 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m12:02:52.317997 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
drop view if exists "warehouse"."main_main"."daily_funnel__dbt_backup" cascade
[0m12:02:52.323945 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:02:52.325465 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: Close
[0m12:02:52.327865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff623798950>]}
[0m12:02:52.328927 [info ] [Thread-1 (]: 15 of 18 OK created sql view model main_main.daily_funnel ...................... [[32mOK[0m in 10.81s]
[0m12:02:52.330382 [debug] [Thread-1 (]: Finished running node model.ecomm.daily_funnel
[0m12:02:53.094038 [debug] [Thread-2 (]: SQL status: OK in 10.147 seconds
[0m12:02:53.097405 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m12:02:53.098343 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */
alter view "warehouse"."main_main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m12:02:53.100201 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:02:53.102644 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: COMMIT
[0m12:02:53.103814 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m12:02:53.105368 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: COMMIT
[0m12:02:53.111265 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:02:53.114172 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.stg_sessions"
[0m12:02:53.115126 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.stg_sessions"} */
drop view if exists "warehouse"."main_main"."stg_sessions__dbt_backup" cascade
[0m12:02:53.116546 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:53.118093 [debug] [Thread-2 (]: On model.ecomm.stg_sessions: Close
[0m12:02:53.139239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6235f6e50>]}
[0m12:02:53.141335 [info ] [Thread-2 (]: 16 of 18 OK created sql view model main_main.stg_sessions ...................... [[32mOK[0m in 10.25s]
[0m12:02:53.143332 [debug] [Thread-2 (]: Finished running node model.ecomm.stg_sessions
[0m12:02:53.145856 [debug] [Thread-3 (]: Began running node model.ecomm.dim_user
[0m12:02:53.146226 [debug] [Thread-4 (]: Began running node model.ecomm.fct_sessions
[0m12:02:53.147829 [info ] [Thread-3 (]: 17 of 18 START sql view model main_main.dim_user ............................... [RUN]
[0m12:02:53.149523 [info ] [Thread-4 (]: 18 of 18 START sql view model main_main.fct_sessions ........................... [RUN]
[0m12:02:53.150964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_revenue_daily, now model.ecomm.dim_user)
[0m12:02:53.152423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_cart_events, now model.ecomm.fct_sessions)
[0m12:02:53.153692 [debug] [Thread-3 (]: Began compiling node model.ecomm.dim_user
[0m12:02:53.155075 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_sessions
[0m12:02:53.158821 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m12:02:53.162607 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m12:02:53.172456 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_sessions
[0m12:02:53.177546 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m12:02:53.177919 [debug] [Thread-3 (]: Began executing node model.ecomm.dim_user
[0m12:02:53.184371 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m12:02:53.192551 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m12:02:53.194259 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: BEGIN
[0m12:02:53.195895 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_user"
[0m12:02:53.196192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:53.197787 [debug] [Thread-3 (]: On model.ecomm.dim_user: BEGIN
[0m12:02:53.200359 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:02:53.232770 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m12:02:53.233135 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m12:02:53.234555 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m12:02:53.236230 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_user"
[0m12:02:53.237754 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main_main"."stg_sessions"
group by session_date
order by session_date
  );

[0m12:02:53.239239 [debug] [Thread-3 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
  create view "warehouse"."main_main"."dim_user__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main_main"."stg_sessions"
),
orders as (
  select user_id, total
  from "warehouse"."main_main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*)    as total_orders,
    sum(total)  as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)    as total_orders,
  coalesce(o.lifetime_value, 0)  as lifetime_value,
  a.converting_sessions
from agg a
left join ord o on a.user_id = o.user_id
  );

[0m12:03:01.270885 [debug] [Thread-4 (]: SQL status: OK in 6.572 seconds
[0m12:03:01.273794 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m12:03:01.275413 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions" rename to "fct_sessions__dbt_backup"
[0m12:03:01.277954 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:03:01.281070 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m12:03:01.283438 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m12:03:01.284685 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:03:01.287076 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m12:03:01.289394 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m12:03:01.290782 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m12:03:01.305474 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m12:03:01.309753 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m12:03:01.312190 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
drop view if exists "warehouse"."main_main"."fct_sessions__dbt_backup" cascade
[0m12:03:01.318630 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m12:03:01.320953 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: Close
[0m12:03:01.323148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62240ac10>]}
[0m12:03:01.325196 [info ] [Thread-4 (]: 18 of 18 OK created sql view model main_main.fct_sessions ...................... [[32mOK[0m in 8.17s]
[0m12:03:01.326628 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_sessions
[0m12:03:02.468555 [debug] [Thread-3 (]: SQL status: OK in 7.768 seconds
[0m12:03:02.472865 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_user"
[0m12:03:02.474038 [debug] [Thread-3 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter view "warehouse"."main_main"."dim_user" rename to "dim_user__dbt_backup"
[0m12:03:02.475370 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:03:02.478273 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_user"
[0m12:03:02.479708 [debug] [Thread-3 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter view "warehouse"."main_main"."dim_user__dbt_tmp" rename to "dim_user"
[0m12:03:02.481379 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:03:02.483362 [debug] [Thread-3 (]: On model.ecomm.dim_user: COMMIT
[0m12:03:02.485163 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_user"
[0m12:03:02.486457 [debug] [Thread-3 (]: On model.ecomm.dim_user: COMMIT
[0m12:03:02.491058 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:03:02.494109 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_user"
[0m12:03:02.495180 [debug] [Thread-3 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
drop view if exists "warehouse"."main_main"."dim_user__dbt_backup" cascade
[0m12:03:02.497572 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:03:02.499900 [debug] [Thread-3 (]: On model.ecomm.dim_user: Close
[0m12:03:02.512070 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8587d06f-40d0-4a51-aff9-24108d53b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff615058f90>]}
[0m12:03:02.515302 [info ] [Thread-3 (]: 17 of 18 OK created sql view model main_main.dim_user .......................... [[32mOK[0m in 9.36s]
[0m12:03:02.517075 [debug] [Thread-3 (]: Finished running node model.ecomm.dim_user
[0m12:03:02.520136 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:02.521601 [debug] [MainThread]: On master: BEGIN
[0m12:03:02.523090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:02.564543 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m12:03:02.568199 [debug] [MainThread]: On master: COMMIT
[0m12:03:02.569639 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:02.570737 [debug] [MainThread]: On master: COMMIT
[0m12:03:02.573554 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:03:02.575551 [debug] [MainThread]: On master: Close
[0m12:03:02.580536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:02.581958 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m12:03:02.583145 [debug] [MainThread]: Connection 'model.ecomm.daily_funnel' was properly closed.
[0m12:03:02.585122 [debug] [MainThread]: Connection 'model.ecomm.stg_sessions' was properly closed.
[0m12:03:02.586608 [debug] [MainThread]: Connection 'model.ecomm.dim_user' was properly closed.
[0m12:03:02.588151 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m12:03:02.589494 [info ] [MainThread]: 
[0m12:03:02.590861 [info ] [MainThread]: Finished running 2 seeds, 1 table model, 2 data tests, 13 view models in 0 hours 0 minutes and 26.95 seconds (26.95s).
[0m12:03:02.595725 [debug] [MainThread]: Command end result
[0m12:03:02.638930 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:03:02.645886 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:03:02.658263 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:03:02.659462 [info ] [MainThread]: 
[0m12:03:02.660805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:02.662038 [info ] [MainThread]: 
[0m12:03:02.663252 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m12:03:02.664722 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 26.51094, "process_in_blocks": "4312", "process_kernel_time": 1.722069, "process_mem_max_rss": "279468", "process_out_blocks": "0", "process_user_time": 4.700785}
[0m12:03:02.666230 [debug] [MainThread]: Command `dbt build` succeeded at 12:03:02.666133 after 26.51 seconds
[0m12:03:02.667554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62cfd4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62cfd43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62cfd4410>]}
[0m12:03:02.668799 [debug] [MainThread]: Flushing usage events
[0m12:03:03.772976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:50.489636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca70f8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca72909d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca70f82d0>]}


============================== 14:29:50.498885 | 13a0585a-0695-41ce-9dac-f4274c027568 ==============================
[0m14:29:50.498885 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:29:50.501796 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'printer_width': '80', 'log_path': '/usr/app/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select models/gold', 'target_path': 'None'}
[0m14:29:50.699176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca6f57250>]}
[0m14:29:50.743120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca9ce4190>]}
[0m14:29:50.746348 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:29:50.793165 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:29:51.905552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:51.907884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:51.951397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca9809e90>]}
[0m14:29:52.066870 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:29:52.082873 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:29:52.122721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca2b08a90>]}
[0m14:29:52.125332 [info ] [MainThread]: Found 14 models, 2 seeds, 2 data tests, 4 sources, 426 macros
[0m14:29:52.128129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca6f65690>]}
[0m14:29:52.138471 [info ] [MainThread]: 
[0m14:29:52.140574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:52.142235 [info ] [MainThread]: 
[0m14:29:52.144278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:29:52.150321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m14:29:52.192901 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m14:29:52.194721 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"warehouse"'
    
  
  
[0m14:29:52.196477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:53.711131 [debug] [ThreadPool]: SQL status: OK in 1.515 seconds
[0m14:29:53.713398 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:29:53.717705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_main)
[0m14:29:53.719647 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_main"
"
[0m14:29:53.725594 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m14:29:53.727452 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
        select type from duckdb_databases()
        where database_name='warehouse'
        and type='sqlite'
    
  
[0m14:29:53.728997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:53.769105 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m14:29:53.772272 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m14:29:53.774284 [debug] [ThreadPool]: On create_warehouse_main_main: BEGIN
[0m14:29:53.776517 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:29:53.778239 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m14:29:53.780625 [debug] [ThreadPool]: On create_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "create_warehouse_main_main"} */

    
    
        create schema if not exists "warehouse"."main_main"
    
[0m14:29:53.783061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:29:53.785183 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m14:29:53.787121 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_main"
[0m14:29:53.788748 [debug] [ThreadPool]: On create_warehouse_main_main: COMMIT
[0m14:29:53.790638 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:29:53.792523 [debug] [ThreadPool]: On create_warehouse_main_main: Close
[0m14:29:53.798820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_main, now list_warehouse_main_main)
[0m14:29:53.804373 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m14:29:53.806461 [debug] [ThreadPool]: On list_warehouse_main_main: BEGIN
[0m14:29:53.808835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:53.848377 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m14:29:53.850389 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_main"
[0m14:29:53.852867 [debug] [ThreadPool]: On list_warehouse_main_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "connection_name": "list_warehouse_main_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_main'
    and table_catalog = 'warehouse'
  
[0m14:29:53.863138 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:29:53.866129 [debug] [ThreadPool]: On list_warehouse_main_main: ROLLBACK
[0m14:29:53.868842 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_main'
[0m14:29:53.870686 [debug] [ThreadPool]: On list_warehouse_main_main: Close
[0m14:29:53.876635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca6f57310>]}
[0m14:29:53.878303 [debug] [MainThread]: Using duckdb connection "master"
[0m14:29:53.880982 [debug] [MainThread]: On master: BEGIN
[0m14:29:53.883358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:53.924723 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m14:29:53.926566 [debug] [MainThread]: On master: COMMIT
[0m14:29:53.930806 [debug] [MainThread]: Using duckdb connection "master"
[0m14:29:53.933614 [debug] [MainThread]: On master: COMMIT
[0m14:29:53.936121 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:29:53.938024 [debug] [MainThread]: On master: Close
[0m14:29:53.947551 [debug] [Thread-1 (]: Began running node model.ecomm.daily_funnel
[0m14:29:53.947848 [debug] [Thread-2 (]: Began running node model.ecomm.dim_user
[0m14:29:53.948100 [debug] [Thread-3 (]: Began running node model.ecomm.fct_cart_events
[0m14:29:53.948388 [debug] [Thread-4 (]: Began running node model.ecomm.fct_daily_sales
[0m14:29:53.949693 [info ] [Thread-1 (]: 1 of 10 START sql view model main_main.daily_funnel ............................ [RUN]
[0m14:29:53.951534 [info ] [Thread-2 (]: 2 of 10 START sql view model main_main.dim_user ................................ [RUN]
[0m14:29:53.953226 [info ] [Thread-3 (]: 3 of 10 START sql view model main_main.fct_cart_events ......................... [RUN]
[0m14:29:53.954832 [info ] [Thread-4 (]: 4 of 10 START sql view model main_main.fct_daily_sales ......................... [RUN]
[0m14:29:53.956539 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecomm.daily_funnel'
[0m14:29:53.958125 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ecomm.dim_user'
[0m14:29:53.959809 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ecomm.fct_cart_events'
[0m14:29:53.961589 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ecomm.fct_daily_sales'
[0m14:29:53.963133 [debug] [Thread-1 (]: Began compiling node model.ecomm.daily_funnel
[0m14:29:53.964244 [debug] [Thread-2 (]: Began compiling node model.ecomm.dim_user
[0m14:29:53.965928 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_cart_events
[0m14:29:53.967245 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_daily_sales
[0m14:29:54.012587 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.daily_funnel"
[0m14:29:54.015903 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecomm.dim_user"
[0m14:29:54.019300 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_cart_events"
[0m14:29:54.022934 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_daily_sales"
[0m14:29:54.041411 [debug] [Thread-1 (]: Began executing node model.ecomm.daily_funnel
[0m14:29:54.043051 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_cart_events
[0m14:29:54.049921 [debug] [Thread-2 (]: Began executing node model.ecomm.dim_user
[0m14:29:54.059091 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_daily_sales
[0m14:29:54.067707 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.daily_funnel"
[0m14:29:54.070198 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_cart_events"
[0m14:29:54.073802 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecomm.dim_user"
[0m14:29:54.077414 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_daily_sales"
[0m14:29:54.092078 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m14:29:54.093780 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m14:29:54.095549 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: BEGIN
[0m14:29:54.095824 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m14:29:54.105466 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: BEGIN
[0m14:29:54.109919 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m14:29:54.111148 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:29:54.113718 [debug] [Thread-2 (]: On model.ecomm.dim_user: BEGIN
[0m14:29:54.116516 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:29:54.118155 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: BEGIN
[0m14:29:54.121830 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:29:54.125494 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:29:54.171602 [debug] [Thread-3 (]: SQL status: OK in 0.055 seconds
[0m14:29:54.171924 [debug] [Thread-4 (]: SQL status: OK in 0.061 seconds
[0m14:29:54.172203 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m14:29:54.172434 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m14:29:54.174529 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m14:29:54.176969 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m14:29:54.179294 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m14:29:54.181668 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m14:29:54.183744 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */

  
  create view "warehouse"."main_main"."fct_cart_events__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as cart_events,
  count(distinct user_id) as users_carted
from "warehouse"."main_main"."stg_add_to_cart"
group by event_date
order by event_date
  );

[0m14:29:54.185486 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */

  
  create view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" as (
    

select
  event_date,
  count(*)::bigint as orders,
  sum(total)        as revenue
from "warehouse"."main_main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m14:29:54.187099 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */

  
  create view "warehouse"."main_main"."dim_user__dbt_tmp" as (
    

with sess as (
  select user_id, session_start, session_end, conversion_flag
  from "warehouse"."main_main"."stg_sessions"
),
orders as (
  select user_id, total
  from "warehouse"."main_main"."stg_order_placed"
),
agg as (
  select
    user_id,
    min(session_start) as first_seen_at,
    max(session_end)   as last_seen_at,
    count(*)           as total_sessions,
    sum(conversion_flag) as converting_sessions
  from sess
  group by 1
),
ord as (
  select
    user_id,
    count(*)    as total_orders,
    sum(total)  as lifetime_value
  from orders
  group by 1
)
select
  a.user_id,
  a.first_seen_at,
  a.last_seen_at,
  a.total_sessions,
  coalesce(o.total_orders, 0)    as total_orders,
  coalesce(o.lifetime_value, 0)  as lifetime_value,
  a.converting_sessions
from agg a
left join ord o on a.user_id = o.user_id
  );

[0m14:29:54.188806 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */

  
  create view "warehouse"."main_main"."daily_funnel__dbt_tmp" as (
    

with pv as (
  select event_date, count(*)::bigint as page_views
  from "warehouse"."main_main"."stg_page_view" group by event_date
),
cart as (
  select event_date, count(*)::bigint as add_to_carts
  from "warehouse"."main_main"."stg_add_to_cart" group by event_date
),
ord as (
  select event_date, count(*)::bigint as orders
  from "warehouse"."main_main"."stg_order_placed" group by event_date
)
select
  coalesce(pv.event_date, cart.event_date, ord.event_date) as event_date,
  pv.page_views, cart.add_to_carts, ord.orders,
  case when pv.page_views > 0 then ord.orders::double / pv.page_views else null end as view_to_order_cr,
  case when cart.add_to_carts > 0 then ord.orders::double / cart.add_to_carts else null end as cart_to_order_cr
from pv
full join cart using (event_date)
full join ord  using (event_date)
order by event_date
  );

[0m14:29:57.841616 [debug] [Thread-4 (]: SQL status: OK in 3.649 seconds
[0m14:29:57.848869 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m14:29:57.853936 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m14:29:57.862373 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:29:57.866688 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m14:29:57.868345 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
alter view "warehouse"."main_main"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m14:29:57.871245 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:29:57.885024 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m14:29:57.888956 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m14:29:57.892779 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: COMMIT
[0m14:29:57.910735 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m14:29:57.916402 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_daily_sales"
[0m14:29:57.918421 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_daily_sales"} */
drop view if exists "warehouse"."main_main"."fct_daily_sales__dbt_backup" cascade
[0m14:29:57.923994 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:29:57.927163 [debug] [Thread-4 (]: On model.ecomm.fct_daily_sales: Close
[0m14:29:57.931078 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca2093510>]}
[0m14:29:57.933322 [info ] [Thread-4 (]: 4 of 10 OK created sql view model main_main.fct_daily_sales .................... [[32mOK[0m in 3.97s]
[0m14:29:57.935201 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_daily_sales
[0m14:29:57.937191 [debug] [Thread-4 (]: Began running node model.ecomm.fct_order_items
[0m14:29:57.938757 [info ] [Thread-4 (]: 5 of 10 START sql view model main_main.fct_order_items ......................... [RUN]
[0m14:29:57.940188 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_daily_sales, now model.ecomm.fct_order_items)
[0m14:29:57.942067 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_order_items
[0m14:29:57.946159 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_order_items"
[0m14:29:57.964868 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_order_items
[0m14:29:57.968751 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_order_items"
[0m14:29:57.989178 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m14:29:57.991328 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: BEGIN
[0m14:29:57.992897 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:29:57.995188 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:29:57.996896 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m14:29:57.998363 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */

  
  create view "warehouse"."main_main"."fct_order_items__dbt_tmp" as (
    

with orders as (
  select event_id, order_id, user_id, ts, event_date, line_items
  from "warehouse"."main_main"."stg_order_placed"
)
select
  o.event_id,
  o.order_id,
  o.user_id,
  o.ts,
  o.event_date,
  u.li.sku      as sku,
  u.li.qty      as qty,
  u.li.price    as price,
  u.li.qty * u.li.price as line_total
from orders o
cross join unnest(o.line_items) as u(li)   -- u = table alias, li = column alias (STRUCT)
  );

[0m14:30:00.188915 [debug] [Thread-3 (]: SQL status: OK in 5.998 seconds
[0m14:30:00.194045 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m14:30:00.196118 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events" rename to "fct_cart_events__dbt_backup"
[0m14:30:00.199582 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:30:00.205171 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m14:30:00.208682 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
alter view "warehouse"."main_main"."fct_cart_events__dbt_tmp" rename to "fct_cart_events"
[0m14:30:00.214191 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:30:00.218156 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: COMMIT
[0m14:30:00.221809 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m14:30:00.225383 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: COMMIT
[0m14:30:00.236354 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:30:00.240863 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_cart_events"
[0m14:30:00.243782 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_cart_events"} */
drop view if exists "warehouse"."main_main"."fct_cart_events__dbt_backup" cascade
[0m14:30:00.253285 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:30:00.256892 [debug] [Thread-3 (]: On model.ecomm.fct_cart_events: Close
[0m14:30:00.259526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca1f99810>]}
[0m14:30:00.263358 [info ] [Thread-3 (]: 3 of 10 OK created sql view model main_main.fct_cart_events .................... [[32mOK[0m in 6.30s]
[0m14:30:00.268634 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_cart_events
[0m14:30:00.276426 [debug] [Thread-3 (]: Began running node model.ecomm.fct_orders
[0m14:30:00.279740 [info ] [Thread-3 (]: 6 of 10 START sql view model main_main.fct_orders .............................. [RUN]
[0m14:30:00.283444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_cart_events, now model.ecomm.fct_orders)
[0m14:30:00.286334 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_orders
[0m14:30:00.293225 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_orders"
[0m14:30:00.331317 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_orders
[0m14:30:00.339085 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_orders"
[0m14:30:00.381847 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m14:30:00.388309 [debug] [Thread-3 (]: On model.ecomm.fct_orders: BEGIN
[0m14:30:00.393849 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:30:00.398759 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:30:00.403242 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m14:30:00.407403 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */

  
  create view "warehouse"."main_main"."fct_orders__dbt_tmp" as (
    
select
  event_date,
  count(*)::bigint as orders,
  sum(total)       as revenue
from "warehouse"."main_main"."stg_order_placed"
group by event_date
order by event_date
  );

[0m14:30:00.892297 [debug] [Thread-4 (]: SQL status: OK in 2.892 seconds
[0m14:30:00.900070 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m14:30:00.903957 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
alter view "warehouse"."main_main"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m14:30:00.907512 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:30:00.914758 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m14:30:00.918077 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
alter view "warehouse"."main_main"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m14:30:00.921452 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:30:00.925395 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: COMMIT
[0m14:30:00.928495 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m14:30:00.932266 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: COMMIT
[0m14:30:00.945681 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:30:00.950747 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_order_items"
[0m14:30:00.953936 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_order_items"} */
drop view if exists "warehouse"."main_main"."fct_order_items__dbt_backup" cascade
[0m14:30:00.965086 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m14:30:00.971195 [debug] [Thread-4 (]: On model.ecomm.fct_order_items: Close
[0m14:30:00.975446 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca1fb5dd0>]}
[0m14:30:00.980353 [info ] [Thread-4 (]: 5 of 10 OK created sql view model main_main.fct_order_items .................... [[32mOK[0m in 3.04s]
[0m14:30:00.984456 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_order_items
[0m14:30:00.987780 [debug] [Thread-4 (]: Began running node model.ecomm.fct_sessions
[0m14:30:00.991668 [info ] [Thread-4 (]: 7 of 10 START sql view model main_main.fct_sessions ............................ [RUN]
[0m14:30:00.997262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_order_items, now model.ecomm.fct_sessions)
[0m14:30:00.999879 [debug] [Thread-4 (]: Began compiling node model.ecomm.fct_sessions
[0m14:30:01.004937 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecomm.fct_sessions"
[0m14:30:01.036662 [debug] [Thread-4 (]: Began executing node model.ecomm.fct_sessions
[0m14:30:01.042020 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecomm.fct_sessions"
[0m14:30:01.079041 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m14:30:01.081936 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: BEGIN
[0m14:30:01.085799 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:30:01.089018 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:30:01.092821 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m14:30:01.096706 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */

  
  create view "warehouse"."main_main"."fct_sessions__dbt_tmp" as (
    
select
  session_date,
  count(*)::bigint as sessions,
  sum(page_count) as total_pages,
  sum(cart_events) as total_cart_events,
  sum(conversion_flag) as conversions
from "warehouse"."main_main"."stg_sessions"
group by session_date
order by session_date
  );

[0m14:30:05.093296 [debug] [Thread-3 (]: SQL status: OK in 4.681 seconds
[0m14:30:05.100084 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m14:30:05.105617 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:30:05.109667 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:30:05.115620 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m14:30:05.119338 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
alter view "warehouse"."main_main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:30:05.125156 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:30:05.130597 [debug] [Thread-3 (]: On model.ecomm.fct_orders: COMMIT
[0m14:30:05.135595 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m14:30:05.139844 [debug] [Thread-3 (]: On model.ecomm.fct_orders: COMMIT
[0m14:30:05.150897 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:30:05.155870 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_orders"
[0m14:30:05.159755 [debug] [Thread-3 (]: On model.ecomm.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_orders"} */
drop view if exists "warehouse"."main_main"."fct_orders__dbt_backup" cascade
[0m14:30:05.168973 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:30:05.172437 [debug] [Thread-3 (]: On model.ecomm.fct_orders: Close
[0m14:30:05.175395 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca2091c10>]}
[0m14:30:05.177855 [info ] [Thread-3 (]: 6 of 10 OK created sql view model main_main.fct_orders ......................... [[32mOK[0m in 4.89s]
[0m14:30:05.180712 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_orders
[0m14:30:05.183057 [debug] [Thread-3 (]: Began running node model.ecomm.dim_sku_360
[0m14:30:05.186612 [info ] [Thread-3 (]: 8 of 10 START sql table model main_main.dim_sku_360 ............................ [RUN]
[0m14:30:05.188894 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.fct_orders, now model.ecomm.dim_sku_360)
[0m14:30:05.190875 [debug] [Thread-3 (]: Began compiling node model.ecomm.dim_sku_360
[0m14:30:05.196962 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.dim_sku_360"
[0m14:30:05.234555 [debug] [Thread-3 (]: Began executing node model.ecomm.dim_sku_360
[0m14:30:05.253838 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.dim_sku_360"
[0m14:30:05.289559 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m14:30:05.294116 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: BEGIN
[0m14:30:05.297937 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:30:05.301625 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:30:05.305679 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m14:30:05.309344 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */

  
    
    

    create  table
      "warehouse"."main_main"."dim_sku_360__dbt_tmp"
  
    as (
      

with li as (
  select sku, qty, price, line_total, event_date
  from "warehouse"."main_main"."fct_order_items"
),
agg as (
  select
    sku,
    min(event_date)         as first_sold_date,
    sum(qty)                as units_sold,
    sum(line_total)         as gross_revenue,
    avg(price)              as avg_unit_price
  from li
  group by 1
),
cat as (
  select sku, category
  from "warehouse"."main_main"."dim_sku"
)
select
  a.sku,
  coalesce(c.category, 'Unknown') as category,
  a.first_sold_date,
  a.units_sold,
  a.gross_revenue,
  a.avg_unit_price
from agg a
left join cat c on c.sku = a.sku
    );
  
  
[0m14:30:10.718311 [debug] [Thread-1 (]: SQL status: OK in 14.854 seconds
[0m14:30:10.722788 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m14:30:10.727182 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel" rename to "daily_funnel__dbt_backup"
[0m14:30:10.731319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:30:10.735706 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m14:30:10.738481 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
alter view "warehouse"."main_main"."daily_funnel__dbt_tmp" rename to "daily_funnel"
[0m14:30:10.742504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:30:10.747278 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m14:30:10.750332 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m14:30:10.754691 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: COMMIT
[0m14:30:10.767334 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:30:10.772338 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.daily_funnel"
[0m14:30:10.776027 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.daily_funnel"} */
drop view if exists "warehouse"."main_main"."daily_funnel__dbt_backup" cascade
[0m14:30:10.784423 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:30:10.788370 [debug] [Thread-1 (]: On model.ecomm.daily_funnel: Close
[0m14:30:10.793130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c95f0c4d0>]}
[0m14:30:10.796358 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main_main.daily_funnel ....................... [[32mOK[0m in 16.84s]
[0m14:30:10.799388 [debug] [Thread-1 (]: Finished running node model.ecomm.daily_funnel
[0m14:30:10.802037 [debug] [Thread-1 (]: Began running node model.ecomm.fct_revenue_by_category_daily
[0m14:30:10.806089 [info ] [Thread-1 (]: 9 of 10 START sql view model main_main.fct_revenue_by_category_daily ........... [RUN]
[0m14:30:10.809059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecomm.daily_funnel, now model.ecomm.fct_revenue_by_category_daily)
[0m14:30:10.812216 [debug] [Thread-1 (]: Began compiling node model.ecomm.fct_revenue_by_category_daily
[0m14:30:10.818274 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:10.845702 [debug] [Thread-1 (]: Began executing node model.ecomm.fct_revenue_by_category_daily
[0m14:30:10.851620 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:10.883289 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:10.885556 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: BEGIN
[0m14:30:10.888387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:10.892536 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:30:10.895086 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:10.898970 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_tmp" as (
    

with li as (
  select sku, event_date, line_total
  from "warehouse"."main_main"."fct_order_items"
),
cat as (
  select sku, category
  from "warehouse"."main_main"."dim_sku"   -- seed with (sku, category)
)
select
  li.event_date,
  coalesce(cat.category, 'Unknown') as category,
  sum(li.line_total)                as revenue
from li
left join cat on cat.sku = li.sku
group by 1,2
order by 1,2
  );

[0m14:30:13.675310 [debug] [Thread-3 (]: SQL status: OK in 6.694 seconds
[0m14:30:13.680709 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m14:30:13.682573 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
alter table "warehouse"."main_main"."dim_sku_360" rename to "dim_sku_360__dbt_backup"
[0m14:30:13.685890 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:30:13.689852 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m14:30:13.692541 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
alter table "warehouse"."main_main"."dim_sku_360__dbt_tmp" rename to "dim_sku_360"
[0m14:30:13.695400 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:30:13.700946 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: COMMIT
[0m14:30:13.702696 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m14:30:13.704223 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: COMMIT
[0m14:30:13.714715 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:30:13.718925 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.dim_sku_360"
[0m14:30:13.720250 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_sku_360"} */
drop table if exists "warehouse"."main_main"."dim_sku_360__dbt_backup" cascade
[0m14:30:13.727010 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:30:13.729806 [debug] [Thread-3 (]: On model.ecomm.dim_sku_360: Close
[0m14:30:13.734413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca391ba50>]}
[0m14:30:13.736241 [info ] [Thread-3 (]: 8 of 10 OK created sql table model main_main.dim_sku_360 ....................... [[32mOK[0m in 8.55s]
[0m14:30:13.738588 [debug] [Thread-3 (]: Finished running node model.ecomm.dim_sku_360
[0m14:30:13.740517 [debug] [Thread-3 (]: Began running node model.ecomm.fct_revenue_daily
[0m14:30:13.743058 [info ] [Thread-3 (]: 10 of 10 START sql view model main_main.fct_revenue_daily ...................... [RUN]
[0m14:30:13.745521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecomm.dim_sku_360, now model.ecomm.fct_revenue_daily)
[0m14:30:13.747701 [debug] [Thread-3 (]: Began compiling node model.ecomm.fct_revenue_daily
[0m14:30:13.752288 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecomm.fct_revenue_daily"
[0m14:30:13.775809 [debug] [Thread-3 (]: Began executing node model.ecomm.fct_revenue_daily
[0m14:30:13.781277 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecomm.fct_revenue_daily"
[0m14:30:13.808439 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m14:30:13.811409 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: BEGIN
[0m14:30:13.814224 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:30:13.816648 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:30:13.819292 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m14:30:13.820990 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */

  
  create view "warehouse"."main_main"."fct_revenue_daily__dbt_tmp" as (
    

with li as (
  select event_date, qty, line_total
  from "warehouse"."main_main"."fct_order_items"
)
select
  event_date,
  sum(line_total)                 as revenue,
  sum(qty)                        as units_sold
from li
group by 1
order by 1
  );

[0m14:30:13.832380 [debug] [Thread-2 (]: SQL status: OK in 17.970 seconds
[0m14:30:13.837413 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m14:30:13.839984 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter view "warehouse"."main_main"."dim_user" rename to "dim_user__dbt_backup"
[0m14:30:13.842652 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:30:13.847036 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m14:30:13.848755 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
alter view "warehouse"."main_main"."dim_user__dbt_tmp" rename to "dim_user"
[0m14:30:13.851193 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:30:13.854602 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m14:30:13.856711 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m14:30:13.858590 [debug] [Thread-2 (]: On model.ecomm.dim_user: COMMIT
[0m14:30:13.868906 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:30:13.875179 [debug] [Thread-2 (]: Using duckdb connection "model.ecomm.dim_user"
[0m14:30:13.877576 [debug] [Thread-2 (]: On model.ecomm.dim_user: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.dim_user"} */
drop view if exists "warehouse"."main_main"."dim_user__dbt_backup" cascade
[0m14:30:13.884335 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:30:13.888310 [debug] [Thread-2 (]: On model.ecomm.dim_user: Close
[0m14:30:13.891616 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c95f50290>]}
[0m14:30:13.894608 [info ] [Thread-2 (]: 2 of 10 OK created sql view model main_main.dim_user ........................... [[32mOK[0m in 19.93s]
[0m14:30:13.896981 [debug] [Thread-2 (]: Finished running node model.ecomm.dim_user
[0m14:30:14.273420 [debug] [Thread-1 (]: SQL status: OK in 3.371 seconds
[0m14:30:14.278421 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:14.280486 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */
alter view "warehouse"."main_main"."fct_revenue_by_category_daily" rename to "fct_revenue_by_category_daily__dbt_backup"
[0m14:30:14.283089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:30:14.286580 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:14.289392 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */
alter view "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_tmp" rename to "fct_revenue_by_category_daily"
[0m14:30:14.291787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:30:14.295906 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: COMMIT
[0m14:30:14.298380 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:14.301893 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: COMMIT
[0m14:30:14.309437 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:30:14.312359 [debug] [Thread-1 (]: Using duckdb connection "model.ecomm.fct_revenue_by_category_daily"
[0m14:30:14.314685 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_by_category_daily"} */
drop view if exists "warehouse"."main_main"."fct_revenue_by_category_daily__dbt_backup" cascade
[0m14:30:14.319080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:30:14.322781 [debug] [Thread-1 (]: On model.ecomm.fct_revenue_by_category_daily: Close
[0m14:30:14.325434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca1fc8050>]}
[0m14:30:14.327580 [info ] [Thread-1 (]: 9 of 10 OK created sql view model main_main.fct_revenue_by_category_daily ...... [[32mOK[0m in 3.52s]
[0m14:30:14.329309 [debug] [Thread-1 (]: Finished running node model.ecomm.fct_revenue_by_category_daily
[0m14:30:15.824047 [debug] [Thread-3 (]: SQL status: OK in 2.001 seconds
[0m14:30:15.827477 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m14:30:15.829603 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */
alter view "warehouse"."main_main"."fct_revenue_daily" rename to "fct_revenue_daily__dbt_backup"
[0m14:30:15.832047 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:30:15.837777 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m14:30:15.840241 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */
alter view "warehouse"."main_main"."fct_revenue_daily__dbt_tmp" rename to "fct_revenue_daily"
[0m14:30:15.842673 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:30:15.845400 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: COMMIT
[0m14:30:15.847079 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m14:30:15.848108 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: COMMIT
[0m14:30:15.855019 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:30:15.857862 [debug] [Thread-3 (]: Using duckdb connection "model.ecomm.fct_revenue_daily"
[0m14:30:15.859162 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_revenue_daily"} */
drop view if exists "warehouse"."main_main"."fct_revenue_daily__dbt_backup" cascade
[0m14:30:15.863310 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:30:15.865481 [debug] [Thread-3 (]: On model.ecomm.fct_revenue_daily: Close
[0m14:30:15.867205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca70beb50>]}
[0m14:30:15.869109 [info ] [Thread-3 (]: 10 of 10 OK created sql view model main_main.fct_revenue_daily ................. [[32mOK[0m in 2.12s]
[0m14:30:15.871122 [debug] [Thread-3 (]: Finished running node model.ecomm.fct_revenue_daily
[0m14:30:18.922170 [debug] [Thread-4 (]: SQL status: OK in 16.153 seconds
[0m14:30:18.926502 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m14:30:18.927917 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions" rename to "fct_sessions__dbt_backup"
[0m14:30:18.929979 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:30:18.933782 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m14:30:18.935528 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
alter view "warehouse"."main_main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m14:30:18.938487 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:30:18.941062 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m14:30:18.942366 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m14:30:18.944387 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: COMMIT
[0m14:30:18.949463 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:30:18.952335 [debug] [Thread-4 (]: Using duckdb connection "model.ecomm.fct_sessions"
[0m14:30:18.953998 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecomm", "target_name": "dev", "node_id": "model.ecomm.fct_sessions"} */
drop view if exists "warehouse"."main_main"."fct_sessions__dbt_backup" cascade
[0m14:30:18.959936 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:30:18.962959 [debug] [Thread-4 (]: On model.ecomm.fct_sessions: Close
[0m14:30:18.985438 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13a0585a-0695-41ce-9dac-f4274c027568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca9953f10>]}
[0m14:30:18.986820 [info ] [Thread-4 (]: 7 of 10 OK created sql view model main_main.fct_sessions ....................... [[32mOK[0m in 17.99s]
[0m14:30:18.988043 [debug] [Thread-4 (]: Finished running node model.ecomm.fct_sessions
[0m14:30:18.990621 [debug] [MainThread]: Using duckdb connection "master"
[0m14:30:18.992133 [debug] [MainThread]: On master: BEGIN
[0m14:30:18.993334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:19.030236 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m14:30:19.032928 [debug] [MainThread]: On master: COMMIT
[0m14:30:19.036602 [debug] [MainThread]: Using duckdb connection "master"
[0m14:30:19.038677 [debug] [MainThread]: On master: COMMIT
[0m14:30:19.041147 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:30:19.043422 [debug] [MainThread]: On master: Close
[0m14:30:19.050344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:19.052078 [debug] [MainThread]: Connection 'list_warehouse_main_main' was properly closed.
[0m14:30:19.053383 [debug] [MainThread]: Connection 'model.ecomm.fct_revenue_by_category_daily' was properly closed.
[0m14:30:19.054570 [debug] [MainThread]: Connection 'model.ecomm.dim_user' was properly closed.
[0m14:30:19.055602 [debug] [MainThread]: Connection 'model.ecomm.fct_revenue_daily' was properly closed.
[0m14:30:19.056802 [debug] [MainThread]: Connection 'model.ecomm.fct_sessions' was properly closed.
[0m14:30:19.058019 [info ] [MainThread]: 
[0m14:30:19.059175 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 26.91 seconds (26.91s).
[0m14:30:19.060975 [debug] [MainThread]: Command end result
[0m14:30:19.097562 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:30:19.104730 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:30:19.118726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:30:19.120444 [info ] [MainThread]: 
[0m14:30:19.123368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:19.124975 [info ] [MainThread]: 
[0m14:30:19.127234 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m14:30:19.131066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.068539, "process_in_blocks": "174112", "process_kernel_time": 1.620973, "process_mem_max_rss": "320352", "process_out_blocks": "90992", "process_user_time": 8.125002}
[0m14:30:19.133046 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:19.132797 after 27.07 seconds
[0m14:30:19.134706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca7363c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cab9345d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cab935050>]}
[0m14:30:19.136071 [debug] [MainThread]: Flushing usage events
[0m14:30:20.218027 [debug] [MainThread]: An error was encountered while trying to flush usage events
